<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Potree</title>
	</head>

	<body>
		<script src="libs/three.min.js"></script>
		<script src="libs/jquery-3.1.1.min.js"></script>
		<script src="libs/BinaryHeap.js"></script>
		<script src="libs/tween.min.js"></script>
		<script src="libs/proj4.js"></script>

		<script src="libs/potree/potree.js"></script>

		<script src="source/PotreeObject.js"></script>

		<script>
			window.viewer = new PotreeObject();
			
			viewer.resize();
			document.body.onresize = function()
			{
				viewer.resize();
			}
				
			//Lighting effects
			viewer.setEDLEnabled(false);
			viewer.setEDLRadius(1.4);
			viewer.setEDLStrength(0.4);
			viewer.setClipTask(Potree.ClipTask.HIGHLIGHT);
			viewer.setClipMethod(Potree.ClipMethod.INSIDE_ANY);
			viewer.setShowBoundingBox(false);
			viewer.setNavigationMode(Potree.OrbitControls);
			viewer.setFOV(60);
			viewer.setPointBudget(1000000);
			viewer.setBackground("white");
				
			loadCloud("galp");
			loadCloud("leixoes", -79, -40, -18, 0.2, 0.2, 0.2);

			function loadCloud(name, pX, pY, pZ, sX, sY, sZ)
			{
				Potree.loadPointCloud("data/models/" + name + "/cloud.js", name, function(e)
				{
					var pointcloud = e.pointcloud;

					if(pX !== undefined) pointcloud.position.set(pX, pY, pZ);
					if(sX !== undefined) pointcloud.scale.set(sX, sY, sZ);

					console.log(pointcloud);

					var material = pointcloud.material;
					material.size = 1;
					material.pointColorType = Potree.PointColorType.RGB;
					material.pointSizeType = Potree.PointSizeType.ADAPTIVE;
					material.shape = Potree.PointShape.SQUARE;

					viewer.scene.addPointCloud(pointcloud);
				});
			}

			var timestamp = 0;
			function loop()
			{	
				var delta = viewer.clock.getDelta();
				timestamp += delta;

				viewer.update(delta, timestamp);
				viewer.render();

				requestAnimationFrame(loop);
			};
			loop();

		</script>
	</body>
</html>
