var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||'function'==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return'undefined'!=typeof window&&window===a?a:'undefined'!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX='jscomp_symbol_';
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||'')+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol('iterator'));'function'!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.objectCreate=$jscomp.ASSUME_ES5||'function'==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};
$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf='function'==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+' is not extensible');return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if('prototype'!=c)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,c);e&&Object.defineProperty(a,c,e)}else a[c]=b[c];a.superClass_=b.prototype};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError('Iterator result '+a+' is not an object');};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError('Generator is already running');this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_('return'in b?b['return']:function(a){return{value:a,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_['throw'],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var e=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(e);if(!e.done)return this.context_.stop_(),e;var d=e.value}catch(f){return this.context_.yieldAllIterator_=null,this.context_.throw_(f),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,d);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.polyfill=function(a,b,c,e){if(b){c=$jscomp.global;a=a.split('.');for(e=0;e<a.length-1;e++){var d=a[e];d in c||(c[d]={});c=c[d]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill('Promise',function(a){function b(){this.batch_=null}function c(a){return a instanceof d?a:new d(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};b.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var e=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){e(a,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(k){this.asyncThrow_(k)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var d=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(l){b.reject(l)}};d.prototype.createResolveAndReject_=
function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};d.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError('A Promise cannot resolve to itself'));else if(a instanceof d)this.settleSameAsPromise_(a);else{a:switch(typeof a){case 'object':var b=null!=a;break a;case 'function':b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};d.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(l){this.reject_(l);return}'function'==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};d.prototype.reject_=function(a){this.settle_(2,a)};d.prototype.fulfill_=function(a){this.settle_(1,a)};d.prototype.settle_=function(a,b){if(0!=this.state_)throw Error('Cannot settle('+a+', '+b+'): Promise already settled in state'+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};d.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var f=new b;d.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};d.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(k){c.reject(k)}};d.prototype.then=function(a,b){function c(a,b){return'function'==typeof a?function(b){try{e(a(b))}catch(q){f(q)}}:
b}var e,f,g=new d(function(a,b){e=a;f=b});this.callWhenSettled_(c(a,e),c(b,f));return g};d.prototype.catch=function(a){return this.then(void 0,a)};d.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error('Unexpected state: '+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};d.resolve=c;d.reject=function(a){return new d(function(b,c){c(a)})};d.race=function(a){return new d(function(b,
d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,d)})};d.all=function(a){var b=$jscomp.makeIterator(a),e=b.next();return e.done?c([]):new d(function(a,d){function f(b){return function(c){l[b]=c;g--;0==g&&a(l)}}var l=[],g=0;do l.push(void 0),g++,c(e.value).callWhenSettled_(f(l.length-1),d),e=b.next();while(!e.done)})};return d},'es6','es3');
$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,e,d){return c==a&&'q'==e&&d==b}}));return!0===b.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill('WeakMap',function(a){function b(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(m){return!1}}function c(a){$jscomp.owns(a,d)||$jscomp.defineProperty(a,d,{value:{}})}function e(a){var b=Object[a];b&&(Object[a]=function(a){c(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;
var d='$jscomp_hidden_'+Math.random();e('freeze');e('preventExtensions');e('seal');var f=0,g=function(a){this.id_=(f+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};g.prototype.set=function(a,b){c(a);if(!$jscomp.owns(a,d))throw Error('WeakMap key fail: '+a);a[d][this.id_]=b;return this};g.prototype.get=function(a){return $jscomp.owns(a,d)?a[d][this.id_]:void 0};g.prototype.has=
function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)};g.prototype.delete=function(a){return $jscomp.owns(a,d)&&$jscomp.owns(a[d],this.id_)?delete a[d][this.id_]:!1};return g},'es6','es3');$jscomp.MapEntry=function(){};
$jscomp.polyfill('Map',function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||'function'!=typeof a||!a.prototype.entries||'function'!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,'s']]));if('s'!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},'t')!=c||2!=c.size)return!1;var d=c.entries(),e=d.next();if(e.done||e.value[0]!=b||'s'!=e.value[1])return!1;e=d.next();return e.done||4!=e.value[0].x||'t'!=e.value[1]||!d.next().done?!1:!0}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=new WeakMap,e=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};e.prototype.set=function(a,b){a=0===a?0:a;var c=d(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};e.prototype.delete=function(a){a=d(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};e.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};e.prototype.has=function(a){return!!d(this,a).entry};
e.prototype.get=function(a){return(a=d(this,a).entry)&&a.value};e.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return f(this,function(a){return a.key})};e.prototype.values=function(){return f(this,function(a){return a.value})};e.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var d=function(a,b){var d=b&&typeof b;'object'==
d||'function'==d?c.has(b)?d=c.get(b):(d=''+ ++h,c.set(b,d)):d='p_'+b;var e=a.data_[d];if(e&&$jscomp.owns(a.data_,d))for(a=0;a<e.length;a++){var f=e[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:d,list:e,index:a,entry:f}}return{id:d,list:e,index:-1,entry:void 0}},f=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return e},'es6','es3');$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+='');var c=0,e={next:function(){if(c<a.length){var d=c++;return{value:b(d,a[d]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill('Array.prototype.keys',function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},'es6','es3');
$jscomp.polyfill('Set',function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||'function'!=typeof a||!a.prototype.entries||'function'!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var f=c.entries(),g=f.next();if(g.done||g.value[0]!=b||g.value[1]!=b)return!1;g=f.next();return g.done||g.value[0]==b||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};c.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};c.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};c.prototype.clear=
function(){this.map_.clear();this.size=0};c.prototype.has=function(a){return this.map_.has(a)};c.prototype.entries=function(){return this.map_.entries()};c.prototype.values=function(){return this.map_.values()};c.prototype.keys=c.prototype.values;c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return c},'es6','es3');
$jscomp.polyfill('Object.is',function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},'es6','es3');$jscomp.polyfill('Array.prototype.includes',function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var d=b.length;c=c||0;for(0>c&&(c=Math.max(c+d,0));c<d;c++){var f=b[c];if(f===a||Object.is(f,a))return!0}return!1}},'es7','es3');
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+' must not be null or undefined');if(b instanceof RegExp)throw new TypeError('First argument to String.prototype.'+c+' must not be a regular expression');return a+''};$jscomp.polyfill('String.prototype.includes',function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,'includes').indexOf(a,c||0)}},'es6','es3');
$jscomp.polyfill('String.prototype.repeat',function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,'repeat');if(0>a||1342177279<a)throw new RangeError('Invalid count value');a|=0;for(var e='';a;)if(a&1&&(e+=b),a>>>=1)b+=b;return e}},'es6','es3');$jscomp.stringPadding=function(a,b){a=void 0!==a?String(a):' ';return 0<b&&a?a.repeat(Math.ceil(b/a.length)).substring(0,b):''};
$jscomp.polyfill('String.prototype.padEnd',function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,null,'padStart');return b+$jscomp.stringPadding(c,a-b.length)}},'es8','es3');$jscomp.polyfill('Array.prototype.fill',function(a){return a?a:function(a,c,e){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==e||e>b)e=b;e=Number(e);0>e&&(e=Math.max(0,b+e));for(c=Number(c||0);c<e;c++)this[c]=a;return this}},'es6','es3');
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var e=a.length,d=0;d<e;d++){var f=a[d];if(b.call(c,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill('Array.prototype.find',function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},'es6','es3');$jscomp.assign='function'==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var e=arguments[c];if(e)for(var d in e)$jscomp.owns(e,d)&&(a[d]=e[d])}return a};
$jscomp.polyfill('Object.assign',function(a){return a||$jscomp.assign},'es6','es3');$jscomp.polyfill('Number.MAX_SAFE_INTEGER',function(){return 9007199254740991},'es6','es3');
$jscomp.polyfill('Array.from',function(a){return a?a:function(a,c,e){$jscomp.initSymbolIterator();c=null!=c?c:function(a){return a};var b=[],f=a[Symbol.iterator];if('function'==typeof f){a=f.call(a);for(var g=0;!(f=a.next()).done;)b.push(c.call(e,f.value,g++))}else for(f=a.length,g=0;g<f;g++)b.push(c.call(e,a[g],g));return b}},'es6','es3');$jscomp.polyfill('Array.prototype.values',function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},'es8','es3');
$jscomp.polyfill('Number.isNaN',function(a){return a?a:function(a){return'number'===typeof a&&isNaN(a)}},'es6','es3');
(function(a){function b(a,b,c,d){d=void 0===d||0===d?1:d;a=a.slice(c,c+b.BYTES_PER_ELEMENT*d);b=new b(a);if(void 0===d||1===d)return b[0];a=[];for(c=0;c<d;c++)a.push(b[c]);return a}var c={0:function(a){return{position:[a.getInt32(0,!0),a.getInt32(4,!0),a.getInt32(8,!0)],intensity:a.getUint16(12,!0),classification:a.getUint8(16,!0)}},1:function(a){return{position:[a.getInt32(0,!0),a.getInt32(4,!0),a.getInt32(8,!0)],intensity:a.getUint16(12,!0),classification:a.getUint8(16,!0)}},2:function(a){return{position:[a.getInt32(0,
!0),a.getInt32(4,!0),a.getInt32(8,!0)],intensity:a.getUint16(12,!0),classification:a.getUint8(16,!0),color:[a.getUint16(20,!0),a.getUint16(22,!0),a.getUint16(24,!0)]}},3:function(a){return{position:[a.getInt32(0,!0),a.getInt32(4,!0),a.getInt32(8,!0)],intensity:a.getUint16(12,!0),classification:a.getUint8(16,!0),color:[a.getUint16(28,!0),a.getUint16(30,!0),a.getUint16(32,!0)]}}},e={};a.handleMessage=function(a){var b=a.data,c=e[b.id];delete e[b.id];setTimeout(function(){if(b.error)return c.reject(Error(b.message||
'Unknown Error'));if(b.hasOwnProperty('count')&&b.hasOwnProperty('hasMoreData'))return c.resolve({buffer:b.result,count:b.count,hasMoreData:b.hasMoreData});c.resolve(b.result)},0)};var d=function(a){this.arraybuffer=a};d.prototype.open=function(){this.readOffset=0;return new Promise(function(a,b){setTimeout(a,0)})};d.prototype.getHeader=function(){var a=this;return new Promise(function(c,d){setTimeout(function(){var d=a.arraybuffer,e={};e.pointsOffset=b(d,Uint32Array,96);e.pointsFormatId=b(d,Uint8Array,
104);e.pointsStructSize=b(d,Uint16Array,105);e.pointsCount=b(d,Uint32Array,107);var f=131;e.scale=b(d,Float64Array,f,3);f+=24;e.offset=b(d,Float64Array,f,3);d=b(d,Float64Array,f+24,6);e.maxs=[d[0],d[2],d[4]];e.mins=[d[1],d[3],d[5]];a.header=e;c(a.header)},0)})};d.prototype.readData=function(a,b,c){var d=this;return new Promise(function(b,e){setTimeout(function(){if(!d.header)return e(Error('Cannot start reading data till a header request is issued'));if(1>=c){a=Math.min(a,d.header.pointsCount-d.readOffset);
var f=d.header.pointsOffset+d.readOffset*d.header.pointsStructSize;b({buffer:d.arraybuffer.slice(f,f+a*d.header.pointsStructSize),count:a,hasMoreData:d.readOffset+a<d.header.pointsCount});d.readOffset+=a}else{for(var g=Math.min(a*c,d.header.pointsCount-d.readOffset),k=0,h=new Uint8Array(Math.ceil(g/c)*d.header.pointsStructSize),l=0;l<g;l++)0===l%c&&(f=d.header.pointsOffset+d.readOffset*d.header.pointsStructSize,f=new Uint8Array(d.arraybuffer,f,d.header.pointsStructSize),h.set(f,k*d.header.pointsStructSize),
k++),d.readOffset++;b({buffer:h.buffer,count:k,hasMoreData:d.readOffset<d.header.pointsCount})}},0)})};d.prototype.close=function(){var a=this;return new Promise(function(b,c){a.arraybuffer=null;setTimeout(b,0)})};var f=function(a){this.arraybuffer=a;this.ww=Potree.workerPool.getWorker(Potree.scriptPath+'/workers/LASLAZWorker.js');this.nextCB=null;var b=this;this.ww.onmessage=function(a){null!==b.nextCB&&(b.nextCB(a.data),b.nextCB=null)};this.dorr=function(a,c){b.nextCB=c;b.ww.postMessage(a)}};f.prototype.open=
function(){var a=this;return new Promise(function(b,c){a.dorr({type:'open',arraybuffer:a.arraybuffer},function(a){if(1!==a.status)return c(Error('Failed to open file'));b(!0)})})};f.prototype.getHeader=function(){var a=this;return new Promise(function(b,c){a.dorr({type:'header'},function(a){if(1!==a.status)return c(Error('Failed to get header'));b(a.header)})})};f.prototype.readData=function(a,b,c){var d=this;return new Promise(function(e,f){d.dorr({type:'read',count:a,offset:b,skip:c},function(a){if(1!==
a.status)return f(Error('Failed to read data'));e({buffer:a.buffer,count:a.count,hasMoreData:a.hasMoreData})})})};f.prototype.close=function(){var a=this;return new Promise(function(b,c){a.dorr({type:'close'},function(d){Potree.workerPool.returnWorker(Potree.scriptPath+'/workers/LASLAZWorker.js',a.ww);if(1!==d.status)return c(Error('Failed to close file'));b(!0)})})};var g=function(a){this.arraybuffer=a;this.determineVersion();if(12<this.version)throw Error('Only file versions <= 1.2 are supported at this time');
this.determineFormat();if(void 0===c[this.formatId])throw Error('The point format ID is not supported');this.loader=this.isCompressed?new f(this.arraybuffer):new d(this.arraybuffer)};g.prototype.determineFormat=function(){var a=b(this.arraybuffer,Uint8Array,104),c=(a&128)>>7,d=(a&64)>>6;if(1===c&&1===d)throw Error('Old style compression not supported');this.formatId=a&63;this.isCompressed=1===c||1===d};g.prototype.determineVersion=function(){var a=new Int8Array(this.arraybuffer,24,2);this.version=
10*a[0]+a[1];this.versionAsString=a[0]+'.'+a[1]};g.prototype.open=function(){return this.loader.open()};g.prototype.getHeader=function(){return this.loader.getHeader()};g.prototype.readData=function(a,b,c){return this.loader.readData(a,b,c)};g.prototype.close=function(){return this.loader.close()};var h=function(a,b,d,e,f,g,h,q){this.arrayb=a;this.decoder=c[b];this.pointsCount=e;this.pointSize=d;this.scale=f;this.offset=g;this.mins=h;this.maxs=q};h.prototype.getPoint=function(a){if(0>a||a>=this.pointsCount)throw Error('Point index out of range');
a=new DataView(this.arrayb,a*this.pointSize,this.pointSize);return this.decoder(a)};a.LAZLoader=f;a.LASLoader=d;a.LASFile=g;a.LASDecoder=h;a.LASModuleWasLoaded=!1})(this);function BinaryHeap(a){this.content=[];this.scoreFunction=a}
BinaryHeap.prototype={push:function(a){this.content.push(a);this.bubbleUp(this.content.length-1)},pop:function(){var a=this.content[0],b=this.content.pop();0<this.content.length&&(this.content[0]=b,this.sinkDown(0));return a},remove:function(a){for(var b=this.content.length,c=0;c<b;c++)if(this.content[c]==a){a=this.content.pop();if(c==b-1)break;this.content[c]=a;this.bubbleUp(c);this.sinkDown(c);break}},size:function(){return this.content.length},bubbleUp:function(a){for(var b=this.content[a],c=this.scoreFunction(b);0<
a;){var e=Math.floor((a+1)/2)-1,d=this.content[e];if(c>=this.scoreFunction(d))break;this.content[e]=b;this.content[a]=d;a=e}},sinkDown:function(a){for(var b=this.content.length,c=this.content[a],e=this.scoreFunction(c);;){var d=2*(a+1),f=d-1,g=null;if(f<b){var h=this.scoreFunction(this.content[f]);h<e&&(g=f)}d<b&&this.scoreFunction(this.content[d])<(null==g?e:h)&&(g=d);if(null==g)break;this.content[a]=this.content[g];this.content[g]=c;a=g}}};function Potree(){}Potree.pointBudget=1E6;Potree.framenumber=0;Potree.numNodesLoading=0;Potree.maxNodesLoading=4;Potree.debug={};Potree.scriptPath=null;document.currentScript.src?(Potree.scriptPath=(new URL(document.currentScript.src+'/..')).href,'/'===Potree.scriptPath.slice(-1)&&(Potree.scriptPath=Potree.scriptPath.slice(0,-1))):console.error('Potree was unable to find its script path using document.currentScript. Is Potree included with a script tag? Does your browser support this function?');
Potree.resourcePath=Potree.scriptPath+'/resources';Potree.ClipTask={NONE:0,HIGHLIGHT:1,SHOW_INSIDE:2,SHOW_OUTSIDE:3};Potree.ClipMethod={INSIDE_ANY:0,INSIDE_ALL:1};Potree.measureTimings=!1;Potree.tempVector3=new THREE.Vector3;
Potree.updatePointClouds=function(a,b,c){Potree.lru||(Potree.lru=new LRU);for(var e=$jscomp.makeIterator(a),d=e.next();!d.done;d=e.next()){var f=d.value;d=performance.now();f=$jscomp.makeIterator(f.profileRequests);for(var g=f.next();!g.done&&!(g.value.update(),5<performance.now()-d);g=f.next());performance.now()}e=Potree.updateVisibility(a,b,c);a=$jscomp.makeIterator(a);for(d=a.next();!d.done;d=a.next())d=d.value,d.updateMaterial(d.material,d.visibleNodes,b,c),d.updateVisibleBounds();Potree.getLRU().freeMemory();
return e};Potree.getLRU=function(){Potree.lru||(Potree.lru=new LRU);return Potree.lru};
Potree.updateVisibilityStructures=function(a,b,c){c=[];for(var e=[],d=new BinaryHeap(function(a){return 1/a.weight}),f=0;f<a.length;f++){var g=a[f];if(g.initialized()){g.numVisibleNodes=0;g.numVisiblePoints=0;g.deepestVisibleLevel=0;g.visibleNodes=[];g.visibleGeometry=[];b.updateMatrixWorld();var h=new THREE.Frustum,l=b.matrixWorldInverse,k=g.matrixWorld,m=b.clone();m.near=Math.min(b.near,.1);m.updateProjectionMatrix();m=b.projectionMatrix;l=(new THREE.Matrix4).multiply(m).multiply(l).multiply(k);
h.setFromMatrix(l);c.push(h);h=b.matrixWorld;k=(new THREE.Matrix4).getInverse(k);k=(new THREE.Matrix4).multiply(k).multiply(h);k=(new THREE.Vector3).setFromMatrixPosition(k);e.push(k);g.visible&&null!==g.root&&d.push({pointcloud:f,node:g.root,weight:Number.MAX_VALUE});g.root.isTreeNode()&&g.hideDescendants(g.root.sceneNode);for(k=0;k<g.boundingBoxNodes.length;k++)g.boundingBoxNodes[k].visible=!1}}return{frustums:c,camObjPositions:e,priorityQueue:d}};
Potree.getDEMWorkerInstance=function(){Potree.DEMWorkerInstance||(Potree.DEMWorkerInstance=Potree.workerPool.getWorker(Potree.scriptPath+'/workers/DEMWorker.js'));return Potree.DEMWorkerInstance};
Potree.updateVisibility=function(a,b,c){var e=0,d=new Map(a.map(function(a){return[a,0]})),f=[],g=[],h=[],l=Infinity,k=Potree.updateVisibilityStructures(a,b,c),m=k.frustums,p=k.camObjPositions;k=k.priorityQueue;var n=0;c=c.domElement.clientHeight;Potree._pointcloudTransformVersion||(Potree._pointcloudTransformVersion=new Map);for(var r=Potree._pointcloudTransformVersion,t=$jscomp.makeIterator(a),q=t.next();!q.done;q=t.next())if(q=q.value,q.visible)if(q.updateMatrixWorld(),r.has(q)){var u=r.get(q);
u.transform.equals(q.matrixWorld)||(u.number++,u.transform.copy(q.matrixWorld),q.dispatchEvent({type:'transformation_changed',target:q}))}else r.set(q,{number:0,transform:q.matrixWorld.clone()});for(;0<k.size();){t=k.pop();q=t.node;var z=t.parent;u=a[t.pointcloud];var A=q.getBoundingBox(),w=p[t.pointcloud],v=m[t.pointcloud].intersectsBox(A);A=u.maxLevel||Infinity;var x=q.getLevel();v=(v=(v=v&&!(e+q.getNumPoints()>Potree.pointBudget))&&!(d.get(u)+q.getNumPoints()>u.pointBudget))&&x<A;q.spacing?l=Math.min(l,
q.spacing):q.geometryNode&&q.geometryNode.spacing&&(l=Math.min(l,q.geometryNode.spacing));if(e+q.getNumPoints()>Potree.pointBudget)break;if(v)for(e+=q.getNumPoints(),A=d.get(u),d.set(u,A+q.getNumPoints()),u.numVisibleNodes++,u.numVisiblePoints+=q.getNumPoints(),!q.isGeometryNode()||z&&!z.isTreeNode()||(q.isLoaded()&&2>n?(q=u.toTreeNode(q,z),n++):(h.push(q),g.push(q))),q.isTreeNode()&&(Potree.getLRU().touch(q.geometryNode),q.sceneNode.visible=!0,q.sceneNode.material=u.material,f.push(q),u.visibleNodes.push(q),
void 0===q._transformVersion&&(q._transformVersion=-1),z=r.get(u),q._transformVersion!==z.number&&(q.sceneNode.updateMatrix(),q.sceneNode.matrixWorld.multiplyMatrices(u.matrixWorld,q.sceneNode.matrix),q._transformVersion=z.number),u.showBoundingBox&&!q.boundingBoxNode&&q.getBoundingBox?(z=new Potree.Box3Helper(q.getBoundingBox()),z.matrixAutoUpdate=!1,u.boundingBoxNodes.push(z),q.boundingBoxNode=z,q.boundingBoxNode.matrix.copy(u.matrixWorld)):u.showBoundingBox?(q.boundingBoxNode.visible=!0,q.boundingBoxNode.matrix.copy(u.matrixWorld)):
!u.showBoundingBox&&q.boundingBoxNode&&(q.boundingBoxNode.visible=!1)),z=q.getChildren(),A=0;A<z.length;A++){x=z[A];var y=0;if(b.isPerspectiveCamera){v=x.getBoundingSphere(new THREE.Sphere);var B=v.center,C=w.x-B.x;y=w.y-B.y;B=w.z-B.z;C=Math.sqrt(C*C+y*y+B*B);v=v.radius;y=.5*c/(Math.tan(b.fov*Math.PI/180/2)*C)*v;if(y<u.minimumNodePixelSize)continue;0>C-v&&(y=Number.MAX_VALUE)}else v=x.getBoundingBox(),C=x.getBoundingSphere(new THREE.Sphere).center.distanceTo(w),y=v.max.clone().sub(v.min).length()/
C;k.push({pointcloud:t.pointcloud,node:x,parent:q,weight:y})}}a=a.filter(function(a){return a.generateDEM&&a.dem instanceof Potree.DEM});a=$jscomp.makeIterator(a);for(q=a.next();!q.done;q=a.next())b=q.value,d=b.visibleNodes.filter(function(a){return 4>=a.getLevel()}),b.dem.update(d);for(a=0;a<Math.min(Potree.maxNodesLoading,h.length);a++)h[a].load();return{visibleNodes:f,numVisiblePoints:e,lowestSpacing:l}};
Potree.paramThreeToGL=function(a,b){if(b===THREE.RepeatWrapping)return a.REPEAT;if(b===THREE.ClampToEdgeWrapping)return a.CLAMP_TO_EDGE;if(b===THREE.MirroredRepeatWrapping)return a.MIRRORED_REPEAT;if(b===THREE.NearestFilter)return a.NEAREST;if(b===THREE.NearestMipMapNearestFilter)return a.NEAREST_MIPMAP_NEAREST;if(b===THREE.NearestMipMapLinearFilter)return a.NEAREST_MIPMAP_LINEAR;if(b===THREE.LinearFilter)return a.LINEAR;if(b===THREE.LinearMipMapNearestFilter)return a.LINEAR_MIPMAP_NEAREST;if(b===
THREE.LinearMipMapLinearFilter)return a.LINEAR_MIPMAP_LINEAR;if(b===THREE.UnsignedByteType)return a.UNSIGNED_BYTE;if(b===THREE.UnsignedShort4444Type)return a.UNSIGNED_SHORT_4_4_4_4;if(b===THREE.UnsignedShort5551Type)return a.UNSIGNED_SHORT_5_5_5_1;if(b===THREE.UnsignedShort565Type)return a.UNSIGNED_SHORT_5_6_5;if(b===THREE.ByteType)return a.BYTE;if(b===THREE.ShortType)return a.SHORT;if(b===THREE.UnsignedShortType)return a.UNSIGNED_SHORT;if(b===THREE.IntType)return a.INT;if(b===THREE.UnsignedIntType)return a.UNSIGNED_INT;
if(b===THREE.FloatType)return a.FLOAT;if(b===THREE.HalfFloatType){var c=extensions.get('OES_texture_half_float');if(null!==c)return c.HALF_FLOAT_OES}if(b===THREE.AlphaFormat)return a.ALPHA;if(b===THREE.RGBFormat)return a.RGB;if(b===THREE.RGBAFormat)return a.RGBA;if(b===THREE.LuminanceFormat)return a.LUMINANCE;if(b===THREE.LuminanceAlphaFormat)return a.LUMINANCE_ALPHA;if(b===THREE.DepthFormat)return a.DEPTH_COMPONENT;if(b===THREE.DepthStencilFormat)return a.DEPTH_STENCIL;if(b===THREE.AddEquation)return a.FUNC_ADD;
if(b===THREE.SubtractEquation)return a.FUNC_SUBTRACT;if(b===THREE.ReverseSubtractEquation)return a.FUNC_REVERSE_SUBTRACT;if(b===THREE.ZeroFactor)return a.ZERO;if(b===THREE.OneFactor)return a.ONE;if(b===THREE.SrcColorFactor)return a.SRC_COLOR;if(b===THREE.OneMinusSrcColorFactor)return a.ONE_MINUS_SRC_COLOR;if(b===THREE.SrcAlphaFactor)return a.SRC_ALPHA;if(b===THREE.OneMinusSrcAlphaFactor)return a.ONE_MINUS_SRC_ALPHA;if(b===THREE.DstAlphaFactor)return a.DST_ALPHA;if(b===THREE.OneMinusDstAlphaFactor)return a.ONE_MINUS_DST_ALPHA;
if(b===THREE.DstColorFactor)return a.DST_COLOR;if(b===THREE.OneMinusDstColorFactor)return a.ONE_MINUS_DST_COLOR;if(b===THREE.SrcAlphaSaturateFactor)return a.SRC_ALPHA_SATURATE;if(b===THREE.RGB_S3TC_DXT1_Format||b===RGBA_S3TC_DXT1_Format||b===THREE.RGBA_S3TC_DXT3_Format||b===RGBA_S3TC_DXT5_Format)if(c=extensions.get('WEBGL_compressed_texture_s3tc'),null!==c){if(b===THREE.RGB_S3TC_DXT1_Format)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(b===THREE.RGBA_S3TC_DXT1_Format)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;
if(b===THREE.RGBA_S3TC_DXT3_Format)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(b===THREE.RGBA_S3TC_DXT5_Format)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(b===THREE.RGB_PVRTC_4BPPV1_Format||b===THREE.RGB_PVRTC_2BPPV1_Format||b===THREE.RGBA_PVRTC_4BPPV1_Format||b===THREE.RGBA_PVRTC_2BPPV1_Format)if(c=extensions.get('WEBGL_compressed_texture_pvrtc'),null!==c){if(b===THREE.RGB_PVRTC_4BPPV1_Format)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(b===THREE.RGB_PVRTC_2BPPV1_Format)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
if(b===THREE.RGBA_PVRTC_4BPPV1_Format)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(b===THREE.RGBA_PVRTC_2BPPV1_Format)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(b===THREE.RGB_ETC1_Format&&(c=extensions.get('WEBGL_compressed_texture_etc1'),null!==c))return c.COMPRESSED_RGB_ETC1_WEBGL;if(b===THREE.MinEquation||b===THREE.MaxEquation)if(c=extensions.get('EXT_blend_minmax'),null!==c){if(b===THREE.MinEquation)return c.MIN_EXT;if(b===THREE.MaxEquation)return c.MAX_EXT}return b===UnsignedInt248Type&&(c=
extensions.get('WEBGL_depth_texture'),null!==c)?c.UNSIGNED_INT_24_8_WEBGL:0};Potree.attributeLocations={position:0,color:1,intensity:2,classification:3,returnNumber:4,numberOfReturns:5,pointSourceID:6,indices:7,normal:8,spacing:9};var EnumItem=function(a){for(var b=$jscomp.makeIterator(Object.keys(a)),c=b.next();!c.done;c=b.next())c=c.value,this[c]=a[c]};EnumItem.prototype.inspect=function(){return'Enum('+this.name+': '+this.value+')'};
var Enum=function(a){this.object=a;for(var b=$jscomp.makeIterator(Object.keys(a)),c=b.next();!c.done;c=b.next()){c=c.value;var e=a[c];'object'===typeof e?e.name=c:e={name:c,value:e};this[c]=new EnumItem(e)}};Enum.prototype.fromValue=function(a){for(var b=$jscomp.makeIterator(Object.keys(this.object)),c=b.next();!c.done;c=b.next())if(c=c.value,this[c].value===a)return this[c];throw Error('No enum for value: '+a);};
var lib$potree$potree_clean$classdecl$var0=function(){this.boundingBox=new THREE.Box3;this.numPoints=0;this.data={}};
lib$potree$potree_clean$classdecl$var0.prototype.add=function(a){var b=this.numPoints,c=b+a.numPoints,e=Object.keys(this.data),d=Object.keys(a.data),f=new Set([].concat($jscomp.arrayFromIterable(e),$jscomp.arrayFromIterable(d)));f=$jscomp.makeIterator(f);for(var g=f.next();!g.done;g=f.next())if(g=g.value,e.includes(g)&&d.includes(g)){var h=new this.data[g].constructor(this.data[g].length+a.data[g].length);h.set(this.data[g],0);h.set(a.data[g],this.data[g].length);this.data[g]=h}else if(e.includes(g)&&
!d.includes(g))h=new this.data[g].constructor(this.data[g].length/this.numPoints*c),h.set(this.data[g],0),this.data[g]=h;else if(!e.includes(g)&&d.includes(g)){h=a.data[g].length/a.numPoints;var l=new a.data[g].constructor(h*c);l.set(a.data[g],h*b);this.data[g]=l}this.numPoints=c;this.boundingBox.union(a.boundingBox)};Potree.Points=lib$potree$potree_clean$classdecl$var0;
var lib$potree$potree_clean$classdecl$var1=function(a,b,c,e){this.gl=a;this.name=b;this.vsSource=c;this.fsSource=e;this.cache=new Map;this.program=this.fs=this.vs=null;this.uniformLocations={};this.attributeLocations={};this.update(c,e)};lib$potree$potree_clean$classdecl$var1.prototype.update=function(a,b){this.vsSource=a;this.fsSource=b;this.linkProgram()};
lib$potree$potree_clean$classdecl$var1.prototype.compileShader=function(a,b){var c=this.gl;c.shaderSource(a,b);c.compileShader(a);if(!c.getShaderParameter(a,c.COMPILE_STATUS))throw a=c.getShaderInfoLog(a),b=b.split('\n').map(function(a,b){return(''+(b+1)).padEnd(5)+a}).join('\n'),'could not compile shader '+this.name+': '+a+', \n'+b;};
lib$potree$potree_clean$classdecl$var1.prototype.linkProgram=function(){var a=this.gl;this.uniformLocations={};this.attributeLocations={};a.useProgram(null);var b=this.cache.get(this.vsSource+', '+this.fsSource);if(b)this.program=b.program,this.vs=b.vs,this.fs=b.fs,this.attributeLocations=b.attributeLocations,this.uniformLocations=b.uniformLocations;else{this.vs=a.createShader(a.VERTEX_SHADER);this.fs=a.createShader(a.FRAGMENT_SHADER);this.program=a.createProgram();b=$jscomp.makeIterator(Object.keys(Potree.attributeLocations));
for(var c=b.next();!c.done;c=b.next())c=c.value,a.bindAttribLocation(this.program,Potree.attributeLocations[c],c);this.compileShader(this.vs,this.vsSource);this.compileShader(this.fs,this.fsSource);b=this.program;a.attachShader(b,this.vs);a.attachShader(b,this.fs);a.linkProgram(b);a.detachShader(b,this.vs);a.detachShader(b,this.fs);if(!a.getProgramParameter(b,a.LINK_STATUS))throw a=a.getProgramInfoLog(b),'could not link program '+this.name+': '+a;c=a.getProgramParameter(b,a.ACTIVE_ATTRIBUTES);for(var e=
0;e<c;e++){var d=a.getActiveAttrib(b,e),f=a.getAttribLocation(b,d.name);this.attributeLocations[d.name]=f}c=a.getProgramParameter(b,a.ACTIVE_UNIFORMS);for(e=0;e<c;e++)d=a.getActiveUniform(b,e),f=a.getUniformLocation(b,d.name),this.uniformLocations[d.name]=f;this.cache.set(this.vsSource+', '+this.fsSource,{program:this.program,vs:this.vs,fs:this.fs,attributeLocations:this.attributeLocations,uniformLocations:this.uniformLocations})}};
lib$potree$potree_clean$classdecl$var1.prototype.setUniformMatrix4=function(a,b){var c=this.gl;a=this.uniformLocations[a];null!=a&&(b=new Float32Array(b.elements),c.uniformMatrix4fv(a,!1,b))};lib$potree$potree_clean$classdecl$var1.prototype.setUniform1f=function(a,b){a=this.uniformLocations[a];null!=a&&this.gl.uniform1f(a,b)};lib$potree$potree_clean$classdecl$var1.prototype.setUniformBoolean=function(a,b){a=this.uniformLocations[a];null!=a&&this.gl.uniform1i(a,b)};
lib$potree$potree_clean$classdecl$var1.prototype.setUniformTexture=function(a,b){a=this.uniformLocations[a];null!=a&&this.gl.uniform1i(a,b)};lib$potree$potree_clean$classdecl$var1.prototype.setUniform2f=function(a,b){a=this.uniformLocations[a];null!=a&&this.gl.uniform2f(a,b[0],b[1])};lib$potree$potree_clean$classdecl$var1.prototype.setUniform3f=function(a,b){a=this.uniformLocations[a];null!=a&&this.gl.uniform3f(a,b[0],b[1],b[2])};
lib$potree$potree_clean$classdecl$var1.prototype.setUniform=function(a,b){b.constructor===THREE.Matrix4?this.setUniformMatrix4(a,b):'number'===typeof b?this.setUniform1f(a,b):'boolean'===typeof b?this.setUniformBoolean(a,b):b instanceof Potree.WebGLTexture?this.setUniformTexture(a,b):b instanceof Array?2===b.length?this.setUniform2f(a,b):3===b.length&&this.setUniform3f(a,b):console.error('unhandled uniform type: ',a,b)};
lib$potree$potree_clean$classdecl$var1.prototype.setUniform1i=function(a,b){a=this.uniformLocations[a];null!=a&&this.gl.uniform1i(a,b)};Potree.Shader=lib$potree$potree_clean$classdecl$var1;var lib$potree$potree_clean$classdecl$var2=function(a,b){this.gl=a;this.texture=b;this.id=a.createTexture();this.target=a.TEXTURE_2D;this.version=-1;this.update(b)};
lib$potree$potree_clean$classdecl$var2.prototype.update=function(){if(this.texture.image){var a=this.gl,b=this.texture;if(this.version!==b.version){this.target=a.TEXTURE_2D;a.bindTexture(this.target,this.id);var c=Potree.paramThreeToGL(a,b.format),e=b.image.width,d=b.image.height,f=Potree.paramThreeToGL(a,b.type);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,b.flipY);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.premultiplyAlpha);a.pixelStorei(a.UNPACK_ALIGNMENT,b.unpackAlignment);if(b instanceof THREE.DataTexture){var g=
b.image.data;a.texParameteri(this.target,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(this.target,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.texParameteri(this.target,a.TEXTURE_MAG_FILTER,Potree.paramThreeToGL(a,b.magFilter));a.texParameteri(this.target,a.TEXTURE_MIN_FILTER,Potree.paramThreeToGL(a,b.minFilter));a.texImage2D(this.target,0,c,e,d,0,c,f,g)}else b instanceof THREE.CanvasTexture&&(g=b.image,a.texParameteri(this.target,a.TEXTURE_WRAP_S,Potree.paramThreeToGL(a,b.wrapS)),a.texParameteri(this.target,
a.TEXTURE_WRAP_T,Potree.paramThreeToGL(a,b.wrapT)),a.texParameteri(this.target,a.TEXTURE_MAG_FILTER,Potree.paramThreeToGL(a,b.magFilter)),a.texParameteri(this.target,a.TEXTURE_MIN_FILTER,Potree.paramThreeToGL(a,b.minFilter)),a.texImage2D(this.target,0,c,c,f,g));a.bindTexture(this.target,null);this.version=b.version}}else this.version=this.texture.version};Potree.WebGLTexture=lib$potree$potree_clean$classdecl$var2;
var lib$potree$potree_clean$classdecl$var3=function(){this.numElements=0;this.vao=null;this.vbos=new Map};Potree.WebGLBuffer=lib$potree$potree_clean$classdecl$var3;var lib$potree$potree_clean$classdecl$var4=function(a,b,c){this.name=a;this.box=b;this.tileSize=c;this.level=this.name.length-1;this.data=new Float32Array(c*c);this.data.fill(-Infinity);this.children=[];this.mipMap=[this.data];this.mipMapNeedsUpdate=!0};
lib$potree$potree_clean$classdecl$var4.prototype.createMipMap=function(){this.mipMap=[this.data];for(var a=this.tileSize,b=parseInt(a/2),c=this.data;1<b;){for(var e=new Float32Array(b*b),d=0;d<b;d++)for(var f=0;f<b;f++){var g=c[2*d+2*f*a],h=c[2*d+2*f*a+a],l=c[2*d+1+2*f*a],k=c[2*d+1+2*f*a+a],m=$jscomp.makeIterator([0,0]),p=m.next().value;m=m.next().value;isFinite(g)&&(p+=g,m+=1);isFinite(h)&&(p+=h,m+=1);isFinite(l)&&(p+=l,m+=1);isFinite(k)&&(p+=k,m+=1);p/=m;e[d+f*b]=p}this.mipMap.push(e);c=e;a=b;b=
parseInt(b/2)}this.mipMapNeedsUpdate=!1};lib$potree$potree_clean$classdecl$var4.prototype.uv=function(a){var b=this.box.getSize(new THREE.Vector3);return[(a.x-this.box.min.x)/b.x,(a.y-this.box.min.y)/b.y]};
lib$potree$potree_clean$classdecl$var4.prototype.heightAtMipMapLevel=function(a,b){a=this.uv(a);var c=parseInt(this.tileSize/parseInt(Math.pow(2,b))),e=this.mipMap[b],d=Math.min(a[0]*c,c-1),f=Math.min(a[1]*c,c-1);a=d%1;b=f%1;var g=$jscomp.makeIterator([Math.floor(d),Math.ceil(d)]);d=g.next().value;var h=g.next().value;f=$jscomp.makeIterator([Math.floor(f),Math.ceil(f)]);g=f.next().value;var l=f.next().value;f=e[d+c*g];d=e[d+c*l];g=e[h+c*g];c=e[h+c*l];e=isFinite(f)?(1-a)*(1-b):0;h=isFinite(d)?(1-a)*
b:0;l=isFinite(g)?a*(1-b):0;a=isFinite(c)?a*b:0;b=e+h+l+a;e/=b;h/=b;l/=b;a/=b;if(0===b)return null;b=0;isFinite(f)&&(b+=f*e);isFinite(d)&&(b+=d*h);isFinite(g)&&(b+=g*l);isFinite(c)&&(b+=c*a);return b};lib$potree$potree_clean$classdecl$var4.prototype.height=function(a){for(var b=null,c=0;c<this.mipMap.length&&(b=this.heightAtMipMapLevel(a,c),null===b);c++);return b};
lib$potree$potree_clean$classdecl$var4.prototype.traverse=function(a,b){b=void 0===b?0:b;a(this,b);for(var c=$jscomp.makeIterator(this.children.filter(function(a){return void 0!==a})),e=c.next();!e.done;e=c.next())e.value.traverse(a,b+1)};Potree.DEMNode=lib$potree$potree_clean$classdecl$var4;var lib$potree$potree_clean$classdecl$var5=function(a){this.pointcloud=a;this.boundingBox=this.matrix=null;this.tileSize=64;this.root=null;this.version=0};
lib$potree$potree_clean$classdecl$var5.prototype.expandAndFindByBox=function(a,b){if(0===b)return[this.root];for(var c=[],e=[this.root];0<e.length;){var d=e.pop(),f=d.box.getSize(new THREE.Vector3),g=(a.min.x-d.box.min.x)/f.x,h=(a.min.y-d.box.min.y)/f.y,l=(a.max.x-d.box.max.x)/f.x,k=(a.max.y-d.box.max.y)/f.y;g=.5>g?0:1;h=.5>h?0:1;l=.5>l?0:1;k=.5>k?0:1;g=$jscomp.makeIterator(0===g&&0===h&&1===l&&1===k?[0,1,2,3]:g===l&&h===k?[g<<1|h]:[g<<1|h,l<<1|k]);for(h=g.next();!h.done;h=g.next())h=h.value,void 0===
d.children[h]&&(l=d.box.clone(),0<(h&2)?l.min.x+=f.x/2:l.max.x-=f.x/2,0<(h&1)?l.min.y+=f.y/2:l.max.y-=f.y/2,l=new Potree.DEMNode(d.name+h,l,this.tileSize),d.children[h]=l),h=d.children[h],h.level<b?e.push(h):c.push(h)}return c};lib$potree$potree_clean$classdecl$var5.prototype.childIndex=function(a){var b=$jscomp.makeIterator(a.map(function(a){return.5>a?0:1}));a=b.next().value;b=b.next().value;return a<<1|b};
lib$potree$potree_clean$classdecl$var5.prototype.height=function(a){if(!this.root)return 0;for(var b=null,c=[this.root];;){var e=c[c.length-1],d=e.height(a);null!==d&&(b=d);d=e.uv(a);d=this.childIndex(d);if(e.children[d])c.push(e.children[d]);else break}return b+this.pointcloud.position.z};
lib$potree$potree_clean$classdecl$var5.prototype.update=function(a){var b=this;if(!Potree.getDEMWorkerInstance().working){null!==this.matrix&&this.matrix.equals(this.pointcloud.matrixWorld)||(this.matrix=this.pointcloud.matrixWorld.clone(),this.boundingBox=this.pointcloud.boundingBox.clone().applyMatrix4(this.matrix),this.root=new Potree.DEMNode('r',this.boundingBox,this.tileSize),this.version++);var c=null;a=$jscomp.makeIterator(a);for(var e=a.next();!e.done;e=a.next())if(e=e.value,void 0===e.demVersion||
e.demVersion<this.version){c=e;break}if(null!==c){var d=c.getBoundingBox().clone().applyMatrix4(this.matrix),f=d.getSize(new THREE.Vector3),g=this.expandAndFindByBox(d,c.getLevel());c.demVersion=this.version;Potree.getDEMWorkerInstance().onmessage=function(a){a=new Float32Array(a.data.dem.data);for(var c=$jscomp.makeIterator(g),e=c.next();!e.done;e=c.next()){e=e.value;for(var h=e.box.getSize(new THREE.Vector3),p=0;p<b.tileSize;p++)for(var n=0;n<b.tileSize;n++){var r=b.tileSize*(e.box.min.x+p/(b.tileSize-
1)*h.x-d.min.x)/f.x,t=b.tileSize*(e.box.min.y+n/(b.tileSize-1)*h.y-d.min.y)/f.y;0>r||r>b.tileSize||0>t||t>b.tileSize||(r=Math.min(Math.floor(r),b.tileSize-1),t=Math.min(Math.floor(t),b.tileSize-1),e.data[p+b.tileSize*n]=a[r+b.tileSize*t])}e.createMipMap();e.mipMapNeedsUpdate=!0;Potree.getDEMWorkerInstance().working=!1}};a=c.geometryNode.geometry.attributes.position.array;c={boundingBox:{min:c.getBoundingBox().min.toArray(),max:c.getBoundingBox().max.toArray()},position:(new Float32Array(a)).buffer};
a=[c.position];Potree.getDEMWorkerInstance().working=!0;Potree.getDEMWorkerInstance().postMessage(c,a)}}};Potree.DEM=lib$potree$potree_clean$classdecl$var5;Potree.PointCloudTreeNode=function(){this.needsTransformUpdate=!0};Potree.PointCloudTreeNode.prototype.getChildren=function(){};Potree.PointCloudTreeNode.prototype.getBoundingBox=function(){};Potree.PointCloudTreeNode.prototype.isLoaded=function(){};Potree.PointCloudTreeNode.prototype.isGeometryNode=function(){};
Potree.PointCloudTreeNode.prototype.isTreeNode=function(){};Potree.PointCloudTreeNode.prototype.getLevel=function(){};Potree.PointCloudTreeNode.prototype.getBoundingSphere=function(){};var lib$potree$potree_clean$classdecl$var6=function(){var a=THREE.Object3D.call(this)||this;a.dem=new Potree.DEM(a);return a};$jscomp.inherits(lib$potree$potree_clean$classdecl$var6,THREE.Object3D);lib$potree$potree_clean$classdecl$var6.prototype.initialized=function(){return null!==this.root};
Potree.PointCloudTree=lib$potree$potree_clean$classdecl$var6;var lib$potree$potree_clean$classdecl$var7=function(){this.workers={}};lib$potree$potree_clean$classdecl$var7.prototype.getWorker=function(a){this.workers[a]||(this.workers[a]=[]);if(0===this.workers[a].length){var b=new Worker(a);this.workers[a].push(b)}return this.workers[a].pop()};lib$potree$potree_clean$classdecl$var7.prototype.returnWorker=function(a,b){this.workers[a].push(b)};Potree.WorkerPool=lib$potree$potree_clean$classdecl$var7;
Potree.workerPool=new Potree.WorkerPool;Potree.POCLoader=function(){};
Potree.POCLoader.load=function(a,b){try{var c=new Potree.PointCloudOctreeGeometry;c.url=a;var e=Potree.XHRFactory.createXMLHttpRequest();e.open('GET',a,!0);e.onreadystatechange=function(){if(4===e.readyState&&(200===e.status||0===e.status)){var d=JSON.parse(e.responseText),f=new Potree.Version(d.version);0===d.octreeDir.indexOf('http')?c.octreeDir=d.octreeDir:c.octreeDir=a+'/../'+d.octreeDir;c.spacing=d.spacing;c.hierarchyStepSize=d.hierarchyStepSize;c.pointAttributes=d.pointAttributes;var g=new THREE.Vector3(d.boundingBox.lx,
d.boundingBox.ly,d.boundingBox.lz),h=new THREE.Vector3(d.boundingBox.ux,d.boundingBox.uy,d.boundingBox.uz);h=new THREE.Box3(g,h);var l=h.clone();d.tightBoundingBox&&(l.min.copy(new THREE.Vector3(d.tightBoundingBox.lx,d.tightBoundingBox.ly,d.tightBoundingBox.lz)),l.max.copy(new THREE.Vector3(d.tightBoundingBox.ux,d.tightBoundingBox.uy,d.tightBoundingBox.uz)));g=g.clone();h.min.sub(g);h.max.sub(g);l.min.sub(g);l.max.sub(g);c.projection=d.projection;c.boundingBox=h;c.tightBoundingBox=l;c.boundingSphere=
h.getBoundingSphere(new THREE.Sphere);c.tightBoundingSphere=l.getBoundingSphere(new THREE.Sphere);c.offset=g;'LAS'===d.pointAttributes?c.loader=new Potree.LasLazLoader(d.version):'LAZ'===d.pointAttributes?c.loader=new Potree.LasLazLoader(d.version):(c.loader=new Potree.BinaryLoader(d.version,h,d.scale),c.pointAttributes=new Potree.PointAttributes(c.pointAttributes));g={};h=new Potree.PointCloudOctreeGeometryNode('r',c,h);h.level=0;h.hasChildren=!0;h.spacing=c.spacing;f.upTo('1.5')?h.numPoints=d.hierarchy[0][1]:
h.numPoints=0;c.root=h;c.root.load();g.r=h;if(f.upTo('1.4'))for(f=1;f<d.hierarchy.length;f++){h=d.hierarchy[f][0];l=d.hierarchy[f][1];var k=parseInt(h.charAt(h.length-1)),m=h.substring(0,h.length-1);m=g[m];var p=h.length-1;k=Potree.POCLoader.createChildAABB(m.boundingBox,k);k=new Potree.PointCloudOctreeGeometryNode(h,c,k);k.level=p;k.numPoints=l;k.spacing=c.spacing/Math.pow(2,p);m.addChild(k);g[h]=k}c.nodes=g;b(c)}};e.send(null)}catch(d){console.log("loading failed: '"+a+"'"),console.log(d),b()}};
Potree.POCLoader.loadPointAttributes=function(a){a=a.pointAttributes;for(var b=new Potree.PointAttributes,c=0;c<a.length;c++)b.add(Potree.PointAttribute[a[c]]);return b};Potree.POCLoader.createChildAABB=function(a,b){var c=a.min.clone();a=a.max.clone();var e=(new THREE.Vector3).subVectors(a,c);0<(b&1)?c.z+=e.z/2:a.z-=e.z/2;0<(b&2)?c.y+=e.y/2:a.y-=e.y/2;0<(b&4)?c.x+=e.x/2:a.x-=e.x/2;return new THREE.Box3(c,a)};Potree.PointAttributeNames={};Potree.PointAttributeNames.POSITION_CARTESIAN=0;
Potree.PointAttributeNames.COLOR_PACKED=1;Potree.PointAttributeNames.COLOR_FLOATS_1=2;Potree.PointAttributeNames.COLOR_FLOATS_255=3;Potree.PointAttributeNames.NORMAL_FLOATS=4;Potree.PointAttributeNames.FILLER=5;Potree.PointAttributeNames.INTENSITY=6;Potree.PointAttributeNames.CLASSIFICATION=7;Potree.PointAttributeNames.NORMAL_SPHEREMAPPED=8;Potree.PointAttributeNames.NORMAL_OCT16=9;Potree.PointAttributeNames.NORMAL=10;Potree.PointAttributeNames.RETURN_NUMBER=11;
Potree.PointAttributeNames.NUMBER_OF_RETURNS=12;Potree.PointAttributeNames.SOURCE_ID=13;Potree.PointAttributeNames.INDICES=14;Potree.PointAttributeNames.SPACING=15;
Potree.PointAttributeTypes={DATA_TYPE_DOUBLE:{ordinal:0,size:8},DATA_TYPE_FLOAT:{ordinal:1,size:4},DATA_TYPE_INT8:{ordinal:2,size:1},DATA_TYPE_UINT8:{ordinal:3,size:1},DATA_TYPE_INT16:{ordinal:4,size:2},DATA_TYPE_UINT16:{ordinal:5,size:2},DATA_TYPE_INT32:{ordinal:6,size:4},DATA_TYPE_UINT32:{ordinal:7,size:4},DATA_TYPE_INT64:{ordinal:8,size:8},DATA_TYPE_UINT64:{ordinal:9,size:8}};var i=0,obj;for(obj in Potree.PointAttributeTypes)Potree.PointAttributeTypes[i]=Potree.PointAttributeTypes[obj],i++;
Potree.PointAttribute=function(a,b,c){this.name=a;this.type=b;this.numElements=c;this.byteSize=this.numElements*this.type.size};Potree.PointAttribute.POSITION_CARTESIAN=new Potree.PointAttribute(Potree.PointAttributeNames.POSITION_CARTESIAN,Potree.PointAttributeTypes.DATA_TYPE_FLOAT,3);Potree.PointAttribute.RGBA_PACKED=new Potree.PointAttribute(Potree.PointAttributeNames.COLOR_PACKED,Potree.PointAttributeTypes.DATA_TYPE_INT8,4);Potree.PointAttribute.COLOR_PACKED=Potree.PointAttribute.RGBA_PACKED;
Potree.PointAttribute.RGB_PACKED=new Potree.PointAttribute(Potree.PointAttributeNames.COLOR_PACKED,Potree.PointAttributeTypes.DATA_TYPE_INT8,3);Potree.PointAttribute.NORMAL_FLOATS=new Potree.PointAttribute(Potree.PointAttributeNames.NORMAL_FLOATS,Potree.PointAttributeTypes.DATA_TYPE_FLOAT,3);Potree.PointAttribute.FILLER_1B=new Potree.PointAttribute(Potree.PointAttributeNames.FILLER,Potree.PointAttributeTypes.DATA_TYPE_UINT8,1);
Potree.PointAttribute.INTENSITY=new Potree.PointAttribute(Potree.PointAttributeNames.INTENSITY,Potree.PointAttributeTypes.DATA_TYPE_UINT16,1);Potree.PointAttribute.CLASSIFICATION=new Potree.PointAttribute(Potree.PointAttributeNames.CLASSIFICATION,Potree.PointAttributeTypes.DATA_TYPE_UINT8,1);Potree.PointAttribute.NORMAL_SPHEREMAPPED=new Potree.PointAttribute(Potree.PointAttributeNames.NORMAL_SPHEREMAPPED,Potree.PointAttributeTypes.DATA_TYPE_UINT8,2);
Potree.PointAttribute.NORMAL_OCT16=new Potree.PointAttribute(Potree.PointAttributeNames.NORMAL_OCT16,Potree.PointAttributeTypes.DATA_TYPE_UINT8,2);Potree.PointAttribute.NORMAL=new Potree.PointAttribute(Potree.PointAttributeNames.NORMAL,Potree.PointAttributeTypes.DATA_TYPE_FLOAT,3);Potree.PointAttribute.RETURN_NUMBER=new Potree.PointAttribute(Potree.PointAttributeNames.RETURN_NUMBER,Potree.PointAttributeTypes.DATA_TYPE_UINT8,1);
Potree.PointAttribute.NUMBER_OF_RETURNS=new Potree.PointAttribute(Potree.PointAttributeNames.NUMBER_OF_RETURNS,Potree.PointAttributeTypes.DATA_TYPE_UINT8,1);Potree.PointAttribute.SOURCE_ID=new Potree.PointAttribute(Potree.PointAttributeNames.SOURCE_ID,Potree.PointAttributeTypes.DATA_TYPE_UINT8,1);Potree.PointAttribute.INDICES=new Potree.PointAttribute(Potree.PointAttributeNames.INDICES,Potree.PointAttributeTypes.DATA_TYPE_UINT32,1);
Potree.PointAttribute.SPACING=new Potree.PointAttribute(Potree.PointAttributeNames.SPACING,Potree.PointAttributeTypes.DATA_TYPE_FLOAT,1);Potree.PointAttributes=function(a){this.attributes=[];this.size=this.byteSize=0;if(null!=a)for(var b=0;b<a.length;b++){var c=Potree.PointAttribute[a[b]];this.attributes.push(c);this.byteSize+=c.byteSize;this.size++}};Potree.PointAttributes.prototype.add=function(a){this.attributes.push(a);this.byteSize+=a.byteSize;this.size++};
Potree.PointAttributes.prototype.hasColors=function(){for(var a in this.attributes)if(this.attributes[a].name===Potree.PointAttributeNames.COLOR_PACKED)return!0;return!1};Potree.PointAttributes.prototype.hasNormals=function(){for(var a in this.attributes){var b=this.attributes[a];if(b===Potree.PointAttribute.NORMAL_SPHEREMAPPED||b===Potree.PointAttribute.NORMAL_FLOATS||b===Potree.PointAttribute.NORMAL||b===Potree.PointAttribute.NORMAL_OCT16)return!0}return!1};
var lib$potree$potree_clean$classdecl$var8=function(a,b,c){this.version='string'===typeof a?new Potree.Version(a):a;this.boundingBox=b;this.scale=c};
lib$potree$potree_clean$classdecl$var8.prototype.load=function(a){var b=this;if(!a.loaded){var c=a.getURL();this.version.equalOrHigher('1.4')&&(c+='.bin');var e=Potree.XHRFactory.createXMLHttpRequest();e.open('GET',c,!0);e.responseType='arraybuffer';e.overrideMimeType('text/plain; charset=x-user-defined');e.onreadystatechange=function(){if(4===e.readyState){if(200!==e.status&&0!==e.status||null===e.response)throw Error('Failed to load file! HTTP status: '+e.status+', file: '+c);b.parse(a,e.response)}};
try{e.send(null)}catch(d){console.log('fehler beim laden der punktwolke: '+d)}}};
lib$potree$potree_clean$classdecl$var8.prototype.parse=function(a,b){var c=a.pcoGeometry.pointAttributes,e=b.byteLength/a.pcoGeometry.pointAttributes.byteSize;this.version.upTo('1.5')&&(a.numPoints=e);var d=Potree.scriptPath+'/workers/BinaryDecoderWorker.js',f=Potree.workerPool.getWorker(d);f.onmessage=function(b){var e=b.data,g=e.attributeBuffers,k=new THREE.Box3((new THREE.Vector3).fromArray(e.tightBoundingBox.min),(new THREE.Vector3).fromArray(e.tightBoundingBox.max));Potree.workerPool.returnWorker(d,
f);var m=new THREE.BufferGeometry,p;for(p in g){var n=g[p].buffer;parseInt(p)===Potree.PointAttributeNames.POSITION_CARTESIAN?m.addAttribute('position',new THREE.BufferAttribute(new Float32Array(n),3)):parseInt(p)===Potree.PointAttributeNames.COLOR_PACKED?m.addAttribute('color',new THREE.BufferAttribute(new Uint8Array(n),4,!0)):parseInt(p)===Potree.PointAttributeNames.INTENSITY?m.addAttribute('intensity',new THREE.BufferAttribute(new Float32Array(n),1)):parseInt(p)===Potree.PointAttributeNames.CLASSIFICATION?
m.addAttribute('classification',new THREE.BufferAttribute(new Uint8Array(n),1)):parseInt(p)===Potree.PointAttributeNames.NORMAL_SPHEREMAPPED?m.addAttribute('normal',new THREE.BufferAttribute(new Float32Array(n),3)):parseInt(p)===Potree.PointAttributeNames.NORMAL_OCT16?m.addAttribute('normal',new THREE.BufferAttribute(new Float32Array(n),3)):parseInt(p)===Potree.PointAttributeNames.NORMAL?m.addAttribute('normal',new THREE.BufferAttribute(new Float32Array(n),3)):parseInt(p)===Potree.PointAttributeNames.INDICES?
(n=new THREE.BufferAttribute(new Uint8Array(n),4),n.normalized=!0,m.addAttribute('indices',n)):parseInt(p)===Potree.PointAttributeNames.SPACING&&(n=new THREE.BufferAttribute(new Float32Array(n),1),m.addAttribute('spacing',n))}k.max.sub(k.min);k.min.set(0,0,0);a.numPoints=b.data.buffer.byteLength/c.byteSize;a.geometry=m;a.mean=new (Function.prototype.bind.apply(THREE.Vector3,[null].concat($jscomp.arrayFromIterable(e.mean))));a.tightBoundingBox=k;a.loaded=!0;a.loading=!1;a.estimatedSpacing=e.estimatedSpacing;
Potree.numNodesLoading--};b={buffer:b,pointAttributes:c,version:this.version.version,min:[a.boundingBox.min.x,a.boundingBox.min.y,a.boundingBox.min.z],offset:[a.pcoGeometry.offset.x,a.pcoGeometry.offset.y,a.pcoGeometry.offset.z],scale:this.scale,spacing:a.spacing,hasChildren:a.hasChildren,name:a.name};f.postMessage(b,[b.buffer])};Potree.BinaryLoader=lib$potree$potree_clean$classdecl$var8;
Potree.GreyhoundBinaryLoader=function(a,b,c){this.version='string'===typeof a?new Potree.Version(a):a;this.boundingBox=b;this.scale=c};
Potree.GreyhoundBinaryLoader.prototype.load=function(a){if(!a.loaded){var b=this,c=a.getURL(),e=Potree.XHRFactory.createXMLHttpRequest();e.open('GET',c,!0);e.responseType='arraybuffer';e.overrideMimeType('text/plain; charset=x-user-defined');e.onreadystatechange=function(){4===e.readyState&&(200===e.status||0===e.status?b.parse(a,e.response):console.log('Failed to load file! HTTP status:',e.status,'file:',c))};try{e.send(null)}catch(d){console.log('error loading point cloud: '+d)}}};
Potree.GreyhoundBinaryLoader.prototype.parse=function(a,b){var c=(new DataView(b,b.byteLength-4,4)).getUint32(0,!0),e=a.pcoGeometry.pointAttributes;a.numPoints=c;var d=Potree.scriptPath+'/workers/GreyhoundBinaryDecoderWorker.js',f=Potree.workerPool.getWorker(d);f.onmessage=function(b){b=b.data;var c=b.attributeBuffers,e=new THREE.Box3((new THREE.Vector3).fromArray(b.tightBoundingBox.min),(new THREE.Vector3).fromArray(b.tightBoundingBox.max));Potree.workerPool.returnWorker(d,f);var g=new THREE.BufferGeometry,
h;for(h in c){var n=c[h].buffer;parseInt(h)===Potree.PointAttributeNames.POSITION_CARTESIAN?g.addAttribute('position',new THREE.BufferAttribute(new Float32Array(n),3)):parseInt(h)===Potree.PointAttributeNames.COLOR_PACKED?g.addAttribute('color',new THREE.BufferAttribute(new Uint8Array(n),4,!0)):parseInt(h)===Potree.PointAttributeNames.INTENSITY?g.addAttribute('intensity',new THREE.BufferAttribute(new Float32Array(n),1)):parseInt(h)===Potree.PointAttributeNames.CLASSIFICATION?g.addAttribute('classification',
new THREE.BufferAttribute(new Uint8Array(n),1)):parseInt(h)===Potree.PointAttributeNames.NORMAL_SPHEREMAPPED?g.addAttribute('normal',new THREE.BufferAttribute(new Float32Array(n),3)):parseInt(h)===Potree.PointAttributeNames.NORMAL_OCT16?g.addAttribute('normal',new THREE.BufferAttribute(new Float32Array(n),3)):parseInt(h)===Potree.PointAttributeNames.NORMAL?g.addAttribute('normal',new THREE.BufferAttribute(new Float32Array(n),3)):parseInt(h)===Potree.PointAttributeNames.INDICES?(n=new THREE.BufferAttribute(new Uint8Array(n),
4),n.normalized=!0,g.addAttribute('indices',n)):parseInt(h)===Potree.PointAttributeNames.SPACING&&(n=new THREE.BufferAttribute(new Float32Array(n),1),g.addAttribute('spacing',n))}e.max.sub(e.min);e.min.set(0,0,0);a.numPoints=b.numPoints;a.geometry=g;a.mean=new (Function.prototype.bind.apply(THREE.Vector3,[null].concat($jscomp.arrayFromIterable(b.mean))));a.tightBoundingBox=e;a.loaded=!0;a.loading=!1;Potree.numNodesLoading--};c=a.boundingBox;var g=a.pcoGeometry.boundingBox.getCenter().sub(a.boundingBox.min);
b={buffer:b,pointAttributes:e,version:this.version.version,schema:a.pcoGeometry.schema,min:[c.min.x,c.min.y,c.min.z],max:[c.max.x,c.max.y,c.max.z],offset:g.toArray(),scale:this.scale,normalize:a.pcoGeometry.normalize};f.postMessage(b,[b.buffer])};var GreyhoundUtils=function(){};GreyhoundUtils.getQueryParam=function(a){a=a.replace(/[[\]]/g,'\\$&');return(a=(new RegExp('[?&]'+a+'(=([^&#]*)|&|#|$)')).exec(window.location.href))?a[2]?decodeURIComponent(a[2].replace(/\+/g,' ')):'':null};
GreyhoundUtils.createSchema=function(a){var b=[{name:'X',size:4,type:'signed'},{name:'Y',size:4,type:'signed'},{name:'Z',size:4,type:'signed'}];a.forEach(function(a){'COLOR_PACKED'===a?(b.push({name:'Red',size:2,type:'unsigned'}),b.push({name:'Green',size:2,type:'unsigned'}),b.push({name:'Blue',size:2,type:'unsigned'})):'INTENSITY'===a?b.push({name:'Intensity',size:2,type:'unsigned'}):'CLASSIFICATION'===a&&b.push({name:'Classification',size:1,type:'unsigned'})});return b};
GreyhoundUtils.fetch=function(a,b){var c=Potree.XHRFactory.createXMLHttpRequest();c.open('GET',a,!0);c.onreadystatechange=function(){4===c.readyState&&(200===c.status||0===c.status?b(null,c.responseText):b(c.responseText))};c.send(null)};GreyhoundUtils.fetchBinary=function(a,b){var c=Potree.XHRFactory.createXMLHttpRequest();c.open('GET',a,!0);c.responseType='arraybuffer';c.onreadystatechange=function(){4===c.readyState&&(200===c.status||0===c.status?b(null,c.response):b(c.responseText))};c.send(null)};
GreyhoundUtils.pointSizeFrom=function(a){return a.reduce(function(a,c){return a+c.size},0)};
GreyhoundUtils.getNormalization=function(a,b,c){var e=[{name:'X',size:4,type:'floating'},{name:'Y',size:4,type:'floating'},{name:'Z',size:4,type:'floating'},{name:'Red',size:2,type:'unsigned'},{name:'Green',size:2,type:'unsigned'},{name:'Blue',size:2,type:'unsigned'},{name:'Intensity',size:2,type:'unsigned'}];a=a+'read?depth='+b+'&schema='+JSON.stringify(e);GreyhoundUtils.fetchBinary(a,function(a,b){if(a)throw Error(a);a=new DataView(b);b=b.byteLength-4;for(var d=GreyhoundUtils.pointSizeFrom(e),f=
!1,l=!1,k=0;k<b;k+=d){if(255<a.getUint16(k+12,!0)||255<a.getUint16(k+14,!0)||255<a.getUint16(k+16,!0))f=!0;255<a.getUint16(k+18,!0)&&(l=!0);if(f&&l)break}f&&console.log('Normalizing color');l&&console.log('Normalizing intensity');c(null,{color:f,intensity:l})})};Potree.GreyhoundLoader=function(){};Potree.GreyhoundLoader.loadInfoJSON=function(a,b){};
Potree.GreyhoundLoader.load=function(a,b){try{var c=a.split('greyhound://')[1];1===c.split('http://').length&&1===c.split('https://').length&&(c='http://'+c);GreyhoundUtils.fetch(c+'info',function(a,d){if(a)throw Error(a);a=JSON.parse(d);var e=new Potree.Version('1.4'),g=a.bounds;d=a.scale||.01;Array.isArray(d)&&(d=Math.min(d[0],d[1],d[2]));GreyhoundUtils.getQueryParam('scale')&&(d=parseFloat(GreyhoundUtils.getQueryParam('scale')));var h=Math.max(8,a.baseDepth),l=['POSITION_CARTESIAN'],k=!1,m=!1,
p=!1;a.schema.forEach(function(a){'Intensity'===a.name&&l.push('INTENSITY');'Classification'===a.name&&l.push('CLASSIFICATION');'Red'===a.name?k=!0:'Green'===a.name?m=!0:'Blue'===a.name&&(p=!0)});k&&m&&p&&l.push('COLOR_PACKED');var n=new Potree.PointCloudGreyhoundGeometry;n.serverURL=c;n.spacing=(g[3]-g[0])/Math.pow(2,h);n.baseDepth=h;n.hierarchyStepSize=5;n.schema=GreyhoundUtils.createSchema(l);h=GreyhoundUtils.pointSizeFrom(n.schema);n.pointAttributes=new Potree.PointAttributes(l);n.pointAttributes.byteSize=
h;g=new THREE.Box3((new THREE.Vector3).fromArray(g,0),(new THREE.Vector3).fromArray(g,3));h=g.min.clone();g.max.sub(g.min);g.min.set(0,0,0);n.projection=a.srs;n.boundingBox=g;n.boundingSphere=g.getBoundingSphere(new THREE.Sphere);n.scale=d;n.offset=h;console.log('Scale:',d);console.log('Offset:',h);console.log('Bounds:',g);n.loader=new Potree.GreyhoundBinaryLoader(e,g,n.scale);e={};d=new Potree.PointCloudGreyhoundGeometryNode('r',n,g,d,h);d.level=0;d.hasChildren=!0;d.numPoints=a.numPoints;d.spacing=
n.spacing;n.root=d;n.root.load();e.r=d;n.nodes=e;GreyhoundUtils.getNormalization(c,a.baseDepth,function(a,c){c.color&&(n.normalize.color=!0);c.intensity&&(n.normalize.intensity=!0);b(n)})})}catch(e){console.log("loading failed: '"+a+"'"),console.log(e),b()}};Potree.GreyhoundLoader.loadPointAttributes=function(a){a=a.pointAttributes;for(var b=new Potree.PointAttributes,c=0;c<a.length;c++)b.add(Potree.PointAttribute[a[c]]);return b};
Potree.GreyhoundLoader.createChildAABB=function(a,b){var c=a.min;a=a.max;var e=(new THREE.Vector3).copy(a).sub(c).multiplyScalar(.5),d=new THREE.Vector3(e.x,0,0),f=new THREE.Vector3(0,e.y,0),g=new THREE.Vector3(0,0,e.z),h=c,l=(new THREE.Vector3).add(c).add(e);1===b?(c=(new THREE.Vector3).copy(h).add(g),a=(new THREE.Vector3).copy(l).add(g)):3===b?(c=(new THREE.Vector3).copy(h).add(g).add(f),a=(new THREE.Vector3).copy(l).add(g).add(f)):0===b?(c=h,a=l):2===b?(c=(new THREE.Vector3).copy(h).add(f),a=(new THREE.Vector3).copy(l).add(f)):
5===b?(c=(new THREE.Vector3).copy(h).add(g).add(d),a=(new THREE.Vector3).copy(l).add(g).add(d)):7===b?(c=(new THREE.Vector3).copy(h).add(e),a=(new THREE.Vector3).copy(l).add(e)):4===b?(c=(new THREE.Vector3).copy(h).add(d),a=(new THREE.Vector3).copy(l).add(d)):6===b&&(c=(new THREE.Vector3).copy(h).add(d).add(f),a=(new THREE.Vector3).copy(l).add(d).add(f));return new THREE.Box3(c,a)};var lib$potree$potree_clean$classdecl$var9=function(a){this.version='string'===typeof a?new Potree.Version(a):a};
lib$potree$potree_clean$classdecl$var9.progressCB=function(){};
lib$potree$potree_clean$classdecl$var9.prototype.load=function(a){var b=this;if(!a.loaded){var c=a.pcoGeometry.pointAttributes,e=a.getURL();this.version.equalOrHigher('1.4')&&(e+='.'+c.toLowerCase());var d=Potree.XHRFactory.createXMLHttpRequest();d.open('GET',e,!0);d.responseType='arraybuffer';d.overrideMimeType('text/plain; charset=x-user-defined');d.onreadystatechange=function(){4===d.readyState&&(200===d.status?b.parse(a,d.response):console.log('Failed to load file! HTTP status: '+d.status+', file: '+
e))};d.send(null)}};
lib$potree$potree_clean$classdecl$var9.prototype.parse=function(a,b){var c=new LASFile(b),e=new Potree.LasLazBatcher(a);c.open().then(function(a){c.isOpen=!0;return c}).catch(function(a){console.log('failed to open file. :(')}).then(function(a){return a.getHeader().then(function(b){return[a,b]})}).then(function(a){var b=a[0],c=a[1],d=0,l=c.pointsCount,k=function(){return b.readData(1E6,0,1).then(function(a){e.push(new LASDecoder(a.buffer,c.pointsFormatId,c.pointsStructSize,a.count,c.scale,c.offset,
c.mins,c.maxs));d+=a.count;Potree.LasLazLoader.progressCB(d/l);if(a.hasMoreData)return k();c.totalRead=d;c.versionAsString=b.versionAsString;c.isCompressed=b.isCompressed;return[b,c,e]})};return k()}).then(function(a){var b=a[0];Potree.LasLazLoader.progressCB(1);return b.close().then(function(){b.isOpen=!1;return a.slice(1)}).catch(function(a){if(b.isOpen)return b.close().then(function(){b.isOpen=!1;throw a;});throw a;})})};lib$potree$potree_clean$classdecl$var9.prototype.handle=function(a,b){};
Potree.LasLazLoader=lib$potree$potree_clean$classdecl$var9;var lib$potree$potree_clean$classdecl$var10=function(a){this.node=a};
lib$potree$potree_clean$classdecl$var10.prototype.push=function(a){var b=this,c=Potree.scriptPath+'/workers/LASDecoderWorker.js',e=Potree.workerPool.getWorker(c);e.onmessage=function(d){var f=new THREE.BufferGeometry,h=a.pointsCount,l=new Float32Array(d.data.position),k=new Uint8Array(d.data.color),m=new Float32Array(d.data.intensity),p=new Uint8Array(d.data.classification),n=new Uint8Array(d.data.returnNumber),r=new Uint8Array(d.data.numberOfReturns),t=new Uint16Array(d.data.pointSourceID),q=new Uint8Array(d.data.indices);
f.addAttribute('position',new THREE.BufferAttribute(l,3));f.addAttribute('color',new THREE.BufferAttribute(k,4,!0));f.addAttribute('intensity',new THREE.BufferAttribute(m,1));f.addAttribute('classification',new THREE.BufferAttribute(p,1));f.addAttribute('returnNumber',new THREE.BufferAttribute(n,1));f.addAttribute('numberOfReturns',new THREE.BufferAttribute(r,1));f.addAttribute('pointSourceID',new THREE.BufferAttribute(t,1));f.addAttribute('indices',new THREE.BufferAttribute(q,4));f.attributes.indices.normalized=
!0;l=new THREE.Box3((new THREE.Vector3).fromArray(d.data.tightBoundingBox.min),(new THREE.Vector3).fromArray(d.data.tightBoundingBox.max));f.boundingBox=b.node.boundingBox;b.node.tightBoundingBox=l;b.node.geometry=f;b.node.numPoints=h;b.node.loaded=!0;b.node.loading=!1;Potree.numNodesLoading--;b.node.mean=new (Function.prototype.bind.apply(THREE.Vector3,[null].concat($jscomp.arrayFromIterable(d.data.mean))));Potree.workerPool.returnWorker(c,e)};var d={buffer:a.arrayb,numPoints:a.pointsCount,pointSize:a.pointSize,
pointFormatID:2,scale:a.scale,offset:a.offset,mins:a.mins,maxs:a.maxs};e.postMessage(d,[d.buffer])};Potree.LasLazBatcher=lib$potree$potree_clean$classdecl$var10;
Potree.Gradients={RAINBOW:[[0,new THREE.Color(.278,0,.714)],[1/6,new THREE.Color(0,0,1)],[2/6,new THREE.Color(0,1,1)],[.5,new THREE.Color(0,1,0)],[4/6,new THREE.Color(1,1,0)],[5/6,new THREE.Color(1,.64,0)],[1,new THREE.Color(1,0,0)]],SPECTRAL:[[0,new THREE.Color(.3686,.3098,.6353)],[.1,new THREE.Color(.1961,.5333,.7412)],[.2,new THREE.Color(.4,.7608,.6471)],[.3,new THREE.Color(.6706,.8667,.6431)],[.4,new THREE.Color(.902,.9608,.5961)],[.5,new THREE.Color(1,1,.749)],[.6,new THREE.Color(.9961,.8784,
.5451)],[.7,new THREE.Color(.9922,.6824,.3804)],[.8,new THREE.Color(.9569,.4275,.2627)],[.9,new THREE.Color(.8353,.2431,.3098)],[1,new THREE.Color(.6196,.0039,.2588)]],PLASMA:[[0,new THREE.Color(.241,.015,.61)],[.1,new THREE.Color(.387,.001,.654)],[.2,new THREE.Color(.524,.025,.653)],[.3,new THREE.Color(.651,.125,.596)],[.4,new THREE.Color(.752,.227,.513)],[.5,new THREE.Color(.837,.329,.431)],[.6,new THREE.Color(.907,.435,.353)],[.7,new THREE.Color(.963,.554,.272)],[.8,new THREE.Color(.992,.681,.195)],
[.9,new THREE.Color(.987,.822,.144)],[1,new THREE.Color(.94,.975,.131)]],YELLOW_GREEN:[[0,new THREE.Color(.1647,.2824,.3451)],[.1,new THREE.Color(.1338,.3555,.4227)],[.2,new THREE.Color(.061,.4319,.4864)],[.3,new THREE.Color(0,.5099,.5319)],[.4,new THREE.Color(0,.5881,.5569)],[.5,new THREE.Color(.137,.665,.5614)],[.6,new THREE.Color(.2906,.7395,.5477)],[.7,new THREE.Color(.4453,.8099,.5201)],[.8,new THREE.Color(.6102,.8748,.485)],[.9,new THREE.Color(.7883,.9323,.4514)],[1,new THREE.Color(.9804,.9804,
.4314)]],VIRIDIS:[[0,new THREE.Color(.267,.005,.329)],[.1,new THREE.Color(.283,.141,.458)],[.2,new THREE.Color(.254,.265,.53)],[.3,new THREE.Color(.207,.372,.553)],[.4,new THREE.Color(.164,.471,.558)],[.5,new THREE.Color(.128,.567,.551)],[.6,new THREE.Color(.135,.659,.518)],[.7,new THREE.Color(.267,.749,.441)],[.8,new THREE.Color(.478,.821,.318)],[.9,new THREE.Color(.741,.873,.15)],[1,new THREE.Color(.993,.906,.144)]],INFERNO:[[0,new THREE.Color(.077,.042,.206)],[.1,new THREE.Color(.225,.036,.388)],
[.2,new THREE.Color(.373,.074,.432)],[.3,new THREE.Color(.522,.128,.42)],[.4,new THREE.Color(.665,.182,.37)],[.5,new THREE.Color(.797,.255,.287)],[.6,new THREE.Color(.902,.364,.184)],[.7,new THREE.Color(.969,.516,.063)],[.8,new THREE.Color(.988,.683,.072)],[.9,new THREE.Color(.961,.859,.298)],[1,new THREE.Color(.988,.998,.645)]],GRAYSCALE:[[0,new THREE.Color(0,0,0)],[1,new THREE.Color(1,1,1)]]};
Potree.Classification={DEFAULT:{0:new THREE.Vector4(.5,.5,.5,1),1:new THREE.Vector4(.5,.5,.5,1),2:new THREE.Vector4(.63,.32,.18,1),3:new THREE.Vector4(0,1,0,1),4:new THREE.Vector4(0,.8,0,1),5:new THREE.Vector4(0,.6,0,1),6:new THREE.Vector4(1,.66,0,1),7:new THREE.Vector4(1,0,1,1),8:new THREE.Vector4(1,0,0,1),9:new THREE.Vector4(0,0,1,1),12:new THREE.Vector4(1,1,0,1),DEFAULT:new THREE.Vector4(.3,.6,.6,.5)}};Potree.PointSizeType={FIXED:0,ATTENUATED:1,ADAPTIVE:2};
Potree.PointShape={SQUARE:0,CIRCLE:1,PARABOLOID:2};Potree.PointColorType={RGB:0,COLOR:1,DEPTH:2,HEIGHT:3,ELEVATION:3,INTENSITY:4,INTENSITY_GRADIENT:5,LOD:6,LEVEL_OF_DETAIL:6,POINT_INDEX:7,CLASSIFICATION:8,RETURN_NUMBER:9,SOURCE:10,NORMAL:11,PHONG:12,RGB_HEIGHT:13,COMPOSITE:50};Potree.TreeType={OCTREE:0,KDTREE:1};function LRUItem(a){this.next=this.previous=null;this.node=a}function LRU(){this.last=this.first=null;this.items={};this.numPoints=this.elements=0}LRU.prototype.size=function(){return this.elements};
LRU.prototype.contains=function(a){return null==this.items[a.id]};
LRU.prototype.touch=function(a){if(a.loaded)if(null==this.items[a.id]){var b=new LRUItem(a);b.previous=this.last;this.last=b;null!==b.previous&&(b.previous.next=b);this.items[a.id]=b;this.elements++;null===this.first&&(this.first=b);this.numPoints+=a.numPoints}else b=this.items[a.id],null===b.previous?null!==b.next&&(this.first=b.next,this.first.previous=null,b.previous=this.last,b.next=null,this.last=b,b.previous.next=b):null!==b.next&&(b.previous.next=b.next,b.next.previous=b.previous,b.previous=
this.last,b.next=null,this.last=b,b.previous.next=b)};LRU.prototype.remove=function(a){var b=this.items[a.id];b&&(1===this.elements?this.last=this.first=null:(b.previous||(this.first=b.next,this.first.previous=null),b.next||(this.last=b.previous,this.last.next=null),b.previous&&b.next&&(b.previous.next=b.next,b.next.previous=b.previous)),delete this.items[a.id],this.elements--,this.numPoints-=a.numPoints)};LRU.prototype.getLRUItem=function(){return null===this.first?null:this.first.node};
LRU.prototype.toString=function(){for(var a='{ ',b=this.first;null!==b;)a+=b.node.id,null!==b.next&&(a+=', '),b=b.next;return a=a+'}'+('('+this.size()+')')};LRU.prototype.freeMemory=function(){if(!(1>=this.elements))for(;this.numPoints>Potree.pointLoadLimit;)this.disposeDescendants(this.first.node)};LRU.prototype.disposeDescendants=function(a){var b=[];for(b.push(a);0<b.length;){a=b.pop();a.dispose();this.remove(a);for(var c in a.children)a.children.hasOwnProperty(c)&&a.children[c].loaded&&b.push(a.children[c])}};
var lib$potree$potree_clean$classdecl$var11=function(){Potree.PointCloudTreeNode.call(this);this.children={};this.octree=this.sceneNode=null};$jscomp.inherits(lib$potree$potree_clean$classdecl$var11,Potree.PointCloudTreeNode);lib$potree$potree_clean$classdecl$var11.prototype.getNumPoints=function(){return this.geometryNode.numPoints};lib$potree$potree_clean$classdecl$var11.prototype.isLoaded=function(){return!0};lib$potree$potree_clean$classdecl$var11.prototype.isTreeNode=function(){return!0};
lib$potree$potree_clean$classdecl$var11.prototype.isGeometryNode=function(){return!1};lib$potree$potree_clean$classdecl$var11.prototype.getLevel=function(){return this.geometryNode.level};lib$potree$potree_clean$classdecl$var11.prototype.getBoundingSphere=function(){return this.geometryNode.boundingSphere};lib$potree$potree_clean$classdecl$var11.prototype.getBoundingBox=function(){return this.geometryNode.boundingBox};
lib$potree$potree_clean$classdecl$var11.prototype.getChildren=function(){for(var a=[],b=0;8>b;b++)this.children[b]&&a.push(this.children[b]);return a};
lib$potree$potree_clean$classdecl$var11.prototype.getPointsInBox=function(a){if(!this.sceneNode)return null;var b=this.geometryNode.buffer,c=b.offset('position'),e=b.stride,d=new DataView(b.data);a=(new THREE.Matrix4).getInverse(a.matrixWorld);a=(new THREE.Matrix4).multiplyMatrices(a,this.sceneNode.matrixWorld);for(var f=[],g=new THREE.Vector4,h=0;h<b.numElements;h++){var l=d.getFloat32(h*e+c+0,!0),k=d.getFloat32(h*e+c+4,!0),m=d.getFloat32(h*e+c+8,!0);g.set(l,k,m,1);g.applyMatrix4(a);-.5<g.x&&.5>
g.x&&-.5<g.y&&.5>g.y&&-.5<g.z&&.5>g.z&&(g.set(l,k,m,1).applyMatrix4(this.sceneNode.matrixWorld),f.push(new THREE.Vector3(g.x,g.y,g.z)))}return f};$jscomp.global.Object.defineProperties(lib$potree$potree_clean$classdecl$var11.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this.geometryNode.name}}});Potree.PointCloudOctreeNode=lib$potree$potree_clean$classdecl$var11;
Potree.PointCloudOctree=function(a,b){var c=Potree.PointCloudTree.call(this)||this;c.pointBudget=Infinity;c.pcoGeometry=a;c.boundingBox=c.pcoGeometry.boundingBox;c.boundingSphere=c.boundingBox.getBoundingSphere(new THREE.Sphere);c.material=b||new Potree.PointCloudMaterial;c.visiblePointsTarget=2E6;c.minimumNodePixelSize=150;c.level=0;c.position.copy(a.offset);c.updateMatrix();c.showBoundingBox=!1;c.boundingBoxNodes=[];c.loadQueue=[];c.visibleBounds=new THREE.Box3;c.visibleNodes=[];c.visibleGeometry=
[];c.generateDEM=!1;c.profileRequests=[];c.name='';b=[c.pcoGeometry.tightBoundingBox,c.getBoundingBoxWorld()].find(function(a){return void 0!==a});c.updateMatrixWorld(!0);b=Potree.utils.computeTransformedBoundingBox(b,c.matrixWorld);var e=b.max.z;c.material.heightMin=b.min.z;c.material.heightMax=e;c.projection=a.projection;c.root=c.pcoGeometry.root;return c};$jscomp.inherits(Potree.PointCloudOctree,Potree.PointCloudTree);
Potree.PointCloudOctree.prototype.setName=function(a){this.name!==a&&(this.name=a,this.dispatchEvent({type:'name_changed',name:a,pointcloud:this}))};Potree.PointCloudOctree.prototype.getName=function(){return this.name};
Potree.PointCloudOctree.prototype.toTreeNode=function(a,b){var c=this,e=new Potree.PointCloudOctreeNode,d=new THREE.Points(a.geometry,this.material);d.name=a.name;d.position.copy(a.boundingBox.min);d.frustumCulled=!1;d.onBeforeRender=function(b,d,f,k,m,p){m.program&&(b.getContext().useProgram(m.program.program),m.program.getUniforms().map.level&&(d=a.getLevel(),m.uniforms.level.value=d,m.program.getUniforms().map.level.setValue(b.getContext(),d)),c.visibleNodeTextureOffsets&&m.program.getUniforms().map.vnStart&&
(d=c.visibleNodeTextureOffsets.get(e),m.uniforms.vnStart.value=d,m.program.getUniforms().map.vnStart.setValue(b.getContext(),d)),m.program.getUniforms().map.pcIndex&&(d=e.pcIndex?e.pcIndex:c.visibleNodes.indexOf(e),m.uniforms.pcIndex.value=d,m.program.getUniforms().map.pcIndex.setValue(b.getContext(),d)))};e.geometryNode=a;e.sceneNode=d;e.pointcloud=this;e.children={};for(var f in a.children)e.children[f]=a.children[f];b?(f=parseInt(a.name[a.name.length-1]),b.sceneNode.add(d),b.children[f]=e):(this.root=
e,this.add(d));a.oneTimeDisposeHandlers.push(function(){var c=parseInt(a.name[a.name.length-1]);b.sceneNode.remove(e.sceneNode);b.children[c]=a});return e};
Potree.PointCloudOctree.prototype.updateVisibleBounds=function(){for(var a=[],b=0;b<this.visibleNodes.length;b++){for(var c=this.visibleNodes[b],e=!0,d=0;d<c.children.length;d++){var f=c.children[d];f instanceof Potree.PointCloudOctreeNode?e=e&&!f.sceneNode.visible:f instanceof Potree.PointCloudOctreeGeometryNode&&(e=!0)}e&&a.push(c)}this.visibleBounds.min=new THREE.Vector3(Infinity,Infinity,Infinity);this.visibleBounds.max=new THREE.Vector3(-Infinity,-Infinity,-Infinity);for(b=0;b<a.length;b++)c=
a[b],this.visibleBounds.expandByPoint(c.getBoundingBox().min),this.visibleBounds.expandByPoint(c.getBoundingBox().max)};Potree.PointCloudOctree.prototype.updateMaterial=function(a,b,c,e){a.fov=Math.PI/180*c.fov;a.screenWidth=e.domElement.clientWidth;a.screenHeight=e.domElement.clientHeight;a.spacing=this.pcoGeometry.spacing*Math.max(this.scale.x,this.scale.y,this.scale.z);a.near=c.near;a.far=c.far;a.uniforms.octreeSize.value=this.pcoGeometry.boundingBox.getSize(new THREE.Vector3).x};
Potree.PointCloudOctree.prototype.computeVisibilityTextureData=function(a,b){Potree.measureTimings&&performance.mark('computeVisibilityTextureData-start');var c=new Uint8Array(4*a.length),e=new Map;a=a.slice();a.sort(function(a,b){a=a.geometryNode.name;b=b.geometryNode.name;return a.length!==b.length?a.length-b.length:a<b?-1:a>b?1:0});for(var d=new THREE.Vector3,f=function(a,b){d.subVectors(b.center,a.origin);a=d.dot(a.direction);var c=d.dot(d)-a*a;b=b.radius*b.radius;if(c>b)return null;b=a+Math.sqrt(b-
c);return 0>b?null:b},g=new Map,h=new Map,l=0;l<a.length;l++){var k=a[l];e.set(k,l);for(var m=[],p=0;8>p;p++){var n=k.children[p];n&&n.constructor===Potree.PointCloudOctreeNode&&a.includes(n,l)&&m.push(n)}c[4*l]=0;c[4*l+1]=0;c[4*l+2]=0;c[4*l+3]=k.getLevel();for(p=0;p<m.length;p++){n=m[p];var r=parseInt(n.geometryNode.name.substr(-1));c[4*l]+=Math.pow(2,r);0===p&&(n=a.indexOf(n,l),c[4*l+1]=n-l>>8,c[4*l+2]=(n-l)%256)}p=k.getBoundingBox().clone().getBoundingSphere(new THREE.Sphere);p.applyMatrix4(k.sceneNode.matrixWorld);
p.applyMatrix4(b.matrixWorldInverse);m=new THREE.Ray(b.position,b.getWorldDirection(Potree.tempVector3));m=f(m,p);p=p.center.distanceTo(b.position)+p.radius;null===m&&(m=p);m=Math.max(m,p);g.has(k.getLevel())?(p=g.get(k.getLevel()),p=Math.max(p,m),g.set(k.getLevel(),p)):g.set(k.getLevel(),m);k.geometryNode.hasChildren||h.set(k,{distance:m,i:l})}a=$jscomp.makeIterator(h);for(b=a.next();!b.done;b=a.next())if(f=$jscomp.makeIterator(b.value),b=f.next().value,f=f.next().value,h=b.getLevel(),b=f.distance,
f=f.i,!(4>h))for(h=$jscomp.makeIterator(g),l=h.next();!l.done;l=h.next())k=$jscomp.makeIterator(l.value),l=k.next().value,k=k.next().value,b<1.2*k&&(c[4*f+3]=l);Potree.measureTimings&&(performance.mark('computeVisibilityTextureData-end'),performance.measure('render.computeVisibilityTextureData','computeVisibilityTextureData-start','computeVisibilityTextureData-end'));return{data:c,offsets:e}};
Potree.PointCloudOctree.prototype.nodeIntersectsProfile=function(a,b){a=a.boundingBox.clone().applyMatrix4(this.matrixWorld).getBoundingSphere(new THREE.Sphere);for(var c=!1,e=0;e<b.points.length-1;e++){var d=new THREE.Vector3(b.points[e+0].x,b.points[e+0].y,a.center.z),f=new THREE.Vector3(b.points[e+1].x,b.points[e+1].y,a.center.z);d=(new THREE.Line3(d,f)).closestPointToPoint(a.center,!0).distanceTo(a.center);c=c||d<a.radius+b.width}return c};
Potree.PointCloudOctree.prototype.nodesOnRay=function(a,b){var c=[];b=b.clone();for(var e=0;e<a.length;e++){var d=a[e],f=d.getBoundingSphere(new THREE.Sphere).clone().applyMatrix4(this.matrixWorld);b.intersectsSphere(f)&&c.push(d)}return c};
Potree.PointCloudOctree.prototype.updateMatrixWorld=function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1};
Potree.PointCloudOctree.prototype.hideDescendants=function(a){for(var b=[],c=0;c<a.children.length;c++){var e=a.children[c];e.visible&&b.push(e)}for(;0<b.length;)for(a=b.shift(),a.visible=!1,c=0;c<a.children.length;c++)e=a.children[c],e.visible&&b.push(e)};Potree.PointCloudOctree.prototype.moveToOrigin=function(){this.position.set(0,0,0);this.updateMatrixWorld(!0);var a=Potree.utils.computeTransformedBoundingBox(this.boundingBox,this.matrixWorld);this.position.set(0,0,0).sub(a.getCenter())};
Potree.PointCloudOctree.prototype.moveToGroundPlane=function(){this.updateMatrixWorld(!0);var a=Potree.utils.computeTransformedBoundingBox(this.boundingBox,this.matrixWorld);this.position.y+=-a.min.y};Potree.PointCloudOctree.prototype.getBoundingBoxWorld=function(){this.updateMatrixWorld(!0);return Potree.utils.computeTransformedBoundingBox(this.boundingBox,this.matrixWorld)};
Potree.PointCloudOctree.prototype.getPointsInProfile=function(a,b,c){if(c)return c=new Potree.ProfileRequest(this,a,b,c),this.profileRequests.push(c),c;c={segments:[],boundingBox:new THREE.Box3,projectedBoundingBox:new THREE.Box2};for(var e=0;e<a.points.length-1;e++){var d=a.points[e],f=a.points[e+1],g=this.getProfile(d,f,a.width,b);c.segments.push({start:d,end:f,points:g,project:null});c.boundingBox.expandByPoint(g.boundingBox.min);c.boundingBox.expandByPoint(g.boundingBox.max)}a=new THREE.Vector3;
for(b=0;b<c.segments.length;b++)e=c.segments[b],d=e.start,f=e.end,g=function(a,b,c,d){var e=new THREE.Vector3(1,0,0);b=(new THREE.Vector3).subVectors(b,a);b.y=0;b.normalize();var f=Math.acos(e.dot(b));0<b.z&&(f=-f);return function(b){var e=(new THREE.Matrix4).makeTranslation(-a.x,-d.min.y,-a.z),g=(new THREE.Matrix4).makeRotationY(-f),h=(new THREE.Matrix4).makeTranslation(c.x,0,0);b=b.clone();b.applyMatrix4(e);b.applyMatrix4(g);b.applyMatrix4(h);return b}}(d,f,a.clone(),c.boundingBox.clone()),e.project=
g,a.x+=(new THREE.Vector3(d.x,0,d.z)).distanceTo(new THREE.Vector3(f.x,0,f.z)),a.y+=f.y-d.y;c.projectedBoundingBox.min.x=0;c.projectedBoundingBox.min.y=c.boundingBox.min.y;c.projectedBoundingBox.max.x=a.x;c.projectedBoundingBox.max.y=c.boundingBox.max.y;return c};Potree.PointCloudOctree.prototype.getProfile=function(a,b,c,e,d){a=new Potree.ProfileRequest(a,b,c,e,d);this.profileRequests.push(a)};Potree.PointCloudOctree.prototype.getVisibleExtent=function(){return this.visibleBounds.applyMatrix4(this.matrixWorld)};
Potree.PointCloudOctree.prototype.pick=function(a,b,c,e){e=void 0===e?{}:e;var d=a.renderer,f=a.pRenderer;performance.mark('pick-start');var g=function(a,b){return void 0!==a?a:b};a=g(e.pickWindowSize,17);g(e.pickOutsideClipRegion,!1);var h=d.getSize(new THREE.Vector3),l=Math.ceil(g(e.width,h.width));h=Math.ceil(g(e.height,h.height));var k=g(e.pointSizeType,this.material.pointSizeType);g=g(e.pointSize,this.material.size);c=this.nodesOnRay(this.visibleNodes,c);if(0===c.length)return null;if(!this.pickState){var m=
new THREE.Scene,p=new Potree.PointCloudMaterial;p.pointColorType=Potree.PointColorType.POINT_INDEX;this.pickState={renderTarget:new THREE.WebGLRenderTarget(1,1,{minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat}),material:p,scene:m}}m=this.pickState;p=m.material;p.pointSizeType=k;p.shape=this.material.shape;p.size=g;p.uniforms.minSize.value=this.material.uniforms.minSize.value;p.uniforms.maxSize.value=this.material.uniforms.maxSize.value;p.classification=this.material.classification;
e.pickClipped?(p.clipBoxes=this.material.clipBoxes,p.clipTask=this.material.clipTask===Potree.ClipTask.HIGHLIGHT?Potree.ClipTask.NONE:this.material.clipTask):p.clipBoxes=[];this.updateMaterial(p,c,b,d);m.renderTarget.setSize(l,h);g=new THREE.Vector2(e.x,e.y);k=d.getContext();k.enable(k.SCISSOR_TEST);k.scissor(parseInt(g.x-(a-1)/2),parseInt(g.y-(a-1)/2),parseInt(a),parseInt(a));d.state.buffers.depth.setTest(p.depthTest);d.state.buffers.depth.setMask(p.depthWrite);d.state.setBlending(THREE.NoBlending);
d.setRenderTarget(m.renderTarget);k.clearColor(0,0,0,0);d.clearTarget(m.renderTarget,!0,!0,!0);var n=this.material;this.material=p;f.renderOctree(this,c,b,m.renderTarget);this.material=n;b=parseInt(Math.min(Math.max(0,g.x-(a-1)/2),l));f=parseInt(Math.min(Math.max(0,g.y-(a-1)/2),h));l=parseInt(Math.min(b+a,l)-b);h=parseInt(Math.min(f+a,h)-f);l=new Uint8Array(4*l*h);k.readPixels(b,f,a,a,k.RGBA,k.UNSIGNED_BYTE,l);d.setRenderTarget(null);d.resetGLState();d.setScissorTest(!1);k.disable(k.SCISSOR_TEST);
h=new Uint32Array(l.buffer);d=[];for(b=0;b<a;b++)for(f=0;f<a;f++)m=b+f*a,k=Math.pow(b-(a-1)/2,2)+Math.pow(f-(a-1)/2,2),g=l[4*m+3],l[4*m+3]=0,m=h[m],0===g&&0===m||void 0===g||void 0===m||(g={pIndex:m,pcIndex:g,distanceToCenter:k},e.all?d.push(g):0<d.length?k<d[0].distanceToCenter&&(d[0]=g):d.push(g));a=$jscomp.makeIterator(d);for(l=a.next();!l.done;l=a.next()){l=l.value;h={};if(!c[l.pcIndex])return null;f=c[l.pcIndex];b=f.sceneNode;f=f.geometryNode.geometry;for(var r in f.attributes)k=f.attributes[r],
'position'===r&&(k=new THREE.Vector3(k.array[3*l.pIndex],k.array[3*l.pIndex+1],k.array[3*l.pIndex+2]),k.applyMatrix4(b.matrixWorld),h[r]=k);l.point=h}performance.mark('pick-end');performance.measure('pick','pick-start','pick-end');return e.all?d.map(function(a){return a.point}):0===d.length?null:d[0].point};
Potree.PointCloudOctree.prototype.getFittedBoxGen=function $jscomp$generator$function(a){var c,e,d,f=this,g,h,l,k,m,p,n,r,t,q,u,z,A,w,v,x,y;return $jscomp.generator.createGenerator($jscomp$generator$function,function(B){1==B.nextAddress&&(c=performance.now(),e=new THREE.Box3,d=(new THREE.Matrix4).getInverse(a.matrixWorld),g=$jscomp.makeIterator(f.visibleNodes),h=g.next());if(3!=B.nextAddress){if(h.done)return w=e.getCenter().applyMatrix4(a.matrixWorld),v=new THREE.Object3D,v.position.copy(w),v.scale.copy(a.scale),
v.rotation.copy(a.rotation),x=(new THREE.Vector3).subVectors(e.max,e.min),v.scale.multiply(x),y=performance.now()-c,console.log('duration: ',y),B.yield(v,0);l=h.value;if(!l.sceneNode)return B.jumpTo(3);k=l.geometryNode.buffer;m=k.offset('position');p=k.stride;n=new DataView(k.data);r=(new THREE.Matrix4).multiplyMatrices(d,l.sceneNode.matrixWorld);t=new THREE.Vector4;for(q=0;q<k.numElements;q++)u=n.getFloat32(q*p+m+0,!0),z=n.getFloat32(q*p+m+4,!0),A=n.getFloat32(q*p+m+8,!0),t.set(u,z,A,1),t.applyMatrix4(r),
-.5<t.x&&.5>t.x&&-.5<t.y&&.5>t.y&&-.5<t.z&&.5>t.z&&e.expandByPoint(t);return B.yield(void 0,3)}h=g.next();return B.jumpTo(2)})};
Potree.PointCloudOctree.prototype.getFittedBox=function(a,b){b=Infinity;for(var c=performance.now(),e=new THREE.Box3,d=(new THREE.Matrix4).getInverse(a.matrixWorld),f=$jscomp.makeIterator(this.visibleNodes),g=f.next();!g.done;g=f.next()){var h=g.value;if(h.sceneNode&&!(h.getLevel()>b)){g=h.geometryNode.buffer;var l=g.offset('position'),k=g.stride,m=new DataView(g.data);h=(new THREE.Matrix4).multiplyMatrices(d,h.sceneNode.matrixWorld);for(var p=new THREE.Vector4,n=0;n<g.numElements;n++){var r=m.getFloat32(n*
k+l+0,!0),t=m.getFloat32(n*k+l+4,!0),q=m.getFloat32(n*k+l+8,!0);p.set(r,t,q,1);p.applyMatrix4(h);-.5<p.x&&.5>p.x&&-.5<p.y&&.5>p.y&&-.5<p.z&&.5>p.z&&e.expandByPoint(p)}}}d=e.getCenter().applyMatrix4(a.matrixWorld);b=new THREE.Object3D;b.position.copy(d);b.scale.copy(a.scale);b.rotation.copy(a.rotation);a=(new THREE.Vector3).subVectors(e.max,e.min);b.scale.multiply(a);c=performance.now()-c;console.log('duration: ',c);return b};
Potree.PointCloudOctree.prototype.find=function(a){var b=null;a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())c=c.value,b='r'===c?this.root:b.children[c];return b};$jscomp.global.Object.defineProperties(Potree.PointCloudOctree.prototype,{progress:{configurable:!0,enumerable:!0,get:function(){return this.visibleNodes.length/this.visibleGeometry.length}}});
var lib$potree$potree_clean$classdecl$var12=function(){this.octreeDir=this.url=null;this.spacing=0;this.pointAttributes=this.nodes=this.root=this.boundingBox=null;this.hierarchyStepSize=-1;this.loader=null};Potree.PointCloudOctreeGeometry=lib$potree$potree_clean$classdecl$var12;
var lib$potree$potree_clean$classdecl$var13=function(a,b,c){Potree.PointCloudTreeNode.call(this);this.id=Potree.PointCloudOctreeGeometryNode.IDCount++;this.name=a;this.index=parseInt(a.charAt(a.length-1));this.pcoGeometry=b;this.geometry=null;this.boundingBox=c;this.boundingSphere=c.getBoundingSphere(new THREE.Sphere);this.children={};this.numPoints=0;this.level=null;this.loaded=!1;this.oneTimeDisposeHandlers=[]};$jscomp.inherits(lib$potree$potree_clean$classdecl$var13,Potree.PointCloudTreeNode);
lib$potree$potree_clean$classdecl$var13.prototype.isGeometryNode=function(){return!0};lib$potree$potree_clean$classdecl$var13.prototype.getLevel=function(){return this.level};lib$potree$potree_clean$classdecl$var13.prototype.isTreeNode=function(){return!1};lib$potree$potree_clean$classdecl$var13.prototype.isLoaded=function(){return this.loaded};lib$potree$potree_clean$classdecl$var13.prototype.getBoundingSphere=function(){return this.boundingSphere};
lib$potree$potree_clean$classdecl$var13.prototype.getBoundingBox=function(){return this.boundingBox};lib$potree$potree_clean$classdecl$var13.prototype.getChildren=function(){for(var a=[],b=0;8>b;b++)this.children[b]&&a.push(this.children[b]);return a};
lib$potree$potree_clean$classdecl$var13.prototype.getURL=function(){var a='',b=this.pcoGeometry.loader.version;b.equalOrHigher('1.5')?a=this.pcoGeometry.octreeDir+'/'+this.getHierarchyPath()+'/'+this.name:b.equalOrHigher('1.4')?a=this.pcoGeometry.octreeDir+'/'+this.name:b.upTo('1.3')&&(a=this.pcoGeometry.octreeDir+'/'+this.name);return a};
lib$potree$potree_clean$classdecl$var13.prototype.getHierarchyPath=function(){for(var a='r/',b=this.pcoGeometry.hierarchyStepSize,c=this.name.substr(1),e=Math.floor(c.length/b),d=0;d<e;d++)a+=c.substr(d*b,b)+'/';return a=a.slice(0,-1)};lib$potree$potree_clean$classdecl$var13.prototype.addChild=function(a){this.children[a.index]=a;a.parent=this};
lib$potree$potree_clean$classdecl$var13.prototype.load=function(){!0===this.loading||!0===this.loaded||Potree.numNodesLoading>=Potree.maxNodesLoading||(this.loading=!0,Potree.numNodesLoading++,this.pcoGeometry.loader.version.equalOrHigher('1.5')?0===this.level%this.pcoGeometry.hierarchyStepSize&&this.hasChildren?this.loadHierachyThenPoints():this.loadPoints():this.loadPoints())};lib$potree$potree_clean$classdecl$var13.prototype.loadPoints=function(){this.pcoGeometry.loader.load(this)};
lib$potree$potree_clean$classdecl$var13.prototype.loadHierachyThenPoints=function(){var a=this;if(0===a.level%a.pcoGeometry.hierarchyStepSize){var b=a.pcoGeometry.octreeDir+'/'+a.getHierarchyPath()+'/'+a.name+'.hrc',c=Potree.XHRFactory.createXMLHttpRequest();c.open('GET',b,!0);c.responseType='arraybuffer';c.overrideMimeType('text/plain; charset=x-user-defined');c.onreadystatechange=function(){if(4===c.readyState)if(200===c.status||0===c.status){var e=c.response,d=new DataView(e),f=[],g=d.getUint8(0),
h=d.getUint32(1,!0);a.numPoints=h;f.push({children:g,numPoints:h,name:a.name});g=[];for(h=5;0<f.length;){for(var l=f.shift(),k=1,m=0;8>m;m++){if(0!==(l.children&k)){var p=l.name+m,n=d.getUint8(h),r=d.getUint32(h+1,!0);f.push({children:n,numPoints:r,name:p});g.push({children:n,numPoints:r,name:p});h+=5}k*=2}if(h===e.byteLength)break}e={};e[a.name]=a;d=a.pcoGeometry;for(f=0;f<g.length;f++)h=g[f].name,l=g[f].numPoints,p=parseInt(h.charAt(h.length-1)),k=h.substring(0,h.length-1),k=e[k],m=h.length-1,p=
Potree.POCLoader.createChildAABB(k.boundingBox,p),p=new Potree.PointCloudOctreeGeometryNode(h,d,p),p.level=m,p.numPoints=l,p.hasChildren=0<g[f].children,p.spacing=d.spacing/Math.pow(2,m),k.addChild(p),e[h]=p;a.loadPoints()}else console.log('Failed to load file! HTTP status: '+c.status+', file: '+b),Potree.numNodesLoading--};try{c.send(null)}catch(e){console.log('fehler beim laden der punktwolke: '+e)}}};lib$potree$potree_clean$classdecl$var13.prototype.getNumPoints=function(){return this.numPoints};
lib$potree$potree_clean$classdecl$var13.prototype.dispose=function(){if(this.geometry&&null!=this.parent){this.geometry.dispose();this.geometry=null;this.loaded=!1;for(var a=0;a<this.oneTimeDisposeHandlers.length;a++)(0,this.oneTimeDisposeHandlers[a])();this.oneTimeDisposeHandlers=[]}};Potree.PointCloudOctreeGeometryNode=lib$potree$potree_clean$classdecl$var13;Potree.PointCloudOctreeGeometryNode.IDCount=0;Object.assign(Potree.PointCloudOctreeGeometryNode.prototype,THREE.EventDispatcher.prototype);
Potree.PointCloudGreyhoundGeometry=function(){this.spacing=0;this.nodes=this.root=this.boundingBox=null;this.pointAttributes={};this.hierarchyStepSize=-1;this.serverURL=this.boundingSphere=this.projection=this.offset=this.baseDepth=this.schema=this.loader=null;this.normalize={color:!1,intensity:!1}};
Potree.PointCloudGreyhoundGeometryNode=function(a,b,c,e,d){this.id=Potree.PointCloudGreyhoundGeometryNode.IDCount++;this.name=a;this.index=parseInt(a.charAt(a.length-1));this.pcoGeometry=b;this.geometry=null;this.boundingBox=c;this.boundingSphere=c.getBoundingSphere(new THREE.Sphere);this.scale=e;this.offset=d;this.children={};this.numPoints=0;this.level=null;this.loaded=!1;this.oneTimeDisposeHandlers=[];this.baseLoaded=!1;a=this.boundingBox.clone();a.min.sub(this.pcoGeometry.boundingBox.getCenter());
a.max.sub(this.pcoGeometry.boundingBox.getCenter());this.scale&&(a.min.multiplyScalar(1/this.scale),a.max.multiplyScalar(1/this.scale));this.greyhoundBounds=a;this.greyhoundOffset=this.pcoGeometry.offset.clone().add(this.pcoGeometry.boundingBox.getSize(new THREE.Vector3).multiplyScalar(.5))};Potree.PointCloudGreyhoundGeometryNode.IDCount=0;Potree.PointCloudGreyhoundGeometryNode.prototype=Object.create(Potree.PointCloudTreeNode.prototype);
Potree.PointCloudGreyhoundGeometryNode.prototype.isGeometryNode=function(){return!0};Potree.PointCloudGreyhoundGeometryNode.prototype.isTreeNode=function(){return!1};Potree.PointCloudGreyhoundGeometryNode.prototype.isLoaded=function(){return this.loaded};Potree.PointCloudGreyhoundGeometryNode.prototype.getBoundingSphere=function(){return this.boundingSphere};Potree.PointCloudGreyhoundGeometryNode.prototype.getBoundingBox=function(){return this.boundingBox};
Potree.PointCloudGreyhoundGeometryNode.prototype.getLevel=function(){return this.level};Potree.PointCloudGreyhoundGeometryNode.prototype.getChildren=function(){for(var a=[],b=0;8>b;++b)this.children[b]&&a.push(this.children[b]);return a};
Potree.PointCloudGreyhoundGeometryNode.prototype.getURL=function(){var a=this.greyhoundBounds;a=''+this.pcoGeometry.serverURL+'read?depthBegin='+(this.baseLoaded?this.level+this.pcoGeometry.baseDepth:0)+'&depthEnd='+(this.level+this.pcoGeometry.baseDepth+1)+'&bounds=['+(a.min.x+','+a.min.y+','+a.min.z+','+a.max.x+','+a.max.y+','+a.max.z)+']&schema='+JSON.stringify(this.pcoGeometry.schema)+'&compress=true';this.scale&&(a+='&scale='+this.scale);if(this.greyhoundOffset){var b=this.greyhoundOffset;a+=
'&offset=['+b.x+','+b.y+','+b.z+']'}this.baseLoaded||(this.baseLoaded=!0);return a};Potree.PointCloudGreyhoundGeometryNode.prototype.addChild=function(a){this.children[a.index]=a;a.parent=this};Potree.PointCloudGreyhoundGeometryNode.prototype.load=function(){!0===this.loading||!0===this.loaded||Potree.numNodesLoading>=Potree.maxNodesLoading||(this.loading=!0,Potree.numNodesLoading++,0===this.level%this.pcoGeometry.hierarchyStepSize&&this.hasChildren?this.loadHierarchyThenPoints():this.loadPoints())};
Potree.PointCloudGreyhoundGeometryNode.prototype.loadPoints=function(){this.pcoGeometry.loader.load(this)};
Potree.PointCloudGreyhoundGeometryNode.prototype.loadHierarchyThenPoints=function(){var a=[0,2,1,3,4,6,5,7],b=function(b){var c=0;Object.keys(b).forEach(function(b){'swd'===b?c+=1<<a[0]:'nwd'===b?c+=1<<a[1]:'swu'===b?c+=1<<a[2]:'nwu'===b?c+=1<<a[3]:'sed'===b?c+=1<<a[4]:'ned'===b?c+=1<<a[5]:'seu'===b?c+=1<<a[6]:'neu'===b&&(c+=1<<a[7])});return c},c=function(d,e,f){var g,h;Object.keys(d).forEach(function(k){if('n'!==k){switch(k){case 'swd':g=d.swd;h=e+a[0];break;case 'nwd':g=d.nwd;h=e+a[1];break;case 'swu':g=
d.swu;h=e+a[2];break;case 'nwu':g=d.nwu;h=e+a[3];break;case 'sed':g=d.sed;h=e+a[4];break;case 'ned':g=d.ned;h=e+a[5];break;case 'seu':g=d.seu;h=e+a[6];break;case 'neu':g=d.neu,h=e+a[7]}f.push({children:b(g),numPoints:g.n,name:h});c(g,h,f)}})};if(0===this.level%this.pcoGeometry.hierarchyStepSize){var e=this.level+this.pcoGeometry.baseDepth,d=this.greyhoundBounds,f=''+this.pcoGeometry.serverURL+'hierarchy?bounds=['+(d.min.x+','+d.min.y+','+d.min.z+','+d.max.x+','+d.max.y+','+d.max.z)+']&depthBegin='+
e+'&depthEnd='+(e+this.pcoGeometry.hierarchyStepSize+2);this.scale&&(f+='&scale='+this.scale);this.greyhoundOffset&&(e=this.greyhoundOffset,f+='&offset=['+e.x+','+e.y+','+e.z+']');var g=Potree.XHRFactory.createXMLHttpRequest();g.open('GET',f,!0);var h=this;g.onreadystatechange=function(){if(4===g.readyState)if(200===g.status||0===g.status){var a=JSON.parse(g.responseText)||{},b=[];h.numPoints=a.n;c(a,h.name,b);a={};a[h.name]=h;for(var d=h.pcoGeometry,e=0;e<b.length;e++){var n=b[e].name,r=b[e].numPoints,
t=parseInt(n.charAt(n.length-1)),q=n.substring(0,n.length-1);q=a[q];var u=n.length-1;t=Potree.GreyhoundLoader.createChildAABB(q.boundingBox,t);t=new Potree.PointCloudGreyhoundGeometryNode(n,d,t,h.scale,h.offset);t.level=u;t.numPoints=r;t.hasChildren=0<b[e].children;t.spacing=d.spacing/Math.pow(2,u);q.addChild(t);a[n]=t}h.loadPoints()}else console.log('Failed to load file! HTTP status:',g.status,'file:',f)};try{g.send(null)}catch(l){console.log('fehler beim laden der punktwolke: '+l)}}};
Potree.PointCloudGreyhoundGeometryNode.prototype.getNumPoints=function(){return this.numPoints};Potree.PointCloudGreyhoundGeometryNode.prototype.dispose=function(){if(this.geometry&&null!=this.parent){this.geometry.dispose();this.geometry=null;this.loaded=!1;for(var a=0;a<this.oneTimeDisposeHandlers.length;a++)(0,this.oneTimeDisposeHandlers[a])();this.oneTimeDisposeHandlers=[]}};Object.assign(Potree.PointCloudGreyhoundGeometryNode.prototype,THREE.EventDispatcher.prototype);Potree.utils=function(){};
Potree.utils.loadShapefileFeatures=function(a,b){var c=[];shapefile.open(a).then(function(a){a.read().then(function g(e){if(e.done)b(c);else return e.value&&'Feature'===e.value.type&&void 0!==e.value.geometry&&c.push(e.value),a.read().then(g)})})};Potree.utils.toString=function(a){return a instanceof THREE.Vector3?a.x.toFixed(2)+', '+a.y.toFixed(2)+', '+a.z.toFixed(2):''+a};Potree.utils.normalizeURL=function(a){a=new URL(a);return a.protocol+'//'+a.hostname+a.pathname.replace(/\/+/g,'/')};
Potree.utils.pathExists=function(a){var b=Potree.XHRFactory.createXMLHttpRequest();b.open('GET',a,!1);b.send(null);return 200!==b.status?!1:!0};Potree.utils.debugSphere=function(a,b,c,e){var d=new THREE.SphereGeometry(1,8,8);e=void 0!==e?new THREE.MeshBasicMaterial({color:e}):new THREE.MeshNormalMaterial;d=new THREE.Mesh(d,e);d.position.copy(b);d.scale.set(c,c,c);a.add(d)};
Potree.utils.debugLine=function(a,b,c,e){e=new THREE.LineBasicMaterial({color:e});var d=new THREE.Geometry;d.vertices.push(b,c);b=new THREE.Line(d,e);a.add(b)};
Potree.utils.computeTransformedBoundingBox=function(a,b){a=[(new THREE.Vector3(a.min.x,a.min.y,a.min.z)).applyMatrix4(b),(new THREE.Vector3(a.min.x,a.min.y,a.min.z)).applyMatrix4(b),(new THREE.Vector3(a.max.x,a.min.y,a.min.z)).applyMatrix4(b),(new THREE.Vector3(a.min.x,a.max.y,a.min.z)).applyMatrix4(b),(new THREE.Vector3(a.min.x,a.min.y,a.max.z)).applyMatrix4(b),(new THREE.Vector3(a.min.x,a.max.y,a.max.z)).applyMatrix4(b),(new THREE.Vector3(a.max.x,a.max.y,a.min.z)).applyMatrix4(b),(new THREE.Vector3(a.max.x,
a.min.y,a.max.z)).applyMatrix4(b),(new THREE.Vector3(a.max.x,a.max.y,a.max.z)).applyMatrix4(b)];b=new THREE.Box3;b.setFromPoints(a);return b};Potree.utils.addCommas=function(a){var b=(a+'').split('.');a=b[0];b=1<b.length?'.'+b[1]:'';for(var c=/(\d+)(\d{3})/;c.test(a);)a=a.replace(c,'$1,$2');return a+b};Potree.utils.removeCommas=function(a){return a.replace(/,/g,'')};Potree.utils.createWorker=function(a){a=new Blob([a],{type:'application/javascript'});return new Worker(URL.createObjectURL(a))};
Potree.utils.moveTo=function(a,b,c){var e=a.view,d=a.getActiveCamera();a=TWEEN.Easing.Quartic.Out;b=(new TWEEN.Tween(e.position)).to(b,500);b.easing(a);b.start();b=d.position.distanceTo(c);var f=(new THREE.Vector3).addVectors(d.position,d.getWorldDirection(Potree.tempVector3).clone().multiplyScalar(b));c=(new TWEEN.Tween(f)).to(c,500);c.easing(a);c.onUpdate(function(){e.lookAt(f)});c.onComplete(function(){e.lookAt(f)});c.start()};
Potree.utils.loadSkybox=function(a){var b=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1E5);b.up.set(0,0,1);var c=new THREE.Scene,e=[a+'px.jpg',a+'nx.jpg',a+'py.jpg',a+'ny.jpg',a+'pz.jpg',a+'nz.jpg'];a=[];for(var d={},f=0;6>f;d={material:d.material},f++)d.material=new THREE.MeshBasicMaterial({map:null,side:THREE.BackSide,depthTest:!1,depthWrite:!1,color:4343126}),a.push(d.material),(new THREE.TextureLoader).load(e[f],function(a){return function(b){a.material.map=b;a.material.needsUpdate=
!0;a.material.color.setHex(16777215)}}(d),function(a){},function(a){console.log('An error happened',a)});e=new THREE.CubeGeometry(5E3,5E3,5E3);a=new THREE.Mesh(e,a);c.add(a);c.rotation.x=Math.PI/2;return{camera:b,scene:c}};
Potree.utils.createGrid=function(a,b,c,e){e=new THREE.LineBasicMaterial({color:e||8947848});for(var d=new THREE.Geometry,f=0;f<=b;f++)d.vertices.push(new THREE.Vector3(-(c*a)/2,f*c-c*b/2,0)),d.vertices.push(new THREE.Vector3(+(c*a)/2,f*c-c*b/2,0));for(f=0;f<=a;f++)d.vertices.push(new THREE.Vector3(f*c-c*a/2,-(c*b)/2,0)),d.vertices.push(new THREE.Vector3(f*c-c*a/2,+(c*b)/2,0));a=new THREE.LineSegments(d,e,THREE.LinePieces);a.receiveShadow=!0;return a};
Potree.utils.createBackgroundTexture=function(a,b){function c(a,b){return 1/(2*Math.PI)*Math.exp(-(a*a+b*b)/2)}for(var e=new Uint8Array(3*a*b),d=[1,1.5,1.7],f=c(0,0),g=0;g<a;g++)for(var h=0;h<b;h++){var l=g+a*h,k=c(2*(g/a*2-1),2*(h/b*2-1))/f,m=(Math.random()+Math.random()+Math.random())/3;m=(.5*k+.5)*m*.03;m*=.4;e[3*l]=255*(k/15+.05+m)*d[0];e[3*l+1]=255*(k/15+.05+m)*d[1];e[3*l+2]=255*(k/15+.05+m)*d[2]}a=new THREE.DataTexture(e,a,b,THREE.RGBFormat);a.needsUpdate=!0;return a};
Potree.utils.getMousePointCloudIntersection=function(a,b,c,e,d){d=void 0===d?{}:d;var f=c.renderer,g={x:a.x/f.domElement.clientWidth*2-1,y:2*-(a.y/f.domElement.clientHeight)+1},h={};d.pickClipped&&(h.pickClipped=d.pickClipped);h.x=a.x;h.y=f.domElement.clientHeight-a.y;a=new THREE.Raycaster;a.setFromCamera(g,b);g=a.ray;a=null;d=Infinity;var l=f=null;e=$jscomp.makeIterator(e);for(var k=e.next();!k.done;k=e.next()){k=k.value;var m=k.pick(c,b,g,h);if(m){var p=b.position.distanceTo(m.position);p<d&&(d=
p,a=k,f=m.position,l=m)}}return a?{location:f,distance:d,pointcloud:a,point:l}:null};Potree.utils.pixelsArrayToImage=function(a,b,c){var e=document.createElement('canvas');e.width=b;e.height=c;var d=e.getContext('2d');a=new a.constructor(a);for(var f=0;f<a.length;f++)a[4*f+3]=255;b=d.createImageData(b,c);b.data.set(a);d.putImageData(b,0,0);a=new Image;a.src=e.toDataURL();return a};
Potree.utils.pixelsArrayToDataUrl=function(a,b,c){var e=document.createElement('canvas');e.width=b;e.height=c;var d=e.getContext('2d');a=new a.constructor(a);for(var f=0;f<a.length;f++)a[4*f+3]=255;b=d.createImageData(b,c);b.data.set(a);d.putImageData(b,0,0);return e.toDataURL()};
Potree.utils.pixelsArrayToCanvas=function(a,b,c){var e=document.createElement('canvas');e.width=b;e.height=c;var d=e.getContext('2d');a=new a.constructor(a);for(var f=4*b,g=0;g<parseInt(c/2);g++){var h=c-g-1,l=a.slice(g*f,g*f+f),k=a.slice(h*f,h*f+f);a.set(k,g*f);a.set(l,h*f)}b=d.createImageData(b,c);b.data.set(a);d.putImageData(b,0,0);return e};Potree.utils.removeListeners=function(a,b){void 0!==a._listeners&&a._listeners[b]&&delete a._listeners[b]};
Potree.utils.mouseToRay=function(a,b,c,e){c=a.x/c*2-1;e=2*-(a.y/e)+1;a=new THREE.Vector3(c,e,.5);c=new THREE.Vector3(c,e,0);a.unproject(b);c.unproject(b);b=(new THREE.Vector3).subVectors(a,c).normalize();return new THREE.Ray(c,b)};
Potree.utils.projectedRadius=function(a,b,c,e,d){if(b instanceof THREE.OrthographicCamera)return Potree.utils.projectedRadiusOrtho(a,b.projectionMatrix,e,d);if(b instanceof THREE.PerspectiveCamera)return Potree.utils.projectedRadiusPerspective(a,b.fov*Math.PI/180,c,d);throw Error('invalid parameters');};Potree.utils.projectedRadiusPerspective=function(a,b,c,e){return 1/Math.tan(b/2)/c*e/2*a};
Potree.utils.projectedRadiusOrtho=function(a,b,c,e){var d=new THREE.Vector4(0);a=new THREE.Vector4(a);d.applyMatrix4(b);a.applyMatrix4(b);d=new THREE.Vector3(d.x,d.y,d.z);a=new THREE.Vector3(a.x,a.y,a.z);d.x=.5*(d.x+1)*c;d.y=.5*(d.y+1)*e;a.x=.5*(a.x+1)*c;a.y=.5*(a.y+1)*e;return d.distanceTo(a)};Potree.utils.topView=function(a,b){a.position.set(0,1,0);a.rotation.set(-Math.PI/2,0,0);a.zoomTo(b,1)};Potree.utils.frontView=function(a,b){a.position.set(0,0,1);a.rotation.set(0,0,0);a.zoomTo(b,1)};
Potree.utils.leftView=function(a,b){a.position.set(-1,0,0);a.rotation.set(0,-Math.PI/2,0);a.zoomTo(b,1)};Potree.utils.rightView=function(a,b){a.position.set(1,0,0);a.rotation.set(0,Math.PI/2,0);a.zoomTo(b,1)};Potree.utils.frustumSphereIntersection=function(a,b){a=a.planes;for(var c=b.center,e=-b.radius,d=Number.MAX_VALUE,f=0;6>f;f++){var g=a[f].distanceToPoint(c);if(g<e)return 0;d=Math.min(d,g)}return d>=b.radius?2:1};
Potree.utils.generateDataTexture=function(a,b,c){var e=a*b,d=new Uint8Array(4*a*b),f=Math.floor(255*c.r),g=Math.floor(255*c.g);c=Math.floor(255*c.b);for(var h=0;h<e;h++)d[3*h]=f,d[3*h+1]=g,d[3*h+2]=c;a=new THREE.DataTexture(d,a,b,THREE.RGBAFormat);a.needsUpdate=!0;a.magFilter=THREE.NearestFilter;return a};
Potree.utils.getParameterByName=function(a){a=a.replace(/[[]/,'\\[').replace(/[\]]/,'\\]');a=(new RegExp('[\\?&]'+a+'=([^&#]*)')).exec(document.location.search);return null===a?null:decodeURIComponent(a[1].replace(/\+/g,' '))};
Potree.utils.setParameter=function(a,b){a=a.replace(/[[]/,'\\[').replace(/[\]]/,'\\]');var c=(new RegExp('([\\?&])('+a+'=([^&#]*))')).exec(document.location.search),e=window.location.href;null===c?(e=0===window.location.search.length?e+'?':e+'&',e=e+a+'='+b):e=e.replace(c[2],a+'='+b);window.history.replaceState({},'',e)};
Potree.utils.clipboardCopy=function(a){var b=document.createElement('textarea');b.style.position='fixed';b.style.top=0;b.style.left=0;b.style.width='2em';b.style.height='2em';b.style.padding=0;b.style.border='none';b.style.outline='none';b.style.boxShadow='none';b.style.background='transparent';b.value=a;document.body.appendChild(b);b.select();try{document.execCommand('copy')?console.log('copied text to clipboard'):console.log('copy to clipboard failed')}catch(c){console.log('error while trying to copy to clipboard')}document.body.removeChild(b)};
Potree.utils.screenPass=new function(){this.screenScene=new THREE.Scene;this.screenQuad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2,0));this.screenQuad.material.depthTest=!0;this.screenQuad.material.depthWrite=!0;this.screenQuad.material.transparent=!0;this.screenScene.add(this.screenQuad);this.camera=new THREE.Camera;this.render=function(a,b,c){this.screenQuad.material=b;'undefined'===typeof c?a.render(this.screenScene,this.camera):a.render(this.screenScene,this.camera,c)}};
Potree.Features=function(){var a=document.createElement('canvas'),b=a.getContext('webgl')||a.getContext('experimental-webgl');if(null===b)return null;a=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.HIGH_FLOAT);var c=b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.MEDIUM_FLOAT),e=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.HIGH_FLOAT),d=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.MEDIUM_FLOAT);c=0<c.precision&&0<d.precision;return{SHADER_INTERPOLATION:{isSupported:function(){var a;return a=(a=b.getExtension('EXT_frag_depth'))&&
8<=b.getParameter(b.MAX_VARYING_VECTORS)}},SHADER_SPLATS:{isSupported:function(){var a;return a=(a=(a=b.getExtension('EXT_frag_depth'))&&b.getExtension('OES_texture_float'))&&8<=b.getParameter(b.MAX_VARYING_VECTORS)}},SHADER_EDL:{isSupported:function(){var a;return a=(a=b.getExtension('OES_texture_float'))&&8<=b.getParameter(b.MAX_VARYING_VECTORS)}},precision:0<a.precision&&0<e.precision?'highp':c?'mediump':'lowp'}}();
var lib$potree$potree_clean$classdecl$var14=function(a){var b=THREE.Object3D.call(this)||this;var c=new THREE.Texture;c.minFilter=THREE.LinearFilter;c.magFilter=THREE.LinearFilter;c=new THREE.SpriteMaterial({map:c,depthTest:!1,depthWrite:!1});b.material=c;b.sprite=new THREE.Sprite(c);b.add(b.sprite);b.borderThickness=4;b.fontface='Arial';b.fontsize=28;b.borderColor={r:0,g:0,b:0,a:1};b.backgroundColor={r:255,g:255,b:255,a:1};b.textColor={r:255,g:255,b:255,a:1};b.text='';b.setText(a);return b};
$jscomp.inherits(lib$potree$potree_clean$classdecl$var14,THREE.Object3D);lib$potree$potree_clean$classdecl$var14.prototype.setText=function(a){this.text!==a&&(this.text=a,this.update())};lib$potree$potree_clean$classdecl$var14.prototype.setTextColor=function(a){this.textColor=a;this.update()};lib$potree$potree_clean$classdecl$var14.prototype.setBorderColor=function(a){this.borderColor=a;this.update()};
lib$potree$potree_clean$classdecl$var14.prototype.setBackgroundColor=function(a){this.backgroundColor=a;this.update()};
lib$potree$potree_clean$classdecl$var14.prototype.update=function(){var a=document.createElement('canvas'),b=a.getContext('2d');b.font='Bold '+this.fontsize+'px '+this.fontface;var c=b.measureText(this.text).width,e=10+c+2*this.borderThickness,d=1.4*this.fontsize+2*this.borderThickness;b.canvas.width=e;b.canvas.height=d;b.font='Bold '+this.fontsize+'px '+this.fontface;b.fillStyle='rgba('+this.backgroundColor.r+','+this.backgroundColor.g+','+this.backgroundColor.b+','+this.backgroundColor.a+')';b.strokeStyle=
'rgba('+this.borderColor.r+','+this.borderColor.g+','+this.borderColor.b+','+this.borderColor.a+')';b.lineWidth=this.borderThickness;this.roundRect(b,this.borderThickness/2,this.borderThickness/2,c+this.borderThickness+10,1.4*this.fontsize+this.borderThickness,6);b.strokeStyle='rgba(0, 0, 0, 1.0)';b.strokeText(this.text,this.borderThickness+5,this.fontsize+this.borderThickness);b.fillStyle='rgba('+this.textColor.r+','+this.textColor.g+','+this.textColor.b+','+this.textColor.a+')';b.fillText(this.text,
this.borderThickness+5,this.fontsize+this.borderThickness);a=new THREE.Texture(a);a.minFilter=THREE.LinearFilter;a.magFilter=THREE.LinearFilter;a.needsUpdate=!0;this.sprite.material.map=a;this.sprite.scale.set(.01*e,.01*d,1)};
lib$potree$potree_clean$classdecl$var14.prototype.roundRect=function(a,b,c,e,d,f){a.beginPath();a.moveTo(b+f,c);a.lineTo(b+e-f,c);a.quadraticCurveTo(b+e,c,b+e,c+f);a.lineTo(b+e,c+d-f);a.quadraticCurveTo(b+e,c+d,b+e-f,c+d);a.lineTo(b+f,c+d);a.quadraticCurveTo(b,c+d,b,c+d-f);a.lineTo(b,c+f);a.quadraticCurveTo(b,c,b+f,c);a.closePath();a.fill();a.stroke()};Potree.TextSprite=lib$potree$potree_clean$classdecl$var14;
Potree.Version=function(a){this.version=a;var b=-1===a.indexOf('.')?a.length:a.indexOf('.');this.versionMajor=parseInt(a.substr(0,b));this.versionMinor=parseInt(a.substr(b+1));0===this.versionMinor.length&&(this.versionMinor=0)};Potree.Version.prototype.newerThan=function(a){a=new Potree.Version(a);return this.versionMajor>a.versionMajor?!0:this.versionMajor===a.versionMajor&&this.versionMinor>a.versionMinor?!0:!1};
Potree.Version.prototype.equalOrHigher=function(a){a=new Potree.Version(a);return this.versionMajor>a.versionMajor?!0:this.versionMajor===a.versionMajor&&this.versionMinor>=a.versionMinor?!0:!1};Potree.Version.prototype.upTo=function(a){return!this.newerThan(a)};
var lib$potree$potree_clean$classdecl$var15=function(){var a=THREE.Object3D.call(this)||this;a.constructor.counter=void 0===a.constructor.counter?0:a.constructor.counter+1;a.name='Measure_'+a.constructor.counter;a.points=[];a._showDistances=!0;a._showCoordinates=!1;a._showArea=!1;a._closed=!0;a._showAngles=!1;a._showHeight=!1;a.maxMarkers=Number.MAX_SAFE_INTEGER;a.sphereGeometry=new THREE.SphereGeometry(.4,10,10);a.color=new THREE.Color(16711680);a.lengthUnit={code:'m'};a.spheres=[];a.edges=[];a.sphereLabels=
[];a.edgeLabels=[];a.angleLabels=[];a.coordinateLabels=[];var b=new THREE.Geometry;b.vertices.push(new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3);b.colors.push(a.color,a.color,a.color);var c=new THREE.LineDashedMaterial({color:16711680,dashSize:5,gapSize:2});c.depthTest=!1;a.heightEdge=new THREE.Line(b,c);a.heightEdge.visible=!1;a.add(a.heightEdge);a.heightLabel=new Potree.TextSprite('');a.heightLabel.setBorderColor({r:0,g:0,b:0,a:.8});a.heightLabel.setBackgroundColor({r:0,
g:0,b:0,a:.3});a.heightLabel.setTextColor({r:180,g:220,b:180,a:1});a.heightLabel.material.depthTest=!1;a.heightLabel.material.opacity=1;a.heightLabel.visible=!1;a.add(a.heightLabel);a.areaLabel=new Potree.TextSprite('');a.areaLabel.setBorderColor({r:0,g:0,b:0,a:.8});a.areaLabel.setBackgroundColor({r:0,g:0,b:0,a:.3});a.areaLabel.setTextColor({r:180,g:220,b:180,a:1});a.areaLabel.material.depthTest=!1;a.areaLabel.material.opacity=1;a.areaLabel.visible=!1;a.add(a.areaLabel);return a};
$jscomp.inherits(lib$potree$potree_clean$classdecl$var15,THREE.Object3D);lib$potree$potree_clean$classdecl$var15.prototype.createSphereMaterial=function(){return new THREE.MeshLambertMaterial({shading:THREE.SmoothShading,color:this.color,depthTest:!1,depthWrite:!1})};
lib$potree$potree_clean$classdecl$var15.prototype.addMarker=function(a){var b=this;a instanceof THREE.Vector3?a={position:a}:a instanceof Array&&(a={position:new (Function.prototype.bind.apply(THREE.Vector3,[null].concat($jscomp.arrayFromIterable(a))))});this.points.push(a);var c=new THREE.Mesh(this.sphereGeometry,this.createSphereMaterial());this.add(c);this.spheres.push(c);var e=new THREE.Geometry;e.vertices.push(new THREE.Vector3,new THREE.Vector3);e.colors.push(this.color,this.color,this.color);
var d=new THREE.LineBasicMaterial({linewidth:1});d.depthTest=!1;e=new THREE.Line(e,d);e.visible=!0;this.add(e);this.edges.push(e);e=new Potree.TextSprite;e.setBorderColor({r:0,g:0,b:0,a:.8});e.setBackgroundColor({r:0,g:0,b:0,a:.3});e.material.depthTest=!1;e.visible=!1;this.edgeLabels.push(e);this.add(e);e=new Potree.TextSprite;e.setBorderColor({r:0,g:0,b:0,a:.8});e.setBackgroundColor({r:0,g:0,b:0,a:.3});e.material.depthTest=!1;e.material.opacity=1;e.visible=!1;this.angleLabels.push(e);this.add(e);
e=new Potree.TextSprite;e.setBorderColor({r:0,g:0,b:0,a:.8});e.setBackgroundColor({r:0,g:0,b:0,a:.3});e.material.depthTest=!1;e.material.opacity=1;e.visible=!1;this.coordinateLabels.push(e);this.add(e);c.addEventListener('drag',function(a){var c=Potree.utils.getMousePointCloudIntersection(a.drag.end,a.viewer.scene.getActiveCamera(),a.viewer,a.viewer.scene.pointclouds,{pickClipped:!0});if(c&&(a=b.spheres.indexOf(a.drag.object),-1!==a)){for(var d=b.points[a],e=$jscomp.makeIterator(Object.keys(c.point).filter(function(a){return'position'!==
a})),f=e.next();!f.done;f=e.next())f=f.value,d[f]=c.point[f];b.setPosition(a,c.location)}});c.addEventListener('drop',function(a){a=b.spheres.indexOf(a.drag.object);-1!==a&&b.dispatchEvent({type:'marker_dropped',measurement:b,index:a})});c.addEventListener('mouseover',function(a){return a.object.material.emissive.setHex(8947848)});c.addEventListener('mouseleave',function(a){return a.object.material.emissive.setHex(0)});this.dispatchEvent({type:'marker_added',measurement:this,sphere:c});this.setMarker(this.points.length-
1,a)};lib$potree$potree_clean$classdecl$var15.prototype.removeMarker=function(a){this.points.splice(a,1);this.remove(this.spheres[a]);var b=0===a?0:a-1;this.remove(this.edges[b]);this.edges.splice(b,1);this.remove(this.edgeLabels[b]);this.edgeLabels.splice(b,1);this.coordinateLabels.splice(a,1);this.spheres.splice(a,1);this.update();this.dispatchEvent({type:'marker_removed',measurement:this})};
lib$potree$potree_clean$classdecl$var15.prototype.setMarker=function(a,b){this.points[a]=b;a={type:'marker_moved',measure:this,index:a,position:b.position.clone()};this.dispatchEvent(a);this.update()};lib$potree$potree_clean$classdecl$var15.prototype.setPosition=function(a,b){this.points[a].position.copy(b);a={type:'marker_moved',measure:this,index:a,position:b.clone()};this.dispatchEvent(a);this.update()};
lib$potree$potree_clean$classdecl$var15.prototype.getArea=function(){for(var a=0,b=this.points.length-1,c=0;c<this.points.length;c++){var e=this.points[c].position;b=this.points[b].position;a+=(b.x+e.x)*(e.y-b.y);b=c}return Math.abs(a/2)};
lib$potree$potree_clean$classdecl$var15.prototype.getTotalDistance=function(){if(0===this.points.length)return 0;for(var a=0,b=1;b<this.points.length;b++){var c=this.points[b-1].position.distanceTo(this.points[b].position);a+=c}this.closed&&1<this.points.length&&(b=this.points[this.points.length-1].position.distanceTo(this.points[0].position),a+=b);return a};
lib$potree$potree_clean$classdecl$var15.prototype.getAngleBetweenLines=function(a,b,c){b=(new THREE.Vector3).subVectors(b.position,a.position);a=(new THREE.Vector3).subVectors(c.position,a.position);return b.angleTo(a)};lib$potree$potree_clean$classdecl$var15.prototype.getAngle=function(a){return 3>this.points.length||a>=this.points.length?0:this.getAngleBetweenLines(this.points[a],0===a?this.points[this.points.length-1]:this.points[a-1],this.points[(a+1)%this.points.length])};
lib$potree$potree_clean$classdecl$var15.prototype.update=function(){if(0!==this.points.length)if(1===this.points.length){var a=this.points[0].position;this.spheres[0].position.copy(a);var b=this.coordinateLabels[0];a=a.toArray().map(function(a){return Potree.utils.addCommas(a.toFixed(2))}).join(', ');b.setText(a);b.visible=this.showCoordinates}else{a=this.points.length-1;b=new THREE.Vector3;for(var c=0;c<=a;c++)b.add(this.points[c].position);b.divideScalar(this.points.length);for(c=0;c<=a;c++){var e=
c,d=this.points[e],f=this.points[c+1>a?0:c+1],g=this.points[0===c?a:c-1],h=this.spheres[e];h.position.copy(d.position);h.material.color=this.color;h=this.edges[e];h.material.color=this.color;h.position.copy(d.position);h.geometry.vertices[0].set(0,0,0);h.geometry.vertices[1].copy(f.position).sub(d.position);h.geometry.verticesNeedUpdate=!0;h.geometry.computeBoundingSphere();h.visible=e<a||this.closed;h=this.edgeLabels[c];var l=(new THREE.Vector3).add(d.position);l.add(f.position);l=l.multiplyScalar(.5);
var k=d.position.distanceTo(f.position);h.position.copy(l);h.setText(Potree.utils.addCommas(k.toFixed(2))+' '+this.lengthUnit.code);h.visible=this.showDistances&&(e<a||this.closed)&&2<=this.points.length&&0<k;h=this.angleLabels[c];l=this.getAngleBetweenLines(d,g,f);k=f.position.clone().sub(g.position);k.multiplyScalar(.5);k=g.position.clone().add(k).sub(d.position).normalize();f=Math.min(d.position.distanceTo(g.position),d.position.distanceTo(f.position));f/=9;d=d.position.clone().add(k.multiplyScalar(f));
h.position.copy(d);d=Potree.utils.addCommas((180/Math.PI*l).toFixed(1))+'\u00b0';h.setText(d);h.visible=this.showAngles&&(e<a||this.closed)&&3<=this.points.length&&0<l}a=this.heightEdge;a.visible=this.showHeight;if(this.heightLabel.visible=this.showHeight)e=this.points.slice().sort(function(a,b){return a.position.z-b.position.z}),c=e[0].position.clone(),d=e[e.length-1].position.clone(),g=c.z,f=d.z,e=f-g,g=new THREE.Vector3(d.x,d.y,g),d=new THREE.Vector3(d.x,d.y,f),a.position.copy(c),a.geometry.vertices[0].set(0,
0,0),a.geometry.vertices[1].copy(g).sub(c),a.geometry.vertices[2].copy(g).sub(c),a.geometry.vertices[3].copy(d).sub(c),a.geometry.verticesNeedUpdate=!0,a.geometry.computeBoundingSphere(),a=g.clone().add(d).multiplyScalar(.5),this.heightLabel.position.copy(a),a=Potree.utils.addCommas(e.toFixed(2))+' '+this.lengthUnit.code,this.heightLabel.setText(a);this.areaLabel.position.copy(b);this.areaLabel.visible=this.showArea&&3<=this.points.length;b=Potree.utils.addCommas(this.getArea().toFixed(1))+' '+this.lengthUnit.code+
'\u00b2';this.areaLabel.setText(b)}};lib$potree$potree_clean$classdecl$var15.prototype.raycast=function(a,b){for(var c=0;c<this.points.length;c++)this.spheres[c].raycast(a,b);for(c=0;c<b.length;c++){var e=b[c];e.distance=a.ray.origin.distanceTo(e.point)}b.sort(function(a,b){return a.distance-b.distance})};
$jscomp.global.Object.defineProperties(lib$potree$potree_clean$classdecl$var15.prototype,{showCoordinates:{configurable:!0,enumerable:!0,get:function(){return this._showCoordinates},set:function(a){this._showCoordinates=a;this.update()}},showAngles:{configurable:!0,enumerable:!0,get:function(){return this._showAngles},set:function(a){this._showAngles=a;this.update()}},showHeight:{configurable:!0,enumerable:!0,get:function(){return this._showHeight},set:function(a){this._showHeight=a;this.update()}},
showArea:{configurable:!0,enumerable:!0,get:function(){return this._showArea},set:function(a){this._showArea=a;this.update()}},closed:{configurable:!0,enumerable:!0,get:function(){return this._closed},set:function(a){this._closed=a;this.update()}},showDistances:{configurable:!0,enumerable:!0,get:function(){return this._showDistances},set:function(a){this._showDistances=a;this.update()}}});Potree.Measure=lib$potree$potree_clean$classdecl$var15;
Potree.Profile=function(){var a=THREE.Object3D.call(this)||this;a.constructor.counter=void 0===a.constructor.counter?0:a.constructor.counter+1;a.name='Profile_'+a.constructor.counter;a.points=[];a.spheres=[];a.edges=[];a.boxes=[];a.width=1;a.height=20;a._modifiable=!0;a.sphereGeometry=new THREE.SphereGeometry(.4,10,10);a.color=new THREE.Color(16711680);a.lineColor=new THREE.Color(16711680);return a};$jscomp.inherits(Potree.Profile,THREE.Object3D);
Potree.Profile.prototype.createSphereMaterial=function(){return new THREE.MeshLambertMaterial({shading:THREE.SmoothShading,color:16711680,depthTest:!1,depthWrite:!1})};Potree.Profile.prototype.getSegments=function(){for(var a=[],b=0;b<this.points.length-1;b++){var c=this.points[b].clone(),e=this.points[b+1].clone();a.push({start:c,end:e})}return a};
Potree.Profile.prototype.getSegmentMatrices=function(){var a=this.getSegments(),b=[];a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var e=c.start,d=c.end;c=new THREE.Object3D;var f=e.clone().setZ(0).distanceTo(d.clone().setZ(0));c.scale.set(f,1E4,this.width);c.up.set(0,0,1);f=(new THREE.Vector3).addVectors(e,d).multiplyScalar(.5);e=(new THREE.Vector3).subVectors(d,e);e=new THREE.Vector3(e.y,-e.x,0);c.position.set(0,0,0);c.lookAt(e);c.position.copy(f);c.updateMatrixWorld();
b.push(c.matrixWorld)}return b};
Potree.Profile.prototype.addMarker=function(a){var b=this;this.points.push(a);var c=new THREE.Mesh(this.sphereGeometry,this.createSphereMaterial());this.add(c);this.spheres.push(c);if(1<this.points.length){var e=new THREE.Geometry;e.vertices.push(new THREE.Vector3,new THREE.Vector3);e.colors.push(this.lineColor,this.lineColor,this.lineColor);var d=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,linewidth:2,transparent:!0,opacity:.4});d.depthTest=!1;e=new THREE.Line(e,d);e.visible=!1;
this.add(e);this.edges.push(e);e=new THREE.BoxGeometry(1,1,1);d=new THREE.MeshBasicMaterial({color:16711680,transparent:!0,opacity:.2});e=new THREE.Mesh(e,d);e.visible=!1;this.add(e);this.boxes.push(e)}c.addEventListener('drag',function(a){var c=Potree.utils.getMousePointCloudIntersection(a.drag.end,a.viewer.scene.getActiveCamera(),a.viewer,a.viewer.scene.pointclouds);c&&(a=b.spheres.indexOf(a.drag.object),-1!==a&&b.setPosition(a,c.location))});c.addEventListener('drop',function(a){a=b.spheres.indexOf(a.drag.object);
-1!==a&&b.dispatchEvent({type:'marker_dropped',profile:b,index:a})});c.addEventListener('mouseover',function(a){return a.object.material.emissive.setHex(8947848)});c.addEventListener('mouseleave',function(a){return a.object.material.emissive.setHex(0)});this.dispatchEvent({type:'marker_added',profile:this,sphere:c});this.setPosition(this.points.length-1,a)};
Potree.Profile.prototype.removeMarker=function(a){this.points.splice(a,1);this.remove(this.spheres[a]);var b=0===a?0:a-1;this.remove(this.edges[b]);this.edges.splice(b,1);this.remove(this.boxes[b]);this.boxes.splice(b,1);this.spheres.splice(a,1);this.update();this.dispatchEvent({type:'marker_removed',profile:this})};Potree.Profile.prototype.setPosition=function(a,b){var c=this.points[a];c.copy(b);a={type:'marker_moved',profile:this,index:a,position:c.clone()};this.dispatchEvent(a);this.update()};
Potree.Profile.prototype.setWidth=function(a){this.width=a;this.dispatchEvent({type:'width_changed',profile:this,width:a});this.update()};Potree.Profile.prototype.getWidth=function(){return this.width};
Potree.Profile.prototype.update=function(){if(0!==this.points.length)if(1===this.points.length)this.spheres[0].position.copy(this.points[0]);else{for(var a=this.points[0].clone(),b=this.points[0].clone(),c=new THREE.Vector3,e=this.points.length-1,d=0;d<=e;d++){var f=this.points[d],g=this.spheres[d],h=0===d?e:d-1,l=this.points[h],k=this.edges[h],m=this.edges[d];h=this.boxes[h];g.position.copy(f);g.visible=this._modifiable?!0:!1;k&&(k.geometry.vertices[1].copy(f),k.geometry.verticesNeedUpdate=!0,k.geometry.computeBoundingSphere());
m&&(m.geometry.vertices[0].copy(f),m.geometry.verticesNeedUpdate=!0,m.geometry.computeBoundingSphere());h&&(k=f,g=l.clone().setZ(0).distanceTo(k.clone().setZ(0)),h.scale.set(g,1E6,this.width),h.up.set(0,0,1),g=(new THREE.Vector3).addVectors(l,k).multiplyScalar(.5),l=(new THREE.Vector3).subVectors(k,l),l=new THREE.Vector3(l.y,-l.x,0),h.position.set(0,0,0),h.lookAt(l),h.position.copy(g));c.add(f);a.min(f);b.max(f)}c.multiplyScalar(1/this.points.length);for(c=0;c<this.boxes.length;c++)this.boxes[c].position.z=
a.z+(b.z-a.z)/2}};Potree.Profile.prototype.raycast=function(a,b){for(var c=0;c<this.points.length;c++)this.spheres[c].raycast(a,b);for(c=0;c<b.length;c++){var e=b[c];e.distance=a.ray.origin.distanceTo(e.point)}b.sort(function(a,b){return a.distance-b.distance})};$jscomp.global.Object.defineProperties(Potree.Profile.prototype,{modifiable:{configurable:!0,enumerable:!0,get:function(){return this._modifiable},set:function(a){this._modifiable=a;this.update()}}});
Potree.Volume=function(a){a=void 0===a?{}:a;var b=THREE.Object3D.call(this)||this;b._clip=a.clip||!1;b._visible=!0;b.showVolumeLabel=!0;b._modifiable=a.modifiable||!0;b.label=new Potree.TextSprite('0');b.label.setBorderColor({r:0,g:255,b:0,a:0});b.label.setBackgroundColor({r:0,g:255,b:0,a:0});b.label.material.depthTest=!1;b.label.material.depthWrite=!1;b.label.material.transparent=!0;b.label.position.y-=.5;b.add(b.label);b.label.updateMatrixWorld=function(){var a=new THREE.Vector3;a.setFromMatrixPosition(b.matrixWorld);
b.label.position.copy(a);b.label.updateMatrix();b.label.matrixWorld.copy(b.label.matrix);b.label.matrixWorldNeedsUpdate=!1;a=0;for(var e=b.label.children.length;a<e;a++)b.label.children[a].updateMatrixWorld(!0)};b.addEventListener('select',function(a){});b.addEventListener('deselect',function(a){});return b};$jscomp.inherits(Potree.Volume,THREE.Object3D);Potree.Volume.prototype.getVolume=function(){console.warn('override this in subclass')};Potree.Volume.prototype.update=function(){};
Potree.Volume.prototype.raycast=function(a,b){};
$jscomp.global.Object.defineProperties(Potree.Volume.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.dispatchEvent({type:'visibility_changed',object:this}))}},clip:{configurable:!0,enumerable:!0,get:function(){return this._clip},set:function(a){this._clip!==a&&(this._clip=a,this.update(),this.dispatchEvent({type:'clip_changed',object:this}))}},modifieable:{configurable:!0,enumerable:!0,get:function(){return this._modifiable},
set:function(a){this._modifiable=a;this.update()}}});
var lib$potree$potree_clean$classdecl$var16=function(a){a=void 0===a?{}:a;a=Potree.Volume.call(this,a)||this;a.constructor.counter=void 0===a.constructor.counter?0:a.constructor.counter+1;a.name='box_'+a.constructor.counter;var b=new THREE.BoxGeometry(1,1,1);b.computeBoundingBox();var c=new THREE.Geometry;c.vertices.push(new THREE.Vector3(-.5,-.5,.5));c.vertices.push(new THREE.Vector3(.5,-.5,.5));c.vertices.push(new THREE.Vector3(.5,-.5,.5));c.vertices.push(new THREE.Vector3(.5,-.5,-.5));c.vertices.push(new THREE.Vector3(.5,
-.5,-.5));c.vertices.push(new THREE.Vector3(-.5,-.5,-.5));c.vertices.push(new THREE.Vector3(-.5,-.5,-.5));c.vertices.push(new THREE.Vector3(-.5,-.5,.5));c.vertices.push(new THREE.Vector3(-.5,.5,.5));c.vertices.push(new THREE.Vector3(.5,.5,.5));c.vertices.push(new THREE.Vector3(.5,.5,.5));c.vertices.push(new THREE.Vector3(.5,.5,-.5));c.vertices.push(new THREE.Vector3(.5,.5,-.5));c.vertices.push(new THREE.Vector3(-.5,.5,-.5));c.vertices.push(new THREE.Vector3(-.5,.5,-.5));c.vertices.push(new THREE.Vector3(-.5,
.5,.5));c.vertices.push(new THREE.Vector3(-.5,-.5,.5));c.vertices.push(new THREE.Vector3(-.5,.5,.5));c.vertices.push(new THREE.Vector3(.5,-.5,.5));c.vertices.push(new THREE.Vector3(.5,.5,.5));c.vertices.push(new THREE.Vector3(.5,-.5,-.5));c.vertices.push(new THREE.Vector3(.5,.5,-.5));c.vertices.push(new THREE.Vector3(-.5,-.5,-.5));c.vertices.push(new THREE.Vector3(-.5,.5,-.5));a.material=new THREE.MeshBasicMaterial({color:65280,transparent:!0,opacity:.3,depthTest:!0,depthWrite:!1});a.box=new THREE.Mesh(b,
a.material);a.box.geometry.computeBoundingBox();a.boundingBox=a.box.geometry.boundingBox;a.add(a.box);a.frame=new THREE.LineSegments(c,new THREE.LineBasicMaterial({color:0}));a.add(a.frame);a.update();return a};$jscomp.inherits(lib$potree$potree_clean$classdecl$var16,Potree.Volume);
lib$potree$potree_clean$classdecl$var16.prototype.update=function(){this.boundingBox=this.box.geometry.boundingBox;this.boundingSphere=this.boundingBox.getBoundingSphere(new THREE.Sphere);this._clip?(this.box.visible=!1,this.label.visible=!1):(this.box.visible=!0,this.label.visible=this.showVolumeLabel)};lib$potree$potree_clean$classdecl$var16.prototype.raycast=function(a,b){var c=[];this.box.raycast(a,c);0<c.length&&(a=c[0],b.push({distance:a.distance,object:this,point:a.point.clone()}))};
lib$potree$potree_clean$classdecl$var16.prototype.getVolume=function(){return Math.abs(this.scale.x*this.scale.y*this.scale.z)};Potree.BoxVolume=lib$potree$potree_clean$classdecl$var16;
var lib$potree$potree_clean$classdecl$var17=function(a){a=void 0===a?{}:a;a=Potree.Volume.call(this,a)||this;a.constructor.counter=void 0===a.constructor.counter?0:a.constructor.counter+1;a.name='sphere_'+a.constructor.counter;var b=new THREE.SphereGeometry(1,32,32);b.computeBoundingBox();a.material=new THREE.MeshBasicMaterial({color:65280,transparent:!0,opacity:.3,depthTest:!0,depthWrite:!1});a.sphere=new THREE.Mesh(b,a.material);a.sphere.visible=!1;a.sphere.geometry.computeBoundingBox();a.boundingBox=
a.sphere.geometry.boundingBox;a.add(a.sphere);a.label.visible=!1;for(var c=new THREE.Geometry,e=0;8>e;e++){var d=e/8*Math.PI*2,f=Math.cos(d);d=Math.sin(d);for(var g=0;64>=g;g++){var h=g/64*Math.PI*2,l=h+2*Math.PI/64,k=Math.cos(h),m=Math.sin(l);l=Math.cos(l);h=new THREE.Vector3(f*k,d*k,Math.sin(h));c.vertices.push(h);m=new THREE.Vector3(f*l,d*l,m);c.vertices.push(m)}}for(e=0;6>=e;e++)for(d=e/6,d=-Math.PI/2*(1-d)+Math.PI/2*d,f=Math.sin(d),console.log(d,f),d=0;64>=d;d++)m=d/64*Math.PI*2,h=m+2*Math.PI/
64,g=Math.cos(h),h=Math.sin(h),k=Math.sqrt(1-f*f),m=new THREE.Vector3(Math.cos(m)*k,Math.sin(m)*k,f),c.vertices.push(m),g=new THREE.Vector3(g*k,h*k,f),c.vertices.push(g);a.frame=new THREE.LineSegments(c,new THREE.LineBasicMaterial({color:0}));a.add(a.frame);c=new THREE.MeshBasicMaterial({wireframe:!0,color:0});a.frame=new THREE.Mesh(b,c);a.update();return a};$jscomp.inherits(lib$potree$potree_clean$classdecl$var17,Potree.Volume);
lib$potree$potree_clean$classdecl$var17.prototype.update=function(){this.boundingBox=this.sphere.geometry.boundingBox;this.boundingSphere=this.boundingBox.getBoundingSphere(new THREE.Sphere)};lib$potree$potree_clean$classdecl$var17.prototype.raycast=function(a,b){var c=[];this.sphere.raycast(a,c);0<c.length&&(a=c[0],b.push({distance:a.distance,object:this,point:a.point.clone()}))};lib$potree$potree_clean$classdecl$var17.prototype.getVolume=function(){return 4/3*Math.PI*this.scale.x*this.scale.y*this.scale.z};
Potree.SphereVolume=lib$potree$potree_clean$classdecl$var17;
Potree.PolygonClipVolume=function(a){var b=THREE.Object3D.call(this)||this;b.constructor.counter=void 0===b.constructor.counter?0:b.constructor.counter+1;b.name='polygon_clip_volume_'+b.constructor.counter;b.camera=a.clone();b.camera.rotation.set.apply(b.camera.rotation,$jscomp.arrayFromIterable(a.rotation.toArray()));b.camera.updateMatrixWorld();b.camera.updateProjectionMatrix();b.camera.matrixWorldInverse.getInverse(b.camera.matrixWorld);b.viewMatrix=b.camera.matrixWorldInverse.clone();b.projMatrix=
b.camera.projectionMatrix.clone();b.markers=[];b.initialized=!1;return b};$jscomp.inherits(Potree.PolygonClipVolume,THREE.Object3D);
Potree.PolygonClipVolume.prototype.addMarker=function(){var a=new THREE.Mesh,b=function(b){var c=b.viewer.renderer.getSize(new THREE.Vector3);b=new THREE.Vector3(b.drag.end.x/c.width*2-1,b.drag.end.y/c.height*-2+1,0);a.position.copy(b)},c=function(a){e()};var e=function(d){a.removeEventListener('drag',b);a.removeEventListener('drop',c)};a.addEventListener('drag',b);a.addEventListener('drop',c);this.markers.push(a)};
Potree.PolygonClipVolume.prototype.removeLastMarker=function(){0<this.markers.length&&this.markers.splice(this.markers.length-1,1)};
var lib$potree$potree_clean$classdecl$var18=function(a,b){void 0===b&&(b=16776960);var c=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),e=new Float32Array([a.min.x,a.min.y,a.min.z,a.max.x,a.min.y,a.min.z,a.max.x,a.min.y,a.max.z,a.min.x,a.min.y,a.max.z,a.min.x,a.max.y,a.min.z,a.max.x,a.max.y,a.min.z,a.max.x,a.max.y,a.max.z,a.min.x,a.max.y,a.max.z]);a=new THREE.BufferGeometry;a.setIndex(new THREE.BufferAttribute(c,1));a.addAttribute('position',new THREE.BufferAttribute(e,3));b=new THREE.LineBasicMaterial({color:b});
return THREE.LineSegments.call(this,a,b)||this};$jscomp.inherits(lib$potree$potree_clean$classdecl$var18,THREE.LineSegments);Potree.Box3Helper=lib$potree$potree_clean$classdecl$var18;
var lib$potree$potree_clean$classdecl$var19=function(a){this.potreeRenderer=a;this.threeRenderer=this.potreeRenderer.threeRenderer;this.target=new THREE.WebGLRenderTarget(2048,2048,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,type:THREE.FloatType});this.target.depthTexture=new THREE.DepthTexture;this.target.depthTexture.type=THREE.UnsignedIntType;this.threeRenderer.setClearColor(0,1);this.threeRenderer.clearTarget(this.target,!0,!0,!0)};
lib$potree$potree_clean$classdecl$var19.prototype.setLight=function(a){this.light=a;this.camera=new THREE.PerspectiveCamera(180*a.angle/Math.PI,a.shadow.mapSize.width/a.shadow.mapSize.height,.1,0===a.distance?1E4:a.distance);this.camera.up.set(0,0,1);this.camera.position.copy(a.position);a=(new THREE.Vector3).addVectors(a.position,a.getWorldDirection(Potree.tempVector3));this.camera.lookAt(a);this.camera.updateProjectionMatrix();this.camera.updateMatrix();this.camera.updateMatrixWorld();this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld)};
lib$potree$potree_clean$classdecl$var19.prototype.setSize=function(a,b){this.target.width===a&&this.target.height===b||this.target.dispose();this.target.setSize(a,b)};lib$potree$potree_clean$classdecl$var19.prototype.render=function(a,b){this.threeRenderer.clearTarget(this.target,!0,!0,!0);this.potreeRenderer.render(a,this.camera,this.target,{})};Potree.PointCloudSM=lib$potree$potree_clean$classdecl$var19;var lib$potree$potree_clean$classdecl$var20=function(){};
lib$potree$potree_clean$classdecl$var20.measurementToFeatures=function(a){var b=a.points.map(function(a){return a.position.toArray()}),c=[];1===b.length?c.push({type:'Feature',geometry:{type:'Point',coordinates:b[0]},properties:{name:a.name}}):1<b.length&&!a.closed?c.push({type:'Feature',geometry:{type:'LineString',coordinates:b},properties:{name:a.name}}):1<b.length&&a.closed&&(b={type:'Feature',geometry:{type:'Polygon',coordinates:[[].concat($jscomp.arrayFromIterable(b),[b[0]])]},properties:{name:a.name}},
c.push(b));a.showDistances&&a.edgeLabels.forEach(function(a){a={type:'Feature',geometry:{type:'Point',coordinates:a.position.toArray()},properties:{distance:a.text}};c.push(a)});a.showArea&&(a={type:'Feature',geometry:{type:'Point',coordinates:a.areaLabel.position.toArray()},properties:{area:a.areaLabel.text}},c.push(a));return c};
lib$potree$potree_clean$classdecl$var20.toString=function(a){a instanceof Array||(a=[a]);a=a.filter(function(a){return a instanceof Potree.Measure});var b=[];a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())c=Potree.GeoJSONExporter.measurementToFeatures(c.value),b=b.concat(c);return JSON.stringify({type:'FeatureCollection',features:b},null,'\t')};Potree.GeoJSONExporter=lib$potree$potree_clean$classdecl$var20;var lib$potree$potree_clean$classdecl$var21=function(){};
lib$potree$potree_clean$classdecl$var21.measurementPointSection=function(a){return(a=a.points[0].position)?'0\nCIRCLE\n8\nlayer_point\n10\n'+a.x+'\n20\n'+a.y+'\n30\n'+a.z+'\n40\n1.0\n':''};
lib$potree$potree_clean$classdecl$var21.measurementPolylineSection=function(a){var b=8;a.closed&&(b+=1);b='0\nPOLYLINE\n8\nlayer_polyline\n62\n1\n66\n1\n10\n0.0\n20\n0.0\n30\n0.0\n70\n'+b+'\n';a=$jscomp.makeIterator(a.points);for(var c=a.next();!c.done;c=a.next())c=c.value,c=c.position,b+='0\nVERTEX\n8\n0\n10\n'+c.x+'\n20\n'+c.y+'\n30\n'+c.z+'\n70\n32\n';return b+'0\nSEQEND\n'};
lib$potree$potree_clean$classdecl$var21.measurementSection=function(a){if(0===a.points.length)return'';if(1===a.points.length)return Potree.DXFExporter.measurementPointSection(a);if(2<=a.points.length)return Potree.DXFExporter.measurementPolylineSection(a)};
lib$potree$potree_clean$classdecl$var21.toString=function(a){a instanceof Array||(a=[a]);a=a.filter(function(a){return a instanceof Potree.Measure});var b=a.filter(function(a){return a instanceof Potree.Measure}).map(function(a){return a.points}).reduce(function(a,b){return a.concat(b)}).map(function(a){return a.position}),c=new THREE.Vector3(Infinity,Infinity,Infinity),e=new THREE.Vector3(-Infinity,-Infinity,-Infinity);b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next())d=d.value,c.min(d),
e.max(d);c='999\nDXF created from potree\n0\nSECTION\n2\nHEADER\n9\n$ACADVER\n1\nAC1006\n9\n$INSBASE\n10\n0.0\n20\n0.0\n30\n0.0\n9\n$EXTMIN\n10\n'+c.x+'\n20\n'+c.y+'\n30\n'+c.z+'\n9\n$EXTMAX\n10\n'+e.x+'\n20\n'+e.y+'\n30\n'+e.z+'\n0\nENDSEC\n';e='0\nSECTION\n2\nENTITIES\n';a=$jscomp.makeIterator(a);for(b=a.next();!b.done;b=a.next())e+=Potree.DXFExporter.measurementSection(b.value);return c+(e+'0\nENDSEC\n')+'0\nEOF'};Potree.DXFExporter=lib$potree$potree_clean$classdecl$var21;
var lib$potree$potree_clean$classdecl$var22=function(){};
lib$potree$potree_clean$classdecl$var22.toString=function(a){var b='',c=Object.keys(a.data).filter(function(a){return'normal'!==a}).sort(function(a,b){if('position'===a)return-1;if('position'===b)return 1;if('color'===a)return-1;if('color'===b)return 1});b=[];for(var e=$jscomp.makeIterator(c),d=e.next();!d.done;d=e.next()){var f=d.value,g=a.data[f].length/a.numPoints;if('position'===f)b=b.concat(['x','y','z']);else if('color'===f)b=b.concat(['r','g','b','a']);else if(1<g)for(d=0;d<g;d++)b.push(f+
'_'+d);else b.push(f)}b=b.join(', ')+'\n';for(e=0;e<a.numPoints;e++){f=[];g=$jscomp.makeIterator(c);for(d=g.next();!d.done;d=g.next()){d=d.value;var h=a.data[d].length/a.numPoints;d=a.data[d].subarray(h*e,h*e+h).join(', ');f.push(d)}b+=f.join(', ')+'\n'}return b};Potree.CSVExporter=lib$potree$potree_clean$classdecl$var22;var lib$potree$potree_clean$classdecl$var23=function(){};
lib$potree$potree_clean$classdecl$var23.toLAS=function(a){var b=a.boundingBox,c=b.min.clone(),e=b.min.distanceTo(b.max),d=new THREE.Vector3(.001,.001,.001);d=1E6<e?new THREE.Vector3(.01,.01,.01):new THREE.Vector3(.001,.001,.001);var f=function(a,b,c){c=new Uint8Array(c);for(var d=0;d<a.length;d++){var e=a.charCodeAt(d);c[b+d]=e}};e=new ArrayBuffer(227+28*a.numPoints);var g=new DataView(e),h=new Uint8Array(e);f('LASF',0,e);h[24]=1;h[25]=2;f('Potree 1.5',58,e);g.setUint16(94,227,!0);g.setUint32(96,
227,!0);h[104]=2;g.setUint16(105,28,!0);g.setUint32(107,a.numPoints,!0);g.setFloat64(131,d.x,!0);g.setFloat64(139,d.y,!0);g.setFloat64(147,d.z,!0);g.setFloat64(155,c.x,!0);g.setFloat64(163,c.y,!0);g.setFloat64(171,c.z,!0);g.setFloat64(179,b.max.x,!0);g.setFloat64(187,b.min.x,!0);g.setFloat64(195,b.max.y,!0);g.setFloat64(203,b.min.y,!0);g.setFloat64(211,b.max.z,!0);g.setFloat64(219,b.min.z,!0);b=227;for(f=0;f<a.numPoints;f++){var l=a.data.position[3*f+1],k=a.data.position[3*f+2];h=parseInt((a.data.position[3*
f]-c.x)/d.x);l=parseInt((l-c.y)/d.y);k=parseInt((k-c.z)/d.z);g.setUint32(b+0,h,!0);g.setUint32(b+4,l,!0);g.setUint32(b+8,k,!0);a.data.intensity&&g.setUint16(b+12,a.data.intensity[f],!0);h=0;a.data.returnNumber&&(h+=a.data.returnNumber[f]);a.data.numberOfReturns&&(h+=a.data.numberOfReturns[f]<<3);g.setUint8(b+14,h);a.data.classification&&g.setUint8(b+15,a.data.classification[f]);a.data.pointSourceID&&g.setUint16(b+18,a.data.pointSourceID[f]);a.data.color&&(g.setUint16(b+20,255*a.data.color[4*f],!0),
g.setUint16(b+22,255*a.data.color[4*f+1],!0),g.setUint16(b+24,255*a.data.color[4*f+2],!0));b+=28}return e};Potree.LASExporter=lib$potree$potree_clean$classdecl$var23;var lib$potree$potree_clean$classdecl$var24=function(){Potree.PointCloudTreeNode.call(this);this.kdtree=this.sceneNode=this.right=this.left=null};$jscomp.inherits(lib$potree$potree_clean$classdecl$var24,Potree.PointCloudTreeNode);lib$potree$potree_clean$classdecl$var24.prototype.getNumPoints=function(){return this.geometryNode.numPoints};
lib$potree$potree_clean$classdecl$var24.prototype.isLoaded=function(){return!0};lib$potree$potree_clean$classdecl$var24.prototype.isTreeNode=function(){return!0};lib$potree$potree_clean$classdecl$var24.prototype.isGeometryNode=function(){return!1};lib$potree$potree_clean$classdecl$var24.prototype.getLevel=function(){return this.geometryNode.level};lib$potree$potree_clean$classdecl$var24.prototype.getBoundingSphere=function(){return this.geometryNode.boundingSphere};
lib$potree$potree_clean$classdecl$var24.prototype.getBoundingBox=function(){return this.geometryNode.boundingBox};lib$potree$potree_clean$classdecl$var24.prototype.toTreeNode=function(a){var b=null;this.left===a?b=this.left:this.right===a&&(b=this.right);if(b.loaded){a=new Potree.PointCloudArena4DNode;var c=THREE.PointCloud(b.geometry,this.kdtree.material);c.visible=!1;a.kdtree=this.kdtree;a.geometryNode=b;a.sceneNode=c;a.parent=this;a.left=this.geometryNode.left;a.right=this.geometryNode.right}};
lib$potree$potree_clean$classdecl$var24.prototype.getChildren=function(){var a=[];this.left&&a.push(this.left);this.right&&a.push(this.right);return a};Potree.PointCloudArena4DNode=lib$potree$potree_clean$classdecl$var24;
var lib$potree$potree_clean$classdecl$var25=function(a){var b=Potree.PointCloudTree.call(this)||this;b.root=null;a.root?b.root=a.root:a.addEventListener('hierarchy_loaded',function(){b.root=a.root});b.visiblePointsTarget=2E6;b.minimumNodePixelSize=150;b.position.sub(a.offset);b.updateMatrix();b.numVisibleNodes=0;b.numVisiblePoints=0;b.boundingBoxNodes=[];b.loadQueue=[];b.visibleNodes=[];b.pcoGeometry=a;b.boundingBox=b.pcoGeometry.boundingBox;b.boundingSphere=b.pcoGeometry.boundingSphere;b.material=
new Potree.PointCloudMaterial({vertexColors:THREE.VertexColors,size:.05,treeType:Potree.TreeType.KDTREE});b.material.sizeType=Potree.PointSizeType.ATTENUATED;b.material.size=.05;b.profileRequests=[];b.name='';return b};$jscomp.inherits(lib$potree$potree_clean$classdecl$var25,Potree.PointCloudTree);lib$potree$potree_clean$classdecl$var25.prototype.getBoundingBoxWorld=function(){this.updateMatrixWorld(!0);return Potree.utils.computeTransformedBoundingBox(this.boundingBox,this.matrixWorld)};
lib$potree$potree_clean$classdecl$var25.prototype.setName=function(a){this.name!==a&&(this.name=a,this.dispatchEvent({type:'name_changed',name:a,pointcloud:this}))};lib$potree$potree_clean$classdecl$var25.prototype.getName=function(){return this.name};lib$potree$potree_clean$classdecl$var25.prototype.getLevel=function(){return this.level};
lib$potree$potree_clean$classdecl$var25.prototype.toTreeNode=function(a,b){var c=this,e=new Potree.PointCloudArena4DNode,d=new THREE.Points(a.geometry,this.material);d.frustumCulled=!1;d.onBeforeRender=function(b,d,h,l,k,m){k.program&&(b.getContext().useProgram(k.program.program),k.program.getUniforms().map.level&&(d=a.getLevel(),k.uniforms.level.value=d,k.program.getUniforms().map.level.setValue(b.getContext(),d)),c.visibleNodeTextureOffsets&&k.program.getUniforms().map.vnStart&&(d=c.visibleNodeTextureOffsets.get(e),
k.uniforms.vnStart.value=d,k.program.getUniforms().map.vnStart.setValue(b.getContext(),d)),k.program.getUniforms().map.pcIndex&&(d=e.pcIndex?e.pcIndex:c.visibleNodes.indexOf(e),k.uniforms.pcIndex.value=d,k.program.getUniforms().map.pcIndex.setValue(b.getContext(),d)))};e.geometryNode=a;e.sceneNode=d;e.pointcloud=this;e.left=a.left;e.right=a.right;b?(b.sceneNode.add(d),b.left===a?b.left=e:b.right===a&&(b.right=e)):(this.root=e,this.add(d));a.oneTimeDisposeHandlers.push(function(){b.sceneNode.remove(e.sceneNode);
b.left===e?b.left=a:b.right===e&&(b.right=a)});return e};lib$potree$potree_clean$classdecl$var25.prototype.updateMaterial=function(a,b,c,e){a.fov=Math.PI/180*c.fov;a.screenWidth=e.domElement.clientWidth;a.screenHeight=e.domElement.clientHeight;a.spacing=this.pcoGeometry.spacing;a.near=c.near;a.far=c.far;this.maxLevel>a.levels&&(a.levels=this.maxLevel+2);b=this.boundingBox.getSize(new THREE.Vector3);a.bbSize=[b.x,b.y,b.z]};lib$potree$potree_clean$classdecl$var25.prototype.updateVisibleBounds=function(){};
lib$potree$potree_clean$classdecl$var25.prototype.hideDescendants=function(a){for(var b=[],c=0;c<a.children.length;c++){var e=a.children[c];e.visible&&b.push(e)}for(;0<b.length;)for(a=b.shift(),a.visible=!1,a.boundingBoxNode&&(a.boundingBoxNode.visible=!1),c=0;c<a.children.length;c++)e=a.children[c],e.visible&&b.push(e)};
lib$potree$potree_clean$classdecl$var25.prototype.updateMatrixWorld=function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1};
lib$potree$potree_clean$classdecl$var25.prototype.nodesOnRay=function(a,b){var c=[];b=b.clone();for(var e=0;e<a.length;e++){var d=a[e],f=d.getBoundingSphere(new THREE.Sphere).clone().applyMatrix4(d.sceneNode.matrixWorld);b.intersectsSphere(f)&&c.push(d)}return c};
lib$potree$potree_clean$classdecl$var25.prototype.pick=function(a,b,c,e){e=void 0===e?{}:e;var d=a.renderer,f=a.pRenderer;performance.mark('pick-start');var g=function(a,b){return void 0!==a?a:b};a=g(e.pickWindowSize,17);g(e.pickOutsideClipRegion,!1);var h=d.getSize(new THREE.Vector3),l=Math.ceil(g(e.width,h.width));h=Math.ceil(g(e.height,h.height));var k=g(e.pointSizeType,this.material.pointSizeType);g=g(e.pointSize,this.material.size);c=this.nodesOnRay(this.visibleNodes,c);if(0===c.length)return null;
if(!this.pickState){var m=new THREE.Scene,p=new Potree.PointCloudMaterial;p.pointColorType=Potree.PointColorType.POINT_INDEX;this.pickState={renderTarget:new THREE.WebGLRenderTarget(1,1,{minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat}),material:p,scene:m}}m=this.pickState;p=m.material;p.pointSizeType=k;p.shape=this.material.shape;p.size=g;p.uniforms.minSize.value=this.material.uniforms.minSize.value;p.uniforms.maxSize.value=this.material.uniforms.maxSize.value;
p.classification=this.material.classification;e.pickClipped?(p.clipBoxes=this.material.clipBoxes,p.clipTask=this.material.clipTask===Potree.ClipTask.HIGHLIGHT?Potree.ClipTask.NONE:this.material.clipTask):p.clipBoxes=[];this.updateMaterial(p,c,b,d);m.renderTarget.setSize(l,h);g=new THREE.Vector2(e.x,e.y);k=d.getContext();k.enable(k.SCISSOR_TEST);k.scissor(parseInt(g.x-(a-1)/2),parseInt(g.y-(a-1)/2),parseInt(a),parseInt(a));d.state.buffers.depth.setTest(p.depthTest);d.state.buffers.depth.setMask(p.depthWrite);
d.state.setBlending(THREE.NoBlending);d.clearTarget(m.renderTarget,!0,!0,!0);d.setRenderTarget(m.renderTarget);k.clearColor(0,0,0,0);d.clearTarget(m.renderTarget,!0,!0,!0);var n=this.material;this.material=p;f.renderOctree(this,c,b,m.renderTarget);this.material=n;b=parseInt(Math.min(Math.max(0,g.x-(a-1)/2),l));f=parseInt(Math.min(Math.max(0,g.y-(a-1)/2),h));l=parseInt(Math.min(b+a,l)-b);h=parseInt(Math.min(f+a,h)-f);l=new Uint8Array(4*l*h);k.readPixels(b,f,a,a,k.RGBA,k.UNSIGNED_BYTE,l);d.setRenderTarget(null);
d.resetGLState();d.setScissorTest(!1);k.disable(k.SCISSOR_TEST);h=new Uint32Array(l.buffer);d=[];for(b=0;b<a;b++)for(f=0;f<a;f++)m=b+f*a,k=Math.pow(b-(a-1)/2,2)+Math.pow(f-(a-1)/2,2),g=l[4*m+3],l[4*m+3]=0,m=h[m],0===g&&0===m||void 0===g||void 0===m||(g={pIndex:m,pcIndex:g,distanceToCenter:k},e.all?d.push(g):0<d.length?k<d[0].distanceToCenter&&(d[0]=g):d.push(g));a=$jscomp.makeIterator(d);for(l=a.next();!l.done;l=a.next()){l=l.value;h={};if(!c[l.pcIndex])return null;f=c[l.pcIndex];b=f.sceneNode;f=
f.geometryNode.geometry;for(var r in f.attributes)k=f.attributes[r],'position'===r&&(k=new THREE.Vector3(k.array[3*l.pIndex],k.array[3*l.pIndex+1],k.array[3*l.pIndex+2]),k.applyMatrix4(b.matrixWorld),h[r]=k);l.point=h}performance.mark('pick-end');performance.measure('pick','pick-start','pick-end');return e.all?d.map(function(a){return a.point}):0===d.length?null:d[0].point};
lib$potree$potree_clean$classdecl$var25.prototype.computeVisibilityTextureData=function(a){Potree.measureTimings&&performance.mark('computeVisibilityTextureData-start');var b=new Uint8Array(3*a.length),c=new Map;a=a.slice();a.sort(function(a,b){var c=a.geometryNode.level,d=b.geometryNode.level;a=a.geometryNode.number;b=b.geometryNode.number;return c!==d?c-d:a<b?-1:a>b?1:0});for(var e=[],d=0;d<a.length;d++)e.push(a[d].geometryNode.number);for(d=0;d<a.length;d++){var f=a[d];c.set(f,d);var g=0,h=0,l=
0;f.geometryNode.left&&0<e.indexOf(f.geometryNode.left.number)&&(g+=1,h=e.indexOf(f.geometryNode.left.number)-d);f.geometryNode.right&&0<e.indexOf(f.geometryNode.right.number)&&(g+=2,h=0===h?e.indexOf(f.geometryNode.right.number)-d:h);'X'===f.geometryNode.split?l=1:'Y'===f.geometryNode.split?l=2:'Z'===f.geometryNode.split&&(l=4);b[3*d]=g;b[3*d+1]=h;b[3*d+2]=l}Potree.measureTimings&&(performance.mark('computeVisibilityTextureData-end'),performance.measure('render.computeVisibilityTextureData','computeVisibilityTextureData-start',
'computeVisibilityTextureData-end'));return{data:b,offsets:c}};$jscomp.global.Object.defineProperties(lib$potree$potree_clean$classdecl$var25.prototype,{progress:{configurable:!0,enumerable:!0,get:function(){return this.pcoGeometry.root?0<Potree.numNodesLoading?0:1:0}}});Potree.PointCloudArena4D=lib$potree$potree_clean$classdecl$var25;
var lib$potree$potree_clean$classdecl$var26=function(){this.pcoGeometry=this.number=this.boundingBox=this.right=this.left=null;this.loaded=!1;this.level=this.numPoints=0;this.children=[];this.oneTimeDisposeHandlers=[]};lib$potree$potree_clean$classdecl$var26.prototype.isGeometryNode=function(){return!0};lib$potree$potree_clean$classdecl$var26.prototype.isTreeNode=function(){return!1};lib$potree$potree_clean$classdecl$var26.prototype.isLoaded=function(){return this.loaded};
lib$potree$potree_clean$classdecl$var26.prototype.getBoundingSphere=function(){return this.boundingSphere};lib$potree$potree_clean$classdecl$var26.prototype.getBoundingBox=function(){return this.boundingBox};lib$potree$potree_clean$classdecl$var26.prototype.getChildren=function(){var a=[];this.left&&a.push(this.left);this.right&&a.push(this.right);return a};lib$potree$potree_clean$classdecl$var26.prototype.getLevel=function(){return this.level};
lib$potree$potree_clean$classdecl$var26.prototype.load=function(){if(!(this.loaded||this.loading||Potree.numNodesLoading>=Potree.maxNodesLoading)){this.loading=!0;Potree.numNodesLoading++;var a=this.pcoGeometry.url+'?node='+this.number,b=Potree.XHRFactory.createXMLHttpRequest();b.open('GET',a,!0);b.responseType='arraybuffer';var c=this;b.onreadystatechange=function(){if(4===b.readyState&&200===b.status){var a=b.response,d=new DataView(a);a=a.byteLength/17;var f=new ArrayBuffer(28*a);new DataView(f);
f=new Float32Array(3*a);for(var g=new Uint8Array(4*a),h=new Float32Array(a),l=new Uint8Array(a),k=new ArrayBuffer(4*a),m=new Uint32Array(k),p=new THREE.Box3,n=0;n<a;n++){var r=d.getFloat32(17*n,!0)+c.boundingBox.min.x,t=d.getFloat32(17*n+4,!0)+c.boundingBox.min.y,q=d.getFloat32(17*n+8,!0)+c.boundingBox.min.z,u=d.getUint8(17*n+12,!0),z=d.getUint8(17*n+13,!0),A=d.getUint8(17*n+14,!0),w=d.getUint8(17*n+15,!0),v=d.getUint8(17*n+16,!0);p.expandByPoint(new THREE.Vector3(r,t,q));f[3*n]=r;f[3*n+1]=t;f[3*
n+2]=q;g[4*n]=u;g[4*n+1]=z;g[4*n+2]=A;g[4*n+3]=255;h[n]=w;l[n]=v;m[n]=n}d=new THREE.BufferGeometry;d.addAttribute('position',new THREE.BufferAttribute(f,3));d.addAttribute('color',new THREE.BufferAttribute(g,4,!0));d.addAttribute('intensity',new THREE.BufferAttribute(h,1));d.addAttribute('classification',new THREE.BufferAttribute(l,1));f=new THREE.BufferAttribute(new Uint8Array(k),4,!0);d.addAttribute('indices',f);c.geometry=d;c.numPoints=a;c.loaded=!0;c.loading=!1;Potree.numNodesLoading--}};b.send(null)}};
lib$potree$potree_clean$classdecl$var26.prototype.dispose=function(){if(this.geometry&&null!=this.parent){this.geometry.dispose();this.geometry=null;this.loaded=!1;for(var a=0;a<this.oneTimeDisposeHandlers.length;a++)(0,this.oneTimeDisposeHandlers[a])();this.oneTimeDisposeHandlers=[]}};lib$potree$potree_clean$classdecl$var26.prototype.getNumPoints=function(){return this.numPoints};Potree.PointCloudArena4DGeometryNode=lib$potree$potree_clean$classdecl$var26;
var lib$potree$potree_clean$classdecl$var27=function(){var a=THREE.EventDispatcher.call(this)||this;a.numPoints=0;a.version=0;a.boundingBox=null;a.numNodes=0;a.name=null;a.provider=null;a.url=null;a.root=null;a.levels=0;a._spacing=null;a.pointAttributes=new Potree.PointAttributes(['POSITION_CARTESIAN','COLOR_PACKED']);return a};$jscomp.inherits(lib$potree$potree_clean$classdecl$var27,THREE.EventDispatcher);
lib$potree$potree_clean$classdecl$var27.load=function(a,b){var c=Potree.XHRFactory.createXMLHttpRequest();c.open('GET',a+'?info',!0);c.onreadystatechange=function(){try{if(4===c.readyState&&200===c.status){var e=JSON.parse(c.responseText),d=new Potree.PointCloudArena4DGeometry;d.url=a;d.name=e.Name;d.provider=e.Provider;d.numNodes=e.Nodes;d.numPoints=e.Points;d.version=e.Version;d.boundingBox=new THREE.Box3((new THREE.Vector3).fromArray(e.BoundingBox.slice(0,3)),(new THREE.Vector3).fromArray(e.BoundingBox.slice(3,
6)));e.Spacing&&(d.spacing=e.Spacing);var f=d.boundingBox.min.clone().multiplyScalar(-1);d.boundingBox.min.add(f);d.boundingBox.max.add(f);d.offset=f;var g=d.boundingBox.getCenter(),h=d.boundingBox.getSize(new THREE.Vector3).length()/2;d.boundingSphere=new THREE.Sphere(g,h);d.loadHierarchy();b(d)}else 4===c.readyState&&b(null)}catch(l){console.error(l.message),b(null)}};c.send(null)};
lib$potree$potree_clean$classdecl$var27.prototype.loadHierarchy=function(){var a=this,b=this.url+'?tree',c=Potree.XHRFactory.createXMLHttpRequest();c.open('GET',b,!0);c.responseType='arraybuffer';c.onreadystatechange=function(){if(4===c.readyState&&200===c.status){var b=c.response,d=b.byteLength/3;b=new DataView(b);for(var f=[],g=null,h=0,l=0;l<d;l++){var k=b.getUint8(3*l,!0),m=0<(k&1),p=0<(k&2),n=0<(k&8),r=0<(k&16),t=null;0<(k&4)?t='X':n&&(t='Y');r&&(t='Z');k=new Potree.PointCloudArena4DGeometryNode;
k.hasLeft=m;k.hasRight=p;k.split=t;k.isLeaf=!m&&!p;k.number=l;k.left=null;k.right=null;k.pcoGeometry=a;k.level=f.length;h=Math.max(h,k.level);0<f.length?(m=f[f.length-1],k.boundingBox=m.boundingBox.clone(),p=m.boundingBox.getSize(new THREE.Vector3),m.hasLeft&&!m.left?(m.left=k,m.children.push(k),'X'===m.split?k.boundingBox.max.x=k.boundingBox.min.x+p.x/2:'Y'===m.split?k.boundingBox.max.y=k.boundingBox.min.y+p.y/2:'Z'===m.split&&(k.boundingBox.max.z=k.boundingBox.min.z+p.z/2),m=k.boundingBox.getCenter(),
p=k.boundingBox.getSize(new THREE.Vector3).length()/2,k.boundingSphere=new THREE.Sphere(m,p)):(m.right=k,m.children.push(k),'X'===m.split?k.boundingBox.min.x+=p.x/2:'Y'===m.split?k.boundingBox.min.y+=p.y/2:'Z'===m.split&&(k.boundingBox.min.z+=p.z/2),m=k.boundingBox.getCenter(),p=k.boundingBox.getSize(new THREE.Vector3).length()/2,k.boundingSphere=new THREE.Sphere(m,p))):(g=k,g.boundingBox=a.boundingBox.clone(),m=g.boundingBox.getCenter(),p=g.boundingBox.getSize(new THREE.Vector3).length()/2,g.boundingSphere=
new THREE.Sphere(m,p));m=k.boundingBox.getSize(new THREE.Vector3);k.spacing=(m.x+m.y+m.z)/3/75;k.estimatedSpacing=k.spacing;f.push(k);if(k.isLeaf)for(k=!1;!k&&0<f.length;)f.pop(),k=f[f.length-1],k=0<f.length&&k.hasRight&&null==k.right}a.root=g;a.levels=h;a.dispatchEvent({type:'hierarchy_loaded'})}};c.send(null)};
$jscomp.global.Object.defineProperties(lib$potree$potree_clean$classdecl$var27.prototype,{spacing:{configurable:!0,enumerable:!0,get:function(){if(this._spacing)return this._spacing;if(this.root)return this.root.spacing},set:function(a){this._spacing=a}}});Potree.PointCloudArena4DGeometry=lib$potree$potree_clean$classdecl$var27;var lib$potree$potree_clean$classdecl$var28=function(a,b){this.gl=a;this.material=b;this.program=a.createProgram();this.recompile()};
lib$potree$potree_clean$classdecl$var28.prototype.compileShader=function(a,b){var c=this.gl;a=c.createShader(a);c.shaderSource(a,b);c.compileShader(a);return c.getShaderParameter(a,c.COMPILE_STATUS)?a:(console.error('could not compile shader:'),c=c.getShaderInfoLog(a),console.error(c,b),null)};
lib$potree$potree_clean$classdecl$var28.prototype.recompile=function(){var a=this.gl,b=this.compileShader(a.VERTEX_SHADER,this.material.vertexShader),c=this.compileShader(a.FRAGMENT_SHADER,this.material.fragmentShader);if(null!==b&&null!==c){var e=this.program;a.attachShader(e,b);a.attachShader(e,c);a.linkProgram(e);if(a.getProgramParameter(e,a.LINK_STATUS)){a.detachShader(e,b);a.detachShader(e,c);a.deleteShader(b);a.deleteShader(c);a.useProgram(e);b={};c=a.getProgramParameter(e,a.ACTIVE_UNIFORMS);
for(var d=0;d<c;d++){var f=a.getActiveUniform(e,d).name,g=a.getUniformLocation(e,f);b[f]=g}this.uniforms=b}else console.error('could not compile/link program:'),console.error(this.material.vertexShader),console.error(this.material.fragmentShader)}};Potree.GLProgram=lib$potree$potree_clean$classdecl$var28;var lib$potree$potree_clean$classdecl$var29=function(a,b,c,e,d){this.name=a;this.bytes=b;this.numElements=c;this.normalized=d;this.type=e};Potree.InterleavedBufferAttribute=lib$potree$potree_clean$classdecl$var29;
var lib$potree$potree_clean$classdecl$var30=function(a,b,c){this.data=a;this.attributes=b;this.stride=b.reduce(function(a,b){return a+b.bytes},0);this.stride=4*Math.ceil(this.stride/4);this.numElements=c};lib$potree$potree_clean$classdecl$var30.prototype.offset=function(a){for(var b=0,c=$jscomp.makeIterator(this.attributes),e=c.next();!e.done;e=c.next()){e=e.value;if(e.name===a)return b;b+=e.bytes}return null};Potree.InterleavedBuffer=lib$potree$potree_clean$classdecl$var30;
Potree.toInterleavedBufferAttribute=function(a){var b=null;a.name===Potree.PointAttribute.POSITION_CARTESIAN.name?b=new Potree.InterleavedBufferAttribute('position',12,3,'FLOAT',!1):a.name===Potree.PointAttribute.COLOR_PACKED.name?b=new Potree.InterleavedBufferAttribute('color',4,4,'UNSIGNED_BYTE',!0):a.name===Potree.PointAttribute.INTENSITY.name?b=new Potree.InterleavedBufferAttribute('intensity',4,1,'FLOAT',!1):a.name===Potree.PointAttribute.CLASSIFICATION.name?b=new Potree.InterleavedBufferAttribute('classification',
4,1,'FLOAT',!1):a.name===Potree.PointAttribute.RETURN_NUMBER.name?b=new Potree.InterleavedBufferAttribute('returnNumber',4,1,'FLOAT',!1):a.name===Potree.PointAttribute.NUMBER_OF_RETURNS.name?b=new Potree.InterleavedBufferAttribute('numberOfReturns',4,1,'FLOAT',!1):a.name===Potree.PointAttribute.SOURCE_ID.name?b=new Potree.InterleavedBufferAttribute('pointSourceID',4,1,'FLOAT',!1):a.name===Potree.PointAttribute.NORMAL_SPHEREMAPPED.name?b=new Potree.InterleavedBufferAttribute('normal',12,3,'FLOAT',
!1):a.name===Potree.PointAttribute.NORMAL_OCT16.name?b=new Potree.InterleavedBufferAttribute('normal',12,3,'FLOAT',!1):a.name===Potree.PointAttribute.NORMAL.name&&(b=new Potree.InterleavedBufferAttribute('normal',12,3,'FLOAT',!1));return b};
var GeoTIFF=function(a){var b=function(a){for(var b=$jscomp.makeIterator(Object.keys(a)),c=b.next();!c.done;c=b.next())c=c.value,this[c]=a[c]};b.prototype.inspect=function(){return'Enum('+this.name+': '+this.value+')'};var c=function(a){this.object=a;for(var c=$jscomp.makeIterator(Object.keys(a)),d=c.next();!d.done;d=c.next()){d=d.value;var e=a[d];'object'===typeof e?e.name=d:e={name:d,value:e};this[d]=new b(e)}};c.prototype.fromValue=function(a){for(var b=$jscomp.makeIterator(Object.keys(this.object)),
c=b.next();!c.done;c=b.next())if(c=c.value,this[c].value===a)return this[c];throw Error('No enum for value: '+a);};var e=new c({LITTLE:'II',BIG:'MM'}),d=new c({BYTE:{value:1,bytes:1},ASCII:{value:2,bytes:1},SHORT:{value:3,bytes:2},LONG:{value:4,bytes:4},RATIONAL:{value:5,bytes:8},SBYTE:{value:6,bytes:1},UNDEFINED:{value:7,bytes:1},SSHORT:{value:8,bytes:2},SLONG:{value:9,bytes:4},SRATIONAL:{value:10,bytes:8},FLOAT:{value:11,bytes:4},DOUBLE:{value:12,bytes:8}}),f=new c({IMAGE_WIDTH:256,IMAGE_HEIGHT:257,
BITS_PER_SAMPLE:258,COMPRESSION:259,PHOTOMETRIC_INTERPRETATION:262,STRIP_OFFSETS:273,ORIENTATION:274,SAMPLES_PER_PIXEL:277,ROWS_PER_STRIP:278,STRIP_BYTE_COUNTS:279,X_RESOLUTION:282,Y_RESOLUTION:283,PLANAR_CONFIGURATION:284,RESOLUTION_UNIT:296,SOFTWARE:305,COLOR_MAP:320,SAMPLE_FORMAT:339,MODEL_PIXEL_SCALE:33550,MODEL_TIEPOINT:33922,GEO_KEY_DIRECTORY:34735,GEO_DOUBLE_PARAMS:34736,GEO_ASCII_PARAMS:34737}),g=new Map([[d.BYTE,Uint8Array],[d.ASCII,Uint8Array],[d.SHORT,Uint16Array],[d.LONG,Uint32Array],
[d.RATIONAL,Uint32Array],[d.SBYTE,Int8Array],[d.UNDEFINED,Uint8Array],[d.SSHORT,Int16Array],[d.SLONG,Int32Array],[d.SRATIONAL,Int32Array],[d.FLOAT,Float32Array],[d.DOUBLE,Float64Array]]),h=function(a,b,c,d,e){this.tag=a;this.type=b;this.count=c;this.offset=d;this.value=e},l=function(){this.height=this.width=0;this.buffer=null;this.metadata=[]};c=function(){};c.read=function(a){var b=String.fromCharCode.apply(String,$jscomp.arrayFromIterable(Array.from(a.slice(0,2))));e.fromValue(b);if(42!==a.readUInt8(2))throw Error('not a valid tiff file');
b=a.readUInt32LE(4);console.log('offsetToFirstIFD',b);var c=[],k=b;for(b=0;100>b;){console.log('currentIFDOffset',k);var m=a.readUInt16LE(k),q=a.readUInt32LE(k+2+12*m);console.log('next offset: ',k+2+12*m);k=a.slice(k+2,k+2+12*m);for(var u=0;u<m;u++){var z=f.fromValue(k.readUInt16LE(12*u)),A=d.fromValue(k.readUInt16LE(12*u+2)),w=k.readUInt32LE(12*u+4),v=k.readUInt32LE(12*u+8),x=A.bytes*w,y=void 0;4>=x?y=v:(y=new Uint8Array(x),y.set(a.slice(v,v+x)),y=new (g.get(A))(y.buffer),A===d.ASCII&&(y=String.fromCharCode.apply(String,
$jscomp.arrayFromIterable(y))));z=new h(z,A,w,v,y);c.push(z)}console.log('nextIFDOffset',q);if(0===q)break;k=q;b++}k=function(a){for(var b=$jscomp.makeIterator(c),d=b.next();!d.done;d=b.next())if(d=d.value,d.tag===a)return d;return null};b=k(f.IMAGE_WIDTH,c).value;m=k(f.IMAGE_HEIGHT,c).value;k(f.COMPRESSION,c);q=k(f.ROWS_PER_STRIP,c).value;A=k(f.STRIP_OFFSETS,c);z=k(f.STRIP_BYTE_COUNTS,c);k=Math.ceil(m/q);u=[];for(w=0;w<z.count;w++)v=z.type,x=z.offset+w*v.bytes,y=void 0,v===d.SHORT?y=a.readUInt16LE(x):
v===d.LONG&&(y=a.readUInt32LE(x)),u.push(y);z=[];for(w=0;w<A.count;w++)v=A.type,x=A.offset+w*v.bytes,y=void 0,v===d.SHORT?y=a.readUInt16LE(x):v===d.LONG&&(y=a.readUInt32LE(x)),z.push(y);A=new Uint8Array(b*m*3);for(v=w=0;v<k;v++){x=z[v];x=a.slice(x,x+u[v]);y=3*b;for(var B=0;B<q;B++){var C=x.slice(B*y,B*y+y);A.set(C,w*y);if(C.length===y)w++;else break}}console.log('width: '+b);console.log('height: '+m);console.log('numStrips: '+k);console.log('stripByteCounts',u.join(', '));console.log('stripOffsets',
z.join(', '));a=new l;a.width=b;a.height=m;a.buffer=A;a.metadata=c;return a};var k=function(){};k.toTiffBuffer=function(a,b){b=void 0===b?{}:b;var c=new Uint8Array([73,73,42,0,8,0,0,0]),e=$jscomp.makeIterator([a.width,a.height]),g=e.next().value;e=e.next().value;var k=[new h(f.IMAGE_WIDTH,d.SHORT,1,null,g),new h(f.IMAGE_HEIGHT,d.SHORT,1,null,e),new h(f.BITS_PER_SAMPLE,d.SHORT,4,null,new Uint16Array([8,8,8,8])),new h(f.COMPRESSION,d.SHORT,1,null,1),new h(f.PHOTOMETRIC_INTERPRETATION,d.SHORT,1,null,
2),new h(f.ORIENTATION,d.SHORT,1,null,1),new h(f.SAMPLES_PER_PIXEL,d.SHORT,1,null,4),new h(f.ROWS_PER_STRIP,d.LONG,1,null,e),new h(f.STRIP_BYTE_COUNTS,d.LONG,1,null,g*e*3),new h(f.PLANAR_CONFIGURATION,d.SHORT,1,null,1),new h(f.RESOLUTION_UNIT,d.SHORT,1,null,1),new h(f.SOFTWARE,d.ASCII,6,null,'......'),new h(f.STRIP_OFFSETS,d.LONG,1,null,null),new h(f.X_RESOLUTION,d.RATIONAL,1,null,new Uint32Array([1,1])),new h(f.Y_RESOLUTION,d.RATIONAL,1,null,new Uint32Array([1,1]))];b.ifdEntries&&k.push.apply(k,
$jscomp.arrayFromIterable(b.ifdEntries));var l=12*k.length+14,m=new Map;b=new Map;for(var p=$jscomp.makeIterator(k),w=p.next();!w.done;w=p.next()){w=w.value;var v=new ArrayBuffer(12),x=new DataView(v);x.setUint16(0,w.tag.value,!0);x.setUint16(2,w.type.value,!0);x.setUint32(4,w.count,!0);1===w.count&&4>=w.type.bytes?x.setUint32(8,w.value,!0):(x.setUint32(8,l,!0),x=new Uint8Array(w.count*w.type.bytes),w.type===d.ASCII?x.set(new Uint8Array(w.value.split('').map(function(a){return a.charCodeAt(0)}))):
x.set(new Uint8Array(w.value.buffer)),b.set(w.tag,x),l+=x.byteLength);m.set(w.tag,v)}(new DataView(m.get(f.STRIP_OFFSETS))).setUint32(8,l,!0);l=function(a){var b=a.reduce(function(a,b){return a+b.byteLength},0);b=new Uint8Array(b);var c=0;a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())d=d.value,b.set(new Uint8Array(d),c),c+=d.byteLength;return b};k=l([new Uint16Array([k.length])].concat($jscomp.arrayFromIterable(m.values()),[new Uint32Array([0])]));b=l([].concat($jscomp.arrayFromIterable(b.values())));
a=l([c,k,b,a.buffer]);return{width:g,height:e,buffer:a}};a.Tag=f;a.Type=d;a.IFDEntry=h;a.Image=l;a.Reader=c;a.Exporter=k;return a}({});Potree.version={major:1,minor:6,suffix:'-nogui'};
Potree.loadPointCloud=function(a,b,c){var e=function(a){void 0!==b&&(a.name=b);c({type:'pointcloud_loaded',pointcloud:a})};0===a.indexOf('greyhound://')?Potree.GreyhoundLoader.load(a,function(b){b?e(new Potree.PointCloudOctree(b)):console.error(Error('Failed to load point cloud from URL '+a))}):0<a.indexOf('cloud.js')?Potree.POCLoader.load(a,function(b){b?e(new Potree.PointCloudOctree(b)):console.error(Error('Failed to load point cloud from URL '+a))}):0<a.indexOf('.vpc')?Potree.PointCloudArena4DGeometry.load(a,
function(b){b?e(new Potree.PointCloudArena4D(b)):console.error(Error('Failed to load point cloud from URL '+a))}):console.error(Error('Failed to load point cloud from URL '+a))};Potree.Shaders={};
Potree.Shaders['pointcloud.vs']='\nprecision highp float;\nprecision highp int;\n\n'+THREE.ShaderChunk.logdepthbuf_pars_vertex+'\n\n#define max_clip_polygons 8\n#define PI 3.141592653589793\n\nattribute vec3 position;\nattribute vec3 color;\nattribute float intensity;\nattribute float classification;\nattribute float returnNumber;\nattribute float numberOfReturns;\nattribute float pointSourceID;\nattribute vec4 indices;\nattribute float spacing;\n\nuniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 uViewInv;\n\nuniform float uScreenWidth;\nuniform float uScreenHeight;\nuniform float fov;\nuniform float near;\nuniform float far;\n\nuniform bool uDebug;\n\nuniform bool uUseOrthographicCamera;\nuniform float uOrthoWidth;\nuniform float uOrthoHeight;\n\n#define CLIPTASK_NONE 0\n#define CLIPTASK_HIGHLIGHT 1\n#define CLIPTASK_SHOW_INSIDE 2\n#define CLIPTASK_SHOW_OUTSIDE 3\n\n#define CLIPMETHOD_INSIDE_ANY 0\n#define CLIPMETHOD_INSIDE_ALL 1\n\nuniform int clipTask;\nuniform int clipMethod;\n\n#if defined(num_clipboxes) && num_clipboxes > 0\n\tuniform mat4 clipBoxes[num_clipboxes];\n#endif\n\n#if defined(num_clipspheres) && num_clipspheres > 0\n\tuniform mat4 uClipSpheres[num_clipspheres];\n#endif\n\n#if defined(num_clippolygons) && num_clippolygons > 0\n\tuniform int uClipPolygonVCount[num_clippolygons];\n\tuniform vec3 uClipPolygonVertices[num_clippolygons * 8];\n\tuniform mat4 uClipPolygonWVP[num_clippolygons];\n#endif\n\nuniform float size;\nuniform float minSize;\nuniform float maxSize;\n\nuniform float uPCIndex;\nuniform float uOctreeSpacing;\nuniform float uNodeSpacing;\nuniform float uOctreeSize;\nuniform vec3 uBBSize;\nuniform float uLevel;\nuniform float uVNStart;\nuniform bool uIsLeafNode;\n\nuniform vec3 uColor;\nuniform float uOpacity;\n\nuniform vec2 elevationRange;\nuniform vec2 intensityRange;\nuniform float intensityGamma;\nuniform float intensityContrast;\nuniform float intensityBrightness;\nuniform float rgbGamma;\nuniform float rgbContrast;\nuniform float rgbBrightness;\nuniform float uTransition;\nuniform float wRGB;\nuniform float wIntensity;\nuniform float wElevation;\nuniform float wClassification;\nuniform float wReturnNumber;\nuniform float wSourceID;\n\nuniform vec3 uShadowColor;\n\nuniform sampler2D visibleNodes;\nuniform sampler2D gradient;\nuniform sampler2D classificationLUT;\n\n#if defined(num_shadowmaps) && num_shadowmaps > 0\n\tuniform sampler2D uShadowMap[num_shadowmaps];\n\tuniform mat4 uShadowWorldView[num_shadowmaps];\n\tuniform mat4 uShadowProj[num_shadowmaps];\n#endif\n\nvarying vec3 vColor;\nvarying float vLogDepth;\nvarying vec3 vViewPosition;\nvarying float vRadius;\nvarying float vPointSize;\n\nfloat round(float number)\n{\n\treturn floor(number + 0.5);\n}\n\n// ---------------------\n// OCTREE\n// ---------------------\n\n#if (defined(adaptive_point_size) || defined(color_type_lod)) && defined(tree_type_octree)\n\n\t/**\n\t * number of 1-bits up to inclusive index position\n\t * number is treated as if it were an integer in the range 0-255\n\t */\n\tint numberOfOnes(int number, int index)\n\t{\n\t\tint numOnes = 0;\n\t\tint tmp = 128;\n\n\t\tfor(int i = 7; i >= 0; i--)\n\t\t{\n\t\t\tif(number >= tmp)\n\t\t\t{\n\t\t\t\tnumber = number - tmp;\n\n\t\t\t\tif(i <= index)\n\t\t\t\t{\n\t\t\t\t\tnumOnes++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\ttmp = tmp / 2;\n\t\t}\n\n\t\treturn numOnes;\n\t}\n\n\t/**\n\t * checks whether the bit at index is 1\n\t * number is treated as if it were an integer in the range 0-255\n\t */\n\tbool isBitSet(int number, int index)\n\t{\n\t\t// weird multi else if due to lack of proper array, int and bitwise support in WebGL 1.0\n\t\tint powi = 1;\n\n\t\tif(index == 0)\n\t\t{\n\t\t\tpowi = 1;\n\t\t}\n\t\telse if(index == 1)\n\t\t{\n\t\t\tpowi = 2;\n\t\t}\n\t\telse if(index == 2)\n\t\t{\n\t\t\tpowi = 4;\n\t\t}\n\t\telse if(index == 3)\n\t\t{\n\t\t\tpowi = 8;\n\t\t}\n\t\telse if(index == 4)\n\t\t{\n\t\t\tpowi = 16;\n\t\t}\n\t\telse if(index == 5)\n\t\t{\n\t\t\tpowi = 32;\n\t\t}\n\t\telse if(index == 6)\n\t\t{\n\t\t\tpowi = 64;\n\t\t}\n\t\telse if(index == 7)\n\t\t{\n\t\t\tpowi = 128;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tint ndp = number / powi;\n\n\t\treturn mod(float(ndp), 2.0) != 0.0;\n\t}\n\n\t/**\n\t * find the LOD at the point position\n\t */\n\tfloat getLOD()\n\t{\n\t\tvec3 offset = vec3(0.0, 0.0, 0.0);\n\t\tint iOffset = int(uVNStart);\n\t\tfloat depth = uLevel;\n\n\t\tfor(float i = 0.0; i <= 30.0; i++)\n\t\t{\n\t\t\tfloat nodeSizeAtLevel = uOctreeSize / pow(2.0, i + uLevel + 0.0);\n\t\t\t\n\t\t\tvec3 index3d = (position-offset) / nodeSizeAtLevel;\n\t\t\tindex3d = floor(index3d + 0.5);\n\t\t\tint index = int(round(4.0 * index3d.x + 2.0 * index3d.y + index3d.z));\n\t\t\t\n\t\t\tvec4 value = texture2D(visibleNodes, vec2(float(iOffset) / 2048.0, 0.0));\n\t\t\tint mask = int(round(value.r * 255.0));\n\n\t\t\tif(isBitSet(mask, index))\n\t\t\t{\n\t\t\t\t// there are more visible child nodes at this position\n\t\t\t\tint advanceG = int(round(value.g * 255.0)) * 256;\n\t\t\t\tint advanceB = int(round(value.b * 255.0));\n\t\t\t\tint advanceChild = numberOfOnes(mask, index - 1);\n\t\t\t\tint advance = advanceG + advanceB + advanceChild;\n\n\t\t\t\tiOffset = iOffset + advance;\n\t\t\t\t\n\t\t\t\tdepth++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// no more visible child nodes at this position\n\t\t\t\treturn value.a * 255.0;\n\t\t\t\t//return depth;\n\t\t\t}\n\t\t\t\n\t\t\toffset = offset + (vec3(1.0, 1.0, 1.0) * nodeSizeAtLevel * 0.5) * index3d;\n\t\t}\n\t\t\t\n\t\treturn depth;\n\t}\n\n\tfloat getSpacing()\n\t{\n\t\tvec3 offset = vec3(0.0, 0.0, 0.0);\n\t\tint iOffset = int(uVNStart);\n\t\tfloat depth = uLevel;\n\t\tfloat spacing = uNodeSpacing;\n\n\t\tfor(float i = 0.0; i <= 30.0; i++)\n\t\t{\n\t\t\tfloat nodeSizeAtLevel = uOctreeSize / pow(2.0, i + uLevel + 0.0);\n\t\t\t\n\t\t\tvec3 index3d = (position-offset) / nodeSizeAtLevel;\n\t\t\tindex3d = floor(index3d + 0.5);\n\t\t\tint index = int(round(4.0 * index3d.x + 2.0 * index3d.y + index3d.z));\n\t\t\t\n\t\t\tvec4 value = texture2D(visibleNodes, vec2(float(iOffset) / 2048.0, 0.0));\n\t\t\tint mask = int(round(value.r * 255.0));\n\t\t\tfloat spacingFactor = value.a;\n\n\t\t\tif(i > 0.0)\n\t\t\t{\n\t\t\t\tspacing = spacing / (255.0 * spacingFactor);\n\t\t\t}\n\t\t\t\n\t\t\tif(isBitSet(mask, index))\n\t\t\t{\n\t\t\t\t// there are more visible child nodes at this position\n\t\t\t\tint advanceG = int(round(value.g * 255.0)) * 256;\n\t\t\t\tint advanceB = int(round(value.b * 255.0));\n\t\t\t\tint advanceChild = numberOfOnes(mask, index - 1);\n\t\t\t\tint advance = advanceG + advanceB + advanceChild;\n\n\t\t\t\tiOffset = iOffset + advance;\n\n\t\t\t\tdepth++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// no more visible child nodes at this position\n\t\t\t\treturn spacing;\n\t\t\t}\n\t\t\t\n\t\t\toffset = offset + (vec3(1.0, 1.0, 1.0) * nodeSizeAtLevel * 0.5) * index3d;\n\t\t}\n\t\t\t\n\t\treturn spacing;\n\t}\n\n\tfloat getPointSizeAttenuation()\n\t{\n\t\treturn pow(2.0, getLOD());\n\t}\n#endif\n\n// ---------------------\n// KD-TREE\n// ---------------------\n#if (defined(adaptive_point_size) || defined(color_type_lod)) && defined(tree_type_kdtree)\n\tfloat getLOD()\n\t{\n\t\tvec3 offset = vec3(0.0, 0.0, 0.0);\n\t\tfloat iOffset = 0.0;\n\t\tfloat depth = 0.0;\n\t\t\t\n\t\tvec3 size = uBBSize;\t\n\t\tvec3 pos = position;\n\t\t\t\n\t\tfor(float i = 0.0; i <= 1000.0; i++)\n\t\t{\n\t\t\tvec4 value = texture2D(visibleNodes, vec2(iOffset / 2048.0, 0.0));\n\t\t\t\n\t\t\tint children = int(value.r * 255.0);\n\t\t\tfloat next = value.g * 255.0;\n\t\t\tint split = int(value.b * 255.0);\n\t\t\t\n\t\t\tif(next == 0.0)\n\t\t\t{\n\t\t\t \treturn depth;\n\t\t\t}\n\t\t\t\n\t\t\tvec3 splitv = vec3(0.0, 0.0, 0.0);\n\t\t\tif(split == 1)\n\t\t\t{\n\t\t\t\tsplitv.x = 1.0;\n\t\t\t}\n\t\t\telse if(split == 2)\n\t\t\t{\n\t\t\t \tsplitv.y = 1.0;\n\t\t\t}\n\t\t\telse if(split == 4)\n\t\t\t{\n\t\t\t \tsplitv.z = 1.0;\n\t\t\t}\n\t\t\t\n\t\t\tiOffset = iOffset + next;\n\t\t\t\n\t\t\tfloat factor = length(pos * splitv / size);\n\n\t\t\t//Left\n\t\t\tif(factor < 0.5)\n\t\t\t{\n\t\t\t\tif(children == 0 || children == 2)\n\t\t\t\t{\n\t\t\t\t\treturn depth;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//Right\n\t\t\telse\n\t\t\t{\n\t\t\t\tpos = pos - size * splitv * 0.5;\n\t\t\t\tif(children == 0 || children == 1)\n\t\t\t\t{\n\t\t\t\t\treturn depth;\n\t\t\t\t}\n\t\t\t\tif(children == 3)\n\t\t\t\t{\n\t\t\t\t\tiOffset = iOffset + 1.0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsize = size * ((1.0 - (splitv + 1.0) / 2.0) + 0.5);\n\t\t\tdepth++;\n\t\t}\n\t\t\t\n\t\treturn depth;\t\n\t}\n\n\tfloat getPointSizeAttenuation()\n\t{\n\t\treturn 0.5 * pow(1.3, getLOD());\n\t}\n#endif\n\n//formula adapted from: http://www.dfstudios.co.uk/articles/programming/image-programming-algorithms/image-processing-algorithms-part-5-contrast-adjustment/\nfloat getContrastFactor(float contrast)\n{\n\treturn (1.0158730158730156 * (contrast + 1.0)) / (1.0158730158730156 - contrast);\n}\n\nvec3 getRGB()\n{\n\tvec3 rgb = color;\n\t\n\trgb = pow(rgb, vec3(rgbGamma));\n\trgb = rgb + rgbBrightness;\n\trgb = clamp(rgb, 0.0, 1.0);\n\t\n\treturn rgb;\n}\n\nfloat getIntensity()\n{\n\tfloat w = (intensity - intensityRange.x) / (intensityRange.y - intensityRange.x);\n\tw = pow(w, intensityGamma);\n\tw = w + intensityBrightness;\n\tw = (w - 0.5) * getContrastFactor(intensityContrast) + 0.5;\n\tw = clamp(w, 0.0, 1.0);\n\n\treturn w;\n}\n\nvec3 getElevation()\n{\n\tvec4 world = modelMatrix * vec4( position, 1.0 );\n\tfloat w = (world.z - elevationRange.x) / (elevationRange.y - elevationRange.x);\n\treturn texture2D(gradient, vec2(w,1.0-w)).rgb;\n}\n\nvec4 getClassification()\n{\n\tvec2 uv = vec2(classification / 255.0, 0.5);\n\treturn texture2D(classificationLUT, uv);\n}\n\nvec3 getReturnNumber()\n{\n\tif(numberOfReturns == 1.0)\n\t{\n\t\treturn vec3(1.0, 1.0, 0.0);\n\t}\n\telse\n\t{\n\t\tif(returnNumber == 1.0)\n\t\t{\n\t\t\treturn vec3(1.0, 0.0, 0.0);\n\t\t}\n\t\telse if(returnNumber == numberOfReturns)\n\t\t{\n\t\t\treturn vec3(0.0, 0.0, 1.0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn vec3(0.0, 1.0, 0.0);\n\t\t}\n\t}\n}\n\nvec3 getSourceID()\n{\n\tfloat w = mod(pointSourceID, 10.0) / 10.0;\n\treturn texture2D(gradient, vec2(w,1.0 - w)).rgb;\n}\n\nvec3 getCompositeColor()\n{\n\tvec3 c;\n\tfloat w;\n\n\tc += wRGB * getRGB();\n\tw += wRGB;\n\t\n\tc += wIntensity * getIntensity() * vec3(1.0, 1.0, 1.0);\n\tw += wIntensity;\n\t\n\tc += wElevation * getElevation();\n\tw += wElevation;\n\t\n\tc += wReturnNumber * getReturnNumber();\n\tw += wReturnNumber;\n\t\n\tc += wSourceID * getSourceID();\n\tw += wSourceID;\n\t\n\tvec4 cl = wClassification * getClassification();\n    c += cl.a * cl.rgb;\n\tw += wClassification * cl.a;\n\n\tc = c / w;\n\t\n\tif(w == 0.0)\n\t{\n\t\tgl_Position = vec4(100.0, 100.0, 100.0, 0.0);\n\t}\n\t\n\treturn c;\n}\n\nvec3 getColor()\n{\n\tvec3 color;\n\t\n\t#ifdef color_type_rgb\n\t\tcolor = getRGB();\n\t#elif defined color_type_height\n\t\tcolor = getElevation();\n\t#elif defined color_type_rgb_height\n\t\tvec3 cHeight = getElevation();\n\t\tcolor = (1.0 - uTransition) * getRGB() + uTransition * cHeight;\n\t#elif defined color_type_depth\n\t\tfloat linearDepth = gl_Position.w;\n\t\tfloat expDepth = (gl_Position.z / gl_Position.w) * 0.5 + 0.5;\n\t\tcolor = vec3(linearDepth, expDepth, 0.0);\n\t#elif defined color_type_intensity\n\t\tfloat w = getIntensity();\n\t\tcolor = vec3(w, w, w);\n\t#elif defined color_type_intensity_gradient\n\t\tfloat w = getIntensity();\n\t\tcolor = texture2D(gradient, vec2(w,1.0-w)).rgb;\n\t#elif defined color_type_color\n\t\tcolor = uColor;\n\t#elif defined color_type_lod\n\t\tfloat depth = getLOD();\n\t\tfloat w = depth / 10.0;\n\t\tcolor = texture2D(gradient, vec2(w,1.0-w)).rgb;\n\t#elif defined color_type_point_index\n\t\tcolor = indices.rgb;\n\t#elif defined color_type_classification\n\t\tvec4 cl = getClassification(); \n\t\tcolor = cl.rgb;\n\t#elif defined color_type_return_number\n\t\tcolor = getReturnNumber();\n\t#elif defined color_type_source\n\t\tcolor = getSourceID();\n\t#elif defined color_type_normal\n\t\tcolor = (modelMatrix * vec4(normal, 0.0)).xyz;\n\t#elif defined color_type_phong\n\t\tcolor = color;\n\t#elif defined color_type_composite\n\t\tcolor = getCompositeColor();\n\t#endif\n\t\n\treturn color;\n}\n\nfloat getPointSize()\n{\n\tfloat pointSize = 1.0;\n\t\n\tfloat slope = tan(fov / 2.0);\n\tfloat projFactor = -0.5 * uScreenHeight / (slope * vViewPosition.z);\n\t\n\tfloat r = uOctreeSpacing * 1.7;\n\tvRadius = r;\n\n\t#if defined fixed_point_size\n\t\tpointSize = size;\n\t#elif defined attenuated_point_size\n\t\tif(uUseOrthographicCamera)\n\t\t{\n\t\t\tpointSize = size;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpointSize = size * spacing * projFactor;\n\t\t}\n\t#elif defined adaptive_point_size\n\t\tif(uUseOrthographicCamera)\n\t\t{\n\t\t\tfloat worldSpaceSize = 1.0 * size * r / getPointSizeAttenuation();\n\t\t\tpointSize = (worldSpaceSize / uOrthoWidth) * uScreenWidth;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(uIsLeafNode && false)\n\t\t\t{\n\t\t\t\tpointSize = size * spacing * projFactor;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfloat worldSpaceSize = 1.0 * size * r / getPointSizeAttenuation();\n\t\t\t\tpointSize = worldSpaceSize * projFactor;\n\t\t\t}\n\t\t}\n\t#endif\n\n\tpointSize = max(minSize, pointSize);\n\tpointSize = min(maxSize, pointSize);\n\t\n\tvRadius = pointSize / projFactor;\n\n\treturn pointSize;\n}\n\n#if defined(num_clippolygons) && num_clippolygons > 0\n\tbool pointInClipPolygon(vec3 point, int polyIdx)\n\t{\n\t\tmat4 wvp = uClipPolygonWVP[polyIdx];\n\n\t\tvec4 pointNDC = wvp * vec4(point, 1.0);\n\t\tpointNDC.xy = pointNDC.xy / pointNDC.w;\n\n\t\tint j = uClipPolygonVCount[polyIdx] - 1;\n\t\tbool c = false;\n\t\tfor(int i = 0; i < 8; i++)\n\t\t{\n\t\t\tif(i == uClipPolygonVCount[polyIdx])\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvec3 verti = uClipPolygonVertices[polyIdx * 8 + i];\n\t\t\tvec3 vertj = uClipPolygonVertices[polyIdx * 8 + j];\n\n\t\t\tif(((verti.y > pointNDC.y) != (vertj.y > pointNDC.y)) && (pointNDC.x < (vertj.x-verti.x) * (pointNDC.y-verti.y) / (vertj.y-verti.y) + verti.x))\n\t\t\t{\n\t\t\t\tc = !c;\n\t\t\t}\n\n\t\t\tj = i;\n\t\t}\n\n\t\treturn c;\n\t}\n#endif\n\nvoid doClipping()\n{\n\t#if !defined color_type_composite\n\t\tvec4 cl = getClassification(); \n\t\tif(cl.a == 0.0)\n\t\t{\n\t\t\tgl_Position = vec4(100.0, 100.0, 100.0, 0.0);\n\t\t\t\n\t\t\treturn;\n\t\t}\n\t#endif\n\n\tint clipVolumesCount = 0;\n\tint insideCount = 0;\n\n\t#if defined(num_clipboxes) && num_clipboxes > 0\n\t\tfor(int i = 0; i < num_clipboxes; i++)\n\t\t{\n\t\t\tvec4 clipPosition = clipBoxes[i] * modelMatrix * vec4( position, 1.0 );\n\t\t\tbool inside = -0.5 <= clipPosition.x && clipPosition.x <= 0.5;\n\t\t\tinside = inside && -0.5 <= clipPosition.y && clipPosition.y <= 0.5;\n\t\t\tinside = inside && -0.5 <= clipPosition.z && clipPosition.z <= 0.5;\n\n\t\t\tinsideCount = insideCount + (inside ? 1 : 0);\n\t\t\tclipVolumesCount++;\n\t\t}\t\n\t#endif\n\n\t#if defined(num_clippolygons) && num_clippolygons > 0\n\t\tfor(int i = 0; i < num_clippolygons; i++)\n\t\t{\n\t\t\tbool inside = pointInClipPolygon(position, i);\n\n\t\t\tinsideCount = insideCount + (inside ? 1 : 0);\n\t\t\tclipVolumesCount++;\n\t\t}\n\t#endif\n\n\tbool insideAny = insideCount > 0;\n\tbool insideAll = (clipVolumesCount > 0) && (clipVolumesCount == insideCount);\n\n\tif(clipMethod == CLIPMETHOD_INSIDE_ANY)\n\t{\n\t\tif(insideAny && clipTask == CLIPTASK_HIGHLIGHT)\n\t\t{\n\t\t\tvColor.r += 0.5;\n\t\t}\n\t\telse if(!insideAny && clipTask == CLIPTASK_SHOW_INSIDE)\n\t\t{\n\t\t\tgl_Position = vec4(100.0, 100.0, 100.0, 1.0);\n\t\t}\n\t\telse if(insideAny && clipTask == CLIPTASK_SHOW_OUTSIDE)\n\t\t{\n\t\t\tgl_Position = vec4(100.0, 100.0, 100.0, 1.0);\n\t\t}\n\t}\n\telse if(clipMethod == CLIPMETHOD_INSIDE_ALL)\n\t{\n\t\tif(insideAll && clipTask == CLIPTASK_HIGHLIGHT)\n\t\t{\n\t\t\tvColor.r += 0.5;\n\t\t}\n\t\telse if(!insideAll && clipTask == CLIPTASK_SHOW_INSIDE)\n\t\t{\n\t\t\tgl_Position = vec4(100.0, 100.0, 100.0, 1.0);\n\t\t}\n\t\telse if(insideAll && clipTask == CLIPTASK_SHOW_OUTSIDE)\n\t\t{\n\t\t\tgl_Position = vec4(100.0, 100.0, 100.0, 1.0);\n\t\t}\n\t}\n}\n\nvoid main()\n{\n\tvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\tvViewPosition = mvPosition.xyz;\n\tgl_Position = projectionMatrix * mvPosition;\n\n\tvLogDepth = log2(-mvPosition.z);\n\n\t// POINT SIZE\n\tfloat pointSize = getPointSize();\n\tgl_PointSize = pointSize;\n\tvPointSize = pointSize;\n\n\t'+THREE.ShaderChunk.logdepthbuf_vertex+
'\n\n\t// COLOR\n\tvColor = getColor();\n\n\t#if defined hq_depth_pass\n\t\tfloat originalDepth = gl_Position.w;\n\t\tfloat adjustedDepth = originalDepth + 2.0 * vRadius;\n\t\tfloat adjust = adjustedDepth / originalDepth;\n\n\t\tmvPosition.xyz = mvPosition.xyz * adjust;\n\t\tgl_Position = projectionMatrix * mvPosition;\n\t#endif\n\n\t// CLIPPING\n\tdoClipping();\n\n\t#if defined(num_clipspheres) && num_clipspheres > 0\n\t\tfor(int i = 0; i < num_clipspheres; i++)\n\t\t{\n\t\t\tvec4 sphereLocal = uClipSpheres[i] * mvPosition;\n\n\t\t\tfloat distance = length(sphereLocal.xyz);\n\n\t\t\tif(distance < 1.0)\n\t\t\t{\n\t\t\t\tfloat w = distance;\n\t\t\t\tvec3 cGradient = texture2D(gradient, vec2(w, 1.0 - w)).rgb;\n\t\t\t\t\n\t\t\t\tvColor = cGradient;\n\t\t\t}\n\t\t}\n\t#endif\n\n\t#if defined(num_shadowmaps) && num_shadowmaps > 0\n\n\t\tconst float sm_near = 0.1;\n\t\tconst float sm_far = 10000.0;\n\n\t\tfor(int i = 0; i < num_shadowmaps; i++)\n\t\t{\n\t\t\tvec3 viewPos = (uShadowWorldView[i] * vec4(position, 1.0)).xyz;\n\t\t\tfloat distanceToLight = abs(viewPos.z);\n\t\t\t\n\t\t\tvec4 projPos = uShadowProj[i] * uShadowWorldView[i] * vec4(position, 1);\n\t\t\tvec3 nc = projPos.xyz / projPos.w;\n\t\t\t\n\t\t\tfloat u = nc.x * 0.5 + 0.5;\n\t\t\tfloat v = nc.y * 0.5 + 0.5;\n\n\t\t\tvec2 sampleStep = vec2(1.0 / (2.0*1024.0), 1.0 / (2.0*1024.0)) * 1.5;\n\t\t\tvec2 sampleLocations[9];\n\n\t\t\tsampleLocations[0] = vec2(0.0, 0.0);\n\t\t\tsampleLocations[1] = sampleStep;\n\t\t\tsampleLocations[2] = -sampleStep;\n\t\t\tsampleLocations[3] = vec2(sampleStep.x, -sampleStep.y);\n\t\t\tsampleLocations[4] = vec2(-sampleStep.x, sampleStep.y);\n\t\t\tsampleLocations[5] = vec2(0.0, sampleStep.y);\n\t\t\tsampleLocations[6] = vec2(0.0, -sampleStep.y);\n\t\t\tsampleLocations[7] = vec2(sampleStep.x, 0.0);\n\t\t\tsampleLocations[8] = vec2(-sampleStep.x, 0.0);\n\n\t\t\tfloat visibleSamples = 0.0;\n\t\t\tfloat numSamples = 0.0;\n\n\t\t\tfloat bias = vRadius * 2.0;\n\n\t\t\tfor(int j = 0; j < 9; j++)\n\t\t\t{\n\t\t\t\tvec4 depthMapValue = texture2D(uShadowMap[i], vec2(u, v) + sampleLocations[j]);\n\n\t\t\t\tfloat linearDepthFromSM = depthMapValue.x + bias;\n\t\t\t\tfloat linearDepthFromViewer = distanceToLight;\n\n\t\t\t\tif(linearDepthFromSM > linearDepthFromViewer)\n\t\t\t\t{\n\t\t\t\t\tvisibleSamples += 1.0;\n\t\t\t\t}\n\n\t\t\t\tnumSamples += 1.0;\n\t\t\t}\n\n\t\t\tfloat visibility = visibleSamples / numSamples;\n\n\t\t\tif(u < 0.0 || u > 1.0 || v < 0.0 || v > 1.0 || nc.x < -1.0 || nc.x > 1.0 || nc.y < -1.0 || nc.y > 1.0 || nc.z < -1.0 || nc.z > 1.0)\n\t\t\t{\n\t\t\t\t//vColor = vec3(0.0, 0.0, 0.2);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvColor = vColor * visibility + vColor * uShadowColor * (1.0 - visibility);\n\t\t\t}\n\t\t}\n\n\t#endif\n}';
Potree.Shaders['pointcloud.fs']='\n\nprecision highp float;\nprecision highp int;\n\n#if defined USE_LOGDEPTHBUF_EXT || defined paraboloid_point_shape\n\t#extension GL_EXT_frag_depth : enable\n#endif\n\n'+THREE.ShaderChunk.logdepthbuf_pars_fragment+'\n\nuniform mat4 viewMatrix;\nuniform mat4 uViewInv;\nuniform mat4 uProjInv;\nuniform vec3 cameraPosition;\n\nuniform mat4 projectionMatrix;\nuniform float uOpacity;\n\nuniform float blendHardness;\nuniform float blendDepthSupplement;\nuniform float fov;\nuniform float uSpacing;\nuniform float near;\nuniform float far;\nuniform float uPCIndex;\nuniform float uScreenWidth;\nuniform float uScreenHeight;\n\nvarying vec3 vColor;\nvarying float vLogDepth;\nvarying vec3 vViewPosition;\nvarying float vRadius;\nvarying float vPointSize;\nvarying vec3 vPosition;\n\nvoid main()\n{\n\tvec3 color = vColor;\n\tfloat depth = gl_FragCoord.z;\n\n\t#if defined(circle_point_shape) || defined(paraboloid_point_shape) \n\t\tfloat u = 2.0 * gl_PointCoord.x - 1.0;\n\t\tfloat v = 2.0 * gl_PointCoord.y - 1.0;\n\t#endif\n\t\n\t#if defined(circle_point_shape)\n\t\tfloat cc = u*u + v*v;\n\t\tif(cc > 1.0)\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n\n\t#if defined color_type_point_index\n\t\tgl_FragColor = vec4(color, uPCIndex / 255.0);\n\t#else\n\t\tgl_FragColor = vec4(color, uOpacity);\n\t#endif\n\n\t#if defined paraboloid_point_shape\n\t\tfloat wi = 0.0 - ( u*u + v*v);\n\t\tvec4 pos = vec4(vViewPosition, 1.0);\n\t\tpos.z += wi * vRadius;\n\t\tfloat linearDepth = -pos.z;\n\t\tpos = projectionMatrix * pos;\n\t\tpos = pos / pos.w;\n\t\tfloat expDepth = pos.z;\n\t\tdepth = (pos.z + 1.0) / 2.0;\n\t\tgl_FragDepthEXT = depth;\n\t\t\n\t\t#if defined(color_type_depth)\n\t\t\tcolor.r = linearDepth;\n\t\t\tcolor.g = expDepth;\n\t\t#endif\n\t#endif\n\t\n\t'+
THREE.ShaderChunk.logdepthbuf_fragment+'\n\n\t#if defined(weighted_splats)\n\t\tfloat distance = 2.0 * length(gl_PointCoord.xy - 0.5);\n\t\tfloat weight = max(0.0, 1.0 - distance);\n\t\tweight = pow(weight, 1.5);\n\n\t\tgl_FragColor.a = weight;\n\t\tgl_FragColor.xyz = gl_FragColor.xyz * weight;\n\t#endif\n}';var source$PotreePointCloudMaterial$classdecl$var31=function(a){a=void 0===a?{}:a;var b=THREE.RawShaderMaterial.call(this)||this;b.visibleNodesTexture=Potree.utils.generateDataTexture(2048,1,new THREE.Color(16777215));b.visibleNodesTexture.minFilter=THREE.NearestFilter;b.visibleNodesTexture.magFilter=THREE.NearestFilter;var c=function(a,b){return void 0!==a?a:b},e=c(a.size,1),d=c(a.minSize,2),f=c(a.maxSize,50);a=c(a.treeType,Potree.TreeType.OCTREE);b._pointSizeType=Potree.PointSizeType.FIXED;b._shape=
Potree.PointShape.SQUARE;b._pointColorType=Potree.PointColorType.RGB;b._useClipBox=!1;b._weighted=!1;b._gradient=Potree.Gradients.SPECTRAL;b._treeType=a;b._useEDL=!1;b._snapEnabled=!1;b._numSnapshots=0;b._defaultIntensityRangeChanged=!1;b._defaultElevationRangeChanged=!1;b.clipBoxes=[];b.clipPolygons=[];b.gradientTexture=Potree.PointCloudMaterial.generateGradientTexture(b._gradient);b.lights=!1;b.fog=!1;b.defines=new Map;b.attributes={position:{type:'fv',value:[]},color:{type:'fv',value:[]},normal:{type:'fv',
value:[]},intensity:{type:'f',value:[]},classification:{type:'f',value:[]},returnNumber:{type:'f',value:[]},numberOfReturns:{type:'f',value:[]},pointSourceID:{type:'f',value:[]},indices:{type:'fv',value:[]}};b.uniforms={level:{type:'f',value:0},vnStart:{type:'f',value:0},spacing:{type:'f',value:1},blendHardness:{type:'f',value:2},blendDepthSupplement:{type:'f',value:0},fov:{type:'f',value:1},screenWidth:{type:'f',value:1},screenHeight:{type:'f',value:1},near:{type:'f',value:.1},far:{type:'f',value:1},
uColor:{type:'c',value:new THREE.Color(16777215)},uOpacity:{type:'f',value:1},size:{type:'f',value:e},minSize:{type:'f',value:d},maxSize:{type:'f',value:f},octreeSize:{type:'f',value:0},bbSize:{type:'fv',value:[0,0,0]},elevationRange:{type:'2fv',value:[0,0]},clipBoxCount:{type:'f',value:0},clipPolygonCount:{type:'i',value:0},clipBoxes:{type:'Matrix4fv',value:[]},clipPolygons:{type:'3fv',value:[]},clipPolygonVCount:{type:'iv',value:[]},clipPolygonVP:{type:'Matrix4fv',value:[]},visibleNodes:{type:'t',
value:b.visibleNodesTexture},pcIndex:{type:'f',value:0},gradient:{type:'t',value:b.gradientTexture},classificationLUT:{type:'t',value:b.classificationTexture},uHQDepthMap:{type:'t',value:null},toModel:{type:'Matrix4f',value:[]},diffuse:{type:'fv',value:[1,1,1]},transition:{type:'f',value:.5},intensityRange:{type:'fv',value:[0,65E3]},intensityGamma:{type:'f',value:1},intensityContrast:{type:'f',value:0},intensityBrightness:{type:'f',value:0},rgbGamma:{type:'f',value:1},rgbContrast:{type:'f',value:0},
rgbBrightness:{type:'f',value:0},wRGB:{type:'f',value:1},wIntensity:{type:'f',value:0},wElevation:{type:'f',value:0},wClassification:{type:'f',value:0},wReturnNumber:{type:'f',value:0},wSourceID:{type:'f',value:0},useOrthographicCamera:{type:'b',value:!1},clipTask:{type:'i',value:1},clipMethod:{type:'i',value:1},uSnapshot:{type:'tv',value:[]},uSnapshotDepth:{type:'tv',value:[]},uSnapView:{type:'Matrix4fv',value:[]},uSnapProj:{type:'Matrix4fv',value:[]},uSnapProjInv:{type:'Matrix4fv',value:[]},uSnapViewInv:{type:'Matrix4fv',
value:[]},uShadowColor:{type:'3fv',value:[0,0,0]}};b.classification=Potree.Classification.DEFAULT;b.defaultAttributeValues.normal=[0,0,0];b.defaultAttributeValues.classification=[0,0,0];b.defaultAttributeValues.indices=[0,0,0,0];b.vertexColors=THREE.VertexColors;e=b.getDefines();b.vertexShader=e+Potree.Shaders['pointcloud.vs'];b.fragmentShader=e+Potree.Shaders['pointcloud.fs'];return b};$jscomp.inherits(source$PotreePointCloudMaterial$classdecl$var31,THREE.RawShaderMaterial);
source$PotreePointCloudMaterial$classdecl$var31.prototype.setDefine=function(a,b){void 0!==b&&null!==b?this.defines.get(a)!==b&&(this.defines.set(a,b),this.updateShaderSource()):this.removeDefine(a)};source$PotreePointCloudMaterial$classdecl$var31.prototype.removeDefine=function(a){this.defines.delete(a)};
source$PotreePointCloudMaterial$classdecl$var31.prototype.updateShaderSource=function(){var a=this.getDefines();this.vertexShader=a+Potree.Shaders['pointcloud.vs'];this.fragmentShader=a+Potree.Shaders['pointcloud.fs'];this.depthFunc=THREE.LessEqualDepth;this.needsUpdate=this.depthWrite=this.depthTest=!0};
source$PotreePointCloudMaterial$classdecl$var31.prototype.onBeforeCompile=function(a,b){b.capabilities.logarithmicDepthBuffer&&(a.fragmentShader='#define USE_LOGDEPTHBUF\n#define USE_LOGDEPTHBUF_EXT\n#define EPSILON 1e-6\n'+a.fragmentShader,a.vertexShader='#define USE_LOGDEPTHBUF\n#define USE_LOGDEPTHBUF_EXT\n#define EPSILON 1e-6\n'+a.vertexShader)};
source$PotreePointCloudMaterial$classdecl$var31.prototype.getDefines=function(){var a=[];this.logarithmicDepthBuffer&&(a.push('#define USE_LOGDEPTHBUF'),a.push('#define USE_LOGDEPTHBUF_EXT'),a.push('#define EPSILON 1e-6'));this.pointSizeType===Potree.PointSizeType.FIXED?a.push('#define fixed_point_size'):this.pointSizeType===Potree.PointSizeType.ATTENUATED?a.push('#define attenuated_point_size'):this.pointSizeType===Potree.PointSizeType.ADAPTIVE&&a.push('#define adaptive_point_size');this.shape===
Potree.PointShape.SQUARE?a.push('#define square_point_shape'):this.shape===Potree.PointShape.CIRCLE?a.push('#define circle_point_shape'):this.shape===Potree.PointShape.PARABOLOID&&a.push('#define paraboloid_point_shape');this._useEDL&&a.push('#define use_edl');this._snapEnabled&&a.push('#define snap_enabled');this._pointColorType===Potree.PointColorType.RGB?a.push('#define color_type_rgb'):this._pointColorType===Potree.PointColorType.COLOR?a.push('#define color_type_color'):this._pointColorType===
Potree.PointColorType.DEPTH?a.push('#define color_type_depth'):this._pointColorType===Potree.PointColorType.HEIGHT?a.push('#define color_type_height'):this._pointColorType===Potree.PointColorType.INTENSITY?a.push('#define color_type_intensity'):this._pointColorType===Potree.PointColorType.INTENSITY_GRADIENT?a.push('#define color_type_intensity_gradient'):this._pointColorType===Potree.PointColorType.LOD?a.push('#define color_type_lod'):this._pointColorType===Potree.PointColorType.POINT_INDEX?a.push('#define color_type_point_index'):
this._pointColorType===Potree.PointColorType.CLASSIFICATION?a.push('#define color_type_classification'):this._pointColorType===Potree.PointColorType.RETURN_NUMBER?a.push('#define color_type_return_number'):this._pointColorType===Potree.PointColorType.SOURCE?a.push('#define color_type_source'):this._pointColorType===Potree.PointColorType.NORMAL?a.push('#define color_type_normal'):this._pointColorType===Potree.PointColorType.PHONG?a.push('#define color_type_phong'):this._pointColorType===Potree.PointColorType.RGB_HEIGHT?
a.push('#define color_type_rgb_height'):this._pointColorType===Potree.PointColorType.COMPOSITE&&a.push('#define color_type_composite');this._treeType===Potree.TreeType.OCTREE?a.push('#define tree_type_octree'):this._treeType===Potree.TreeType.KDTREE&&a.push('#define tree_type_kdtree');this.weighted&&a.push('#define weighted_splats');for(var b=$jscomp.makeIterator(this.defines),c=b.next();!c.done;c=b.next())c=$jscomp.makeIterator(c.value),c.next(),c=c.next().value,a.push(c);return a.join('\n')};
source$PotreePointCloudMaterial$classdecl$var31.prototype.setClipBoxes=function(a){if(a){var b=this.clipBoxes.length!==a.length&&(0===a.length||0===this.clipBoxes.length);this.uniforms.clipBoxCount.value=this.clipBoxes.length;this.clipBoxes=a;b&&this.updateShaderSource();this.uniforms.clipBoxes.value=new Float32Array(16*this.clipBoxes.length);for(b=0;b<this.clipBoxes.length;b++)this.uniforms.clipBoxes.value.set(a[b].inverse.elements,16*b);for(a=0;a<this.uniforms.clipBoxes.value.length;a++)Number.isNaN(this.uniforms.clipBoxes.value[a])&&
(this.uniforms.clipBoxes.value[a]=Infinity)}};source$PotreePointCloudMaterial$classdecl$var31.prototype.setClipPolygons=function(a,b){a&&(this.clipPolygons=a,this.clipPolygons.length!==a.length&&this.updateShaderSource())};
source$PotreePointCloudMaterial$classdecl$var31.prototype.recomputeClassification=function(){this.classificationTexture=Potree.PointCloudMaterial.generateClassificationTexture(this._classification);this.uniforms.classificationLUT.value=this.classificationTexture;this.dispatchEvent({type:'material_property_changed',target:this})};
source$PotreePointCloudMaterial$classdecl$var31.generateGradientTexture=function(a){var b=document.createElement('canvas');b.width=64;b.height=64;var c=b.getContext('2d');c.rect(0,0,64,64);for(var e=c.createLinearGradient(0,0,64,64),d=0;d<a.length;d++){var f=a[d];e.addColorStop(f[0],'#'+f[1].getHexString())}c.fillStyle=e;c.fill();a=new THREE.CanvasTexture(b);a.needsUpdate=!0;a.minFilter=THREE.LinearFilter;return a};
source$PotreePointCloudMaterial$classdecl$var31.generateClassificationTexture=function(a){for(var b=new Uint8Array(262144),c=0;256>c;c++)for(var e=0;256>e;e++){var d=c+256*e;var f=a[c]?a[c]:a[c%32]?a[c%32]:a.DEFAULT;b[4*d]=255*f.x;b[4*d+1]=255*f.y;b[4*d+2]=255*f.z;b[4*d+3]=255*f.w}a=new THREE.DataTexture(b,256,256,THREE.RGBAFormat);a.magFilter=THREE.NearestFilter;a.needsUpdate=!0;return a};
source$PotreePointCloudMaterial$classdecl$var31.prototype.disableEvents=function(){void 0===this._hiddenListeners&&(this._hiddenListeners=this._listeners,this._listeners={})};source$PotreePointCloudMaterial$classdecl$var31.prototype.enableEvents=function(){this._listeners=this._hiddenListeners;this._hiddenListeners=void 0};
source$PotreePointCloudMaterial$classdecl$var31.prototype.copyFrom=function(a){for(var b=$jscomp.makeIterator(this.uniforms),c=b.next();!c.done;c=b.next())c=c.value,this.uniforms[c].value=a.uniforms[c].value};
$jscomp.global.Object.defineProperties(source$PotreePointCloudMaterial$classdecl$var31.prototype,{gradient:{configurable:!0,enumerable:!0,get:function(){return this._gradient},set:function(a){this._gradient!==a&&(this._gradient=a,this.gradientTexture=Potree.PointCloudMaterial.generateGradientTexture(this._gradient),this.uniforms.gradient.value=this.gradientTexture)}},useOrthographicCamera:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.useOrthographicCamera.value},set:function(a){this.uniforms.useOrthographicCamera.value!==
a&&(this.uniforms.useOrthographicCamera.value=a)}},classification:{configurable:!0,enumerable:!0,get:function(){return this._classification},set:function(a){for(var b={},c=$jscomp.makeIterator(Object.keys(a)),e=c.next();!e.done;e=c.next())e=e.value,b[e]=a[e].clone();if(void 0===this._classification)a=!1;else for(a=Object.keys(b).length===Object.keys(this._classification).length,c=$jscomp.makeIterator(Object.keys(b)),e=c.next();!e.done;e=c.next())e=e.value,a=(a=a&&void 0!==this._classification[e])&&
b[e].equals(this._classification[e]);a||(this._classification=b,this.recomputeClassification())}},numSnapshots:{configurable:!0,enumerable:!0,get:function(){return this._numSnapshots},set:function(a){this._numSnapshots=a}},snapEnabled:{configurable:!0,enumerable:!0,get:function(){return this._snapEnabled},set:function(a){this._snapEnabled!==a&&(this._snapEnabled=a,this.updateShaderSource())}},spacing:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.spacing.value},set:function(a){this.uniforms.spacing.value!==
a&&(this.uniforms.spacing.value=a)}},useClipBox:{configurable:!0,enumerable:!0,get:function(){return this._useClipBox},set:function(a){this._useClipBox!==a&&(this._useClipBox=a,this.updateShaderSource())}},clipTask:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.clipTask.value},set:function(a){this.uniforms.clipTask.value=a}},clipMethod:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.clipMethod.value},set:function(a){this.uniforms.clipMethod.value=a}},weighted:{configurable:!0,
enumerable:!0,get:function(){return this._weighted},set:function(a){this._weighted!==a&&(this._weighted=a,this.updateShaderSource())}},fov:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.fov.value},set:function(a){this.uniforms.fov.value!==a&&(this.uniforms.fov.value=a,this.updateShaderSource())}},screenWidth:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.screenWidth.value},set:function(a){this.uniforms.screenWidth.value!==a&&(this.uniforms.screenWidth.value=
a,this.updateShaderSource())}},screenHeight:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.screenHeight.value},set:function(a){this.uniforms.screenHeight.value!==a&&(this.uniforms.screenHeight.value=a,this.updateShaderSource())}},near:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.near.value},set:function(a){this.uniforms.near.value!==a&&(this.uniforms.near.value=a)}},far:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.far.value},set:function(a){this.uniforms.far.value!==
a&&(this.uniforms.far.value=a)}},opacity:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.uOpacity.value},set:function(a){this.uniforms&&this.uniforms.uOpacity&&this.uniforms.uOpacity.value!==a&&(this.uniforms.uOpacity.value=a,this.updateShaderSource(),this.dispatchEvent({type:'opacity_changed',target:this}),this.dispatchEvent({type:'material_property_changed',target:this}))}},pointColorType:{configurable:!0,enumerable:!0,get:function(){return this._pointColorType},set:function(a){this._pointColorType!==
a&&(this._pointColorType=a,this.updateShaderSource(),this.dispatchEvent({type:'point_color_type_changed',target:this}),this.dispatchEvent({type:'material_property_changed',target:this}))}},pointSizeType:{configurable:!0,enumerable:!0,get:function(){return this._pointSizeType},set:function(a){this._pointSizeType!==a&&(this._pointSizeType=a,this.updateShaderSource(),this.dispatchEvent({type:'point_size_type_changed',target:this}),this.dispatchEvent({type:'material_property_changed',target:this}))}},
useEDL:{configurable:!0,enumerable:!0,get:function(){return this._useEDL},set:function(a){this._useEDL!==a&&(this._useEDL=a,this.updateShaderSource())}},color:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.uColor.value},set:function(a){this.uniforms.uColor.value.equals(a)||(this.uniforms.uColor.value.copy(a),this.dispatchEvent({type:'color_changed',target:this}),this.dispatchEvent({type:'material_property_changed',target:this}))}},shape:{configurable:!0,enumerable:!0,get:function(){return this._shape},
set:function(a){this._shape!==a&&(this._shape=a,this.updateShaderSource(),this.dispatchEvent({type:'point_shape_changed',target:this}),this.dispatchEvent({type:'material_property_changed',target:this}))}},treeType:{configurable:!0,enumerable:!0,get:function(){return this._treeType},set:function(a){this._treeType!==a&&(this._treeType=a,this.updateShaderSource())}},bbSize:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.bbSize.value},set:function(a){this.uniforms.bbSize.value=a}},
size:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.size.value},set:function(a){this.uniforms.size.value!==a&&(this.uniforms.size.value=a,this.dispatchEvent({type:'point_size_changed',target:this}),this.dispatchEvent({type:'material_property_changed',target:this}))}},elevationRange:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.elevationRange.value},set:function(a){if(this.uniforms.elevationRange.value[0]!==a[0]||this.uniforms.elevationRange.value[1]!==a[1])this.uniforms.elevationRange.value=
a,this._defaultElevationRangeChanged=!0,this.dispatchEvent({type:'material_property_changed',target:this})}},heightMin:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.elevationRange.value[0]},set:function(a){this.elevationRange=[a,this.elevationRange[1]]}},heightMax:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.elevationRange.value[1]},set:function(a){this.elevationRange=[this.elevationRange[0],a]}},transition:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.transition.value},
set:function(a){this.uniforms.transition.value=a}},intensityRange:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.intensityRange.value},set:function(a){a instanceof Array&&2===a.length&&(a[0]!==this.uniforms.intensityRange.value[0]||a[1]!==this.uniforms.intensityRange.value[1])&&(this.uniforms.intensityRange.value=a,this._defaultIntensityRangeChanged=!0,this.dispatchEvent({type:'material_property_changed',target:this}))}},intensityGamma:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.intensityGamma.value},
set:function(a){this.uniforms.intensityGamma.value!==a&&(this.uniforms.intensityGamma.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}},intensityContrast:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.intensityContrast.value},set:function(a){this.uniforms.intensityContrast.value!==a&&(this.uniforms.intensityContrast.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}},intensityBrightness:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.intensityBrightness.value},
set:function(a){this.uniforms.intensityBrightness.value!==a&&(this.uniforms.intensityBrightness.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}},rgbGamma:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.rgbGamma.value},set:function(a){this.uniforms.rgbGamma.value!==a&&(this.uniforms.rgbGamma.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}},rgbContrast:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.rgbContrast.value},
set:function(a){this.uniforms.rgbContrast.value!==a&&(this.uniforms.rgbContrast.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}},rgbBrightness:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.rgbBrightness.value},set:function(a){this.uniforms.rgbBrightness.value!==a&&(this.uniforms.rgbBrightness.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}},weightRGB:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.wRGB.value},
set:function(a){this.uniforms.wRGB.value!==a&&(this.uniforms.wRGB.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}},weightIntensity:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.wIntensity.value},set:function(a){this.uniforms.wIntensity.value!==a&&(this.uniforms.wIntensity.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}},weightElevation:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.wElevation.value},
set:function(a){this.uniforms.wElevation.value!==a&&(this.uniforms.wElevation.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}},weightClassification:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.wClassification.value},set:function(a){this.uniforms.wClassification.value!==a&&(this.uniforms.wClassification.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}},weightReturnNumber:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.wReturnNumber.value},
set:function(a){this.uniforms.wReturnNumber.value!==a&&(this.uniforms.wReturnNumber.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}},weightSourceID:{configurable:!0,enumerable:!0,get:function(){return this.uniforms.wSourceID.value},set:function(a){this.uniforms.wSourceID.value!==a&&(this.uniforms.wSourceID.value=a,this.dispatchEvent({type:'material_property_changed',target:this}))}}});Potree.PointCloudMaterial=source$PotreePointCloudMaterial$classdecl$var31;Potree.XHRFactory={config:{withCredentials:!1,customHeaders:[{header:null,value:null}]},createXMLHttpRequest:function(){var a=new XMLHttpRequest;a.overrideMimeType('text/plain');if(this.config.customHeaders&&Array.isArray(this.config.customHeaders)&&0<this.config.customHeaders.length){var b=a.open,c=this.config.customHeaders;a.open=function(){b.apply(this,[].slice.call(arguments));c.forEach(function(b){b.header&&b.value&&a.setRequestHeader(b.header,b.value)})}}return a}};Potree.BasicGroup=function(){var a=THREE.Mesh.call(this,new THREE.Geometry,new THREE.MeshBasicMaterial({opacity:0,wireframe:!1,transparent:!0}))||this;a.rotation.set(-Math.PI/2,0,0);a.frustumCulled=!0;a.pointclouds=[];a.pointBudget=1E4;a.nodeSize=30;a.nodeLoadRate=2;return a};$jscomp.inherits(Potree.BasicGroup,THREE.Mesh);Potree.BasicGroup.prototype.raycast=function(a,b){};Potree.BasicGroup.prototype.setPointBudget=function(a){this.pointBudget=a};
Potree.BasicGroup.prototype.onBeforeRender=function(a,b,c,e,d,f){for(b=0;b<this.pointclouds.length;b++)e=this.pointclouds[b],e.minimumNodePixelSize=this.nodeSize,e.showBoundingBox=!1,e.generateDEM=!1;Potree.pointBudget=this.pointBudget;Potree.pointLoadLimit=this.pointBudget*this.nodeLoadRate;Potree.updatePointClouds(this.pointclouds,c,a)};
Potree.BasicGroup.prototype.recalculateBoxGeometry=function(){var a=this.getBoundingBox(),b=a.getSize(new THREE.Vector3),c=a.getCenter(new THREE.Vector3);a=new THREE.Matrix4;a.makeTranslation(c.x,-c.z,c.y);b=new THREE.BoxBufferGeometry(b.x,b.z,b.y);b.applyMatrix(a);this.geometry=b};Potree.BasicGroup.prototype.add=function(a){THREE.Object3D.prototype.add.call(this,a);a instanceof Potree.PointCloudTree&&(this.pointclouds.push(a),this.recalculateBoxGeometry())};
Potree.BasicGroup.prototype.remove=function(a){THREE.Object3D.prototype.remove.call(this,a);a instanceof Potree.PointCloudTree&&(a=this.pointclouds.indexOf(a),-1!==a&&(this.pointclouds.splice(a,1),this.recalculateBoxGeometry()))};
Potree.BasicGroup.prototype.getBoundingBox=function(){var a=new THREE.Box3;this.updateMatrixWorld(!0);for(var b=0;b<this.pointclouds.length;b++){var c=this.pointclouds[b];c.updateMatrixWorld(!0);c=Potree.utils.computeTransformedBoundingBox(c.pcoGeometry.tightBoundingBox?c.pcoGeometry.tightBoundingBox:c.boundingBox,c.matrixWorld);a.union(c)}return a};
Potree.BasicGroup.prototype.estimateHeightAt=function(a){for(var b=null,c=Infinity,e=$jscomp.makeIterator(this.pointclouds),d=e.next();!d.done;d=e.next())if(d=d.value,void 0!==d.root.geometryNode){var f=null,g=Infinity,h=a.clone().sub(d.position);h.z=0;h=new THREE.Ray(h,new THREE.Vector3(0,0,1));for(var l=[d.root];0<l.length;){var k=l.pop(),m=k.getBoundingBox();if(h.intersectBox(m)){m=k.geometryNode.mean.z+d.position.z+k.geometryNode.boundingBox.min.z;k.geometryNode.spacing<=g&&(f=m,g=k.geometryNode.spacing);
m=$jscomp.makeIterator(Object.keys(k.children));for(var p=m.next();!p.done;p=m.next())p=p.value,k.children[p].geometryNode&&l.push(k.children[p])}}if(null===b||g<c)b=f,c=g}return b};Potree.Group=function(){var a=Potree.BasicGroup.call(this)||this;a.buffers=new Map;a.shaders=new Map;a.textures=new Map;a.types=new Map;return a};$jscomp.inherits(Potree.Group,Potree.BasicGroup);
Potree.Group.prototype.getExtensions=function(a){this.types.set(Float32Array,a.FLOAT);this.types.set(Uint8Array,a.UNSIGNED_BYTE);this.types.set(Uint16Array,a.UNSIGNED_SHORT);a.getExtension('EXT_frag_depth');a.getExtension('WEBGL_depth_texture');var b=a.getExtension('OES_vertex_array_object');a.createVertexArray=b.createVertexArrayOES.bind(b);a.bindVertexArray=b.bindVertexArrayOES.bind(b)};
Potree.Group.prototype.onBeforeRender=function(a,b,c,e,d,f){Potree.BasicGroup.prototype.onBeforeRender.call(this,a,b,c,e,d,f);b=a.context;void 0===b.bindVertexArray&&this.getExtensions(b);e=this.fetchOctrees();e=$jscomp.makeIterator(e.octrees);for(d=e.next();!d.done;d=e.next())d=d.value,this.renderOctree(a,d,d.visibleNodes,c);b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,null);a.state.reset()};
Potree.Group.prototype.createBuffer=function(a,b){var c=new Potree.WebGLBuffer;c.vao=a.createVertexArray();c.numElements=b.attributes.position.count;a.bindVertexArray(c.vao);for(var e in b.attributes){var d=b.attributes[e],f=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,f);a.bufferData(a.ARRAY_BUFFER,d.array,a.STATIC_DRAW);var g=Potree.attributeLocations[e],h=d.normalized,l=this.types.get(d.array.constructor);a.vertexAttribPointer(g,d.itemSize,l,h,0,0);a.enableVertexAttribArray(g);c.vbos.set(e,{handle:f,
name:e,count:d.count,itemSize:d.itemSize,type:b.attributes.position.array.constructor,version:0})}a.bindBuffer(a.ARRAY_BUFFER,null);a.bindVertexArray(null);return c};
Potree.Group.prototype.updateBuffer=function(a,b){var c=this.buffers.get(b);a.bindVertexArray(c.vao);for(var e in b.attributes){var d=b.attributes[e],f=Potree.attributeLocations[e],g=d.normalized,h=this.types.get(d.array.constructor);if(c.vbos.has(e)){var l=c.vbos.get(e).handle;c.vbos.get(e).version=d.version}else l=a.createBuffer(),c.vbos.set(e,{handle:l,name:e,count:d.count,itemSize:d.itemSize,type:b.attributes.position.array.constructor,version:d.version});a.bindBuffer(a.ARRAY_BUFFER,l);a.bufferData(a.ARRAY_BUFFER,
d.array,a.STATIC_DRAW);a.vertexAttribPointer(f,d.itemSize,h,g,0,0);a.enableVertexAttribArray(f)}a.bindBuffer(a.ARRAY_BUFFER,null);a.bindVertexArray(null)};Potree.Group.prototype.fetchOctrees=function(){for(var a=[],b=[this];0<b.length;){var c=b.pop();c instanceof Potree.PointCloudTree?a.push(c):(c=c.children.filter(function(a){return a.visible}),b.push.apply(b,$jscomp.arrayFromIterable(c)))}return{octrees:a}};
Potree.Group.prototype.renderNodes=function(a,b,c,e,d,f){a=a.context;b=b.material;d=d.matrixWorldInverse;var g=new THREE.Matrix4,h=new Float32Array(16);c=$jscomp.makeIterator(c);for(var l=c.next();!l.done;l=c.next())if(l=l.value,void 0===Potree.debug.allowedNodes||Potree.debug.allowedNodes.includes(l.name)){var k=l.sceneNode.matrixWorld;g.multiplyMatrices(d,k);if(e){var m=e.offsets.get(l);f.setUniform1f('uVNStart',m)}m=l.getLevel();f.setUniform('uDebug',!0===l.debug);if(l instanceof Potree.PointCloudOctreeNode)var p=
0===Object.keys(l.children).length;else l instanceof Potree.PointCloudArena4DNode&&(p=l.geometryNode.isLeaf);f.setUniform('uIsLeafNode',p);var n=f.uniformLocations.modelMatrix;n&&(h.set(k.elements),a.uniformMatrix4fv(n,!1,h));n=f.uniformLocations.modelViewMatrix;h.set(g.elements);a.uniformMatrix4fv(n,!1,h);if(b.clipPolygons&&0<b.clipPolygons.length){n=[];for(var r=[],t=$jscomp.makeIterator(b.clipPolygons),q=t.next();!q.done;q=t.next()){q=q.value;d=q.viewMatrix;var u=q.projMatrix.clone().multiply(d).multiply(k);
n.push(q.markers.length);r.push(u)}k=[].concat.apply([],$jscomp.arrayFromIterable(r.map(function(a){return a.elements})));t=Array(24*b.clipPolygons.length);for(r=0;r<b.clipPolygons.length;r++)for(q=b.clipPolygons[r],u=0;u<q.markers.length;u++)t[24*r+3*u]=q.markers[u].position.x,t[24*r+(3*u+1)]=q.markers[u].position.y,t[24*r+(3*u+2)]=q.markers[u].position.z;a.uniform1iv(f.uniformLocations['uClipPolygonVCount[0]'],n);a.uniformMatrix4fv(f.uniformLocations['uClipPolygonWVP[0]'],!1,k);a.uniform3fv(f.uniformLocations['uClipPolygonVertices[0]'],
t)}f.setUniform1f('uLevel',m);f.setUniform1f('uNodeSpacing',l.geometryNode.estimatedSpacing);f.setUniform1f('uPCIndex',r);l=l.geometryNode.geometry;m=null;if(this.buffers.has(l)){m=this.buffers.get(l);for(var z in l.attributes)l.attributes[z].version>m.vbos.get(z).version&&this.updateBuffer(a,l)}else m=this.createBuffer(a,l),this.buffers.set(l,m);a.bindVertexArray(m.vao);a.drawArrays(a.POINTS,0,m.numElements)}a.bindVertexArray(null)};
Potree.Group.prototype.renderOctree=function(a,b,c,e){var d=a.context,f=b.material,g=e.matrixWorldInverse,h=e.matrixWorld,l=e.projectionMatrix,k=(new THREE.Matrix4).getInverse(l);new THREE.Matrix4;var m=null,p=0;if(0<=f.pointSizeType&&(f.pointSizeType===Potree.PointSizeType.ADAPTIVE||f.pointColorType===Potree.PointColorType.LOD)){m=b.computeVisibilityTextureData(c,e);var n=f.visibleNodesTexture;n.image.data.set(m.data);n.needsUpdate=!0}n=null;this.shaders.has(f)?(n=this.shaders.get(f),r=f.vertexShader,
t=f.fragmentShader):(n=new Potree.Shader(d,'pointcloud',f.vertexShader,f.fragmentShader),this.shaders.set(f,n));t=['#define num_shadowmaps0','#define num_snapshots'+(f.snapEnabled?f.numSnapshots:0),'#define num_clipboxes'+(f.clipBoxes&&f.clipBoxes.length?f.clipBoxes.length:0),'#define num_clipspheres0','#define num_clippolygons'+(f.clipPolygons&&f.clipPolygons.length?f.clipPolygons.length:0)].join('\n');var r=t+'\n'+f.vertexShader,t=t+'\n'+f.fragmentShader;n.update(r,t);f.needsUpdate=!1;t=$jscomp.makeIterator(Object.keys(f.uniforms));
for(r=t.next();!r.done;r=t.next())if(r=f.uniforms[r.value],'t'==r.type&&(r=r.value)){if(!this.textures.has(r)){var q=new Potree.WebGLTexture(d,r);this.textures.set(r,q)}this.textures.get(r).update()}d.useProgram(n.program);1>f.opacity?(d.enable(d.BLEND),d.blendFunc(d.SRC_ALPHA,d.ONE),d.depthMask(!1),d.disable(d.DEPTH_TEST)):(d.disable(d.BLEND),d.depthMask(!0),d.enable(d.DEPTH_TEST));n.setUniformMatrix4('projectionMatrix',l);n.setUniformMatrix4('viewMatrix',g);n.setUniformMatrix4('uViewInv',h);n.setUniformMatrix4('uProjInv',
k);g=f.screenHeight;n.setUniform1f('uScreenWidth',f.screenWidth);n.setUniform1f('uScreenHeight',g);n.setUniform1f('fov',Math.PI*e.fov/180);n.setUniform1f('near',e.near);n.setUniform1f('far',e.far);a.capabilities.logarithmicDepthBuffer&&n.setUniform('logDepthBufFC',2/(Math.log(e.far+1)/Math.LN2));e instanceof THREE.OrthographicCamera?(n.setUniform('uUseOrthographicCamera',!0),n.setUniform('uOrthoWidth',e.right-e.left),n.setUniform('uOrthoHeight',e.top-e.bottom)):n.setUniform('uUseOrthographicCamera',
!1);0===f.clipBoxes.length+f.clipPolygons.length?n.setUniform1i('clipTask',Potree.ClipTask.NONE):n.setUniform1i('clipTask',f.clipTask);n.setUniform1i('clipMethod',f.clipMethod);f.clipBoxes&&0<f.clipBoxes.length&&d.uniformMatrix4fv(n.uniformLocations['clipBoxes[0]'],!1,f.uniforms.clipBoxes.value);n.setUniform1f('size',f.size);n.setUniform1f('maxSize',f.uniforms.maxSize.value);n.setUniform1f('minSize',f.uniforms.minSize.value);n.setUniform1f('uOctreeSpacing',f.spacing);n.setUniform('uOctreeSize',f.uniforms.octreeSize.value);
n.setUniform3f('uColor',f.color.toArray());n.setUniform1f('uOpacity',f.opacity);n.setUniform2f('elevationRange',f.elevationRange);n.setUniform2f('intensityRange',f.intensityRange);n.setUniform1f('intensityGamma',f.intensityGamma);n.setUniform1f('intensityContrast',f.intensityContrast);n.setUniform1f('intensityBrightness',f.intensityBrightness);n.setUniform1f('rgbGamma',f.rgbGamma);n.setUniform1f('rgbContrast',f.rgbContrast);n.setUniform1f('rgbBrightness',f.rgbBrightness);n.setUniform1f('uTransition',
f.transition);n.setUniform1f('wRGB',f.weightRGB);n.setUniform1f('wIntensity',f.weightIntensity);n.setUniform1f('wElevation',f.weightElevation);n.setUniform1f('wClassification',f.weightClassification);n.setUniform1f('wReturnNumber',f.weightReturnNumber);n.setUniform1f('wSourceID',f.weightSourceID);g=this.textures.get(f.visibleNodesTexture);n.setUniform1i('visibleNodesTexture',p);d.activeTexture(d.TEXTURE0+p);d.bindTexture(g.target,g.id);p++;g=this.textures.get(f.gradientTexture);n.setUniform1i('gradient',
p);d.activeTexture(d.TEXTURE0+p);d.bindTexture(g.target,g.id);p++;g=this.textures.get(f.classificationTexture);n.setUniform1i('classificationLUT',p);d.activeTexture(d.TEXTURE0+p);d.bindTexture(g.target,g.id);p++;if(!0===f.snapEnabled){l=n.uniformLocations['uSnapshot[0]'];k=n.uniformLocations['uSnapshotDepth[0]'];g=Array(5).fill(p).map(function(a,b){return a+b});h=Array(5).fill(1+Math.max.apply(Math,$jscomp.arrayFromIterable(g))).map(function(a,b){return a+b});p=1+Math.max.apply(Math,$jscomp.arrayFromIterable(h));
d.uniform1iv(l,g);d.uniform1iv(k,h);for(p=0;5>p;p++){r=f.uniforms.uSnapshot.value[p];k=f.uniforms.uSnapshotDepth.value[p];if(!r)break;l=a.properties.get(r).__webglTexture;k=a.properties.get(k).__webglTexture;r=h[p];d.activeTexture(d['TEXTURE'+g[p]]);d.bindTexture(d.TEXTURE_2D,l);d.activeTexture(d['TEXTURE'+r]);d.bindTexture(d.TEXTURE_2D,k)}p=[].concat.apply([],$jscomp.arrayFromIterable(f.uniforms.uSnapView.value.map(function(a){return a.elements})));d.uniformMatrix4fv(n.uniformLocations['uSnapView[0]'],
!1,p);p=[].concat.apply([],$jscomp.arrayFromIterable(f.uniforms.uSnapProj.value.map(function(a){return a.elements})));d.uniformMatrix4fv(n.uniformLocations['uSnapProj[0]'],!1,p);p=[].concat.apply([],$jscomp.arrayFromIterable(f.uniforms.uSnapProjInv.value.map(function(a){return a.elements})));d.uniformMatrix4fv(n.uniformLocations['uSnapProjInv[0]'],!1,p);p=[].concat.apply([],$jscomp.arrayFromIterable(f.uniforms.uSnapViewInv.value.map(function(a){return a.elements})));d.uniformMatrix4fv(n.uniformLocations['uSnapViewInv[0]'],
!1,p)}this.renderNodes(a,b,c,m,e,n);d.activeTexture(d.TEXTURE2);d.bindTexture(d.TEXTURE_2D,null);d.activeTexture(d.TEXTURE0)};
